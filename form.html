<!DOCTYPE html>
<html>

<head>
  <title>BCIEP Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Base body styles for the tracker page */
    body.tracker-active {
      font-family: 'Segoe UI', sans-serif;
      margin: 0 auto;
      padding: 0;
      /* Padding will be on app-container or main-content-wrapper */
      max-width: 1300px;
      /* Max width for tracker content */
      background: #f9f9f9;
    }

    /* Ensure app-container also respects max-width for tracker view */
    body.tracker-active #app-container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 0 20px;
      /* Horizontal padding for tracker content */
    }


    /* Styles for Infographic Page (applied via .infographic-active on body) */
    body.infographic-active {
      font-family: 'Open Sans', sans-serif;
      background-color: #E8F5E9;
      color: #333333;
      margin: 0;
      padding: 0;
      max-width: none;
      /* Infographic can be full width if desired */
    }

    body.infographic-active #app-container {
      max-width: none;
      /* Allow infographic to be wider if needed */
      margin: 0;
      padding: 0;
    }

    /* General h2 for tracker sections - Themed Green */
    h2 {
      text-align: center;
      margin-top: 40px;
      background-color: #1B5E20;
      /* Dark Green Theme */
      color: #fff;
      padding: 10px;
      border-radius: 5px;
    }

    .form-container {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: space-between;
    }

    form {
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      flex: 1;
      min-width: 300px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    @media (min-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    .full-width {
      grid-column: 1 / -1;
    }

    label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* General table styling for tracker */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
      background: white;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-radius: 6px;
      overflow: hidden;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
      text-align: left;
    }

    th {
      background-color: #e0e0e0;
      /* Light gray, can be themed if needed */
      font-weight: bold;
    }

    tbody tr:nth-child(odd) {
      background-color: #f9f9f9;
      /* Can be a very light green if desired */
    }

    tbody tr:hover {
      background-color: #f1f1f1;
      /* Can be a light green hover if desired */
    }

    .error-message {
      color: red;
      font-weight: bold;
    }

    .success-message {
      color: green;
      font-weight: bold;
      padding: 10px;
      background-color: #e6ffe6;
      border: 1px solid #b3ffb3;
      border-radius: 4px;
      margin-bottom: 15px;
      text-align: center;
    }

    /* Presentation specific styles (tracker view) */
    .presentation-upload-form-container {
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .presentation-week-group,
    .media-week-group {
      margin-bottom: 30px;
      border: 1px solid #ddd;
      padding: 20px 0;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .presentation-week-group h3,
    .media-week-group h3 {
      text-align: left;
      background: #2F855A;
      /* Themed Green */
      color: #fff;
      padding: 10px 15px;
      border-radius: 5px 5px 0 0;
      margin: -20px 0 20px 0;
      font-size: 1.3em;
    }

    .presentation-week-group h4,
    .media-week-group h4 {
      margin-top: 15px;
      margin-bottom: 10px;
      color: #333;
      font-size: 1.1em;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
      padding-left: 15px;
      padding-right: 15px;
    }

    .presentation-item {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px dashed #eee;
      padding-left: 15px;
      padding-right: 15px;
    }

    .presentation-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .presentation-container {
      position: relative;
      width: 100%;
      max-width: 100%;
      padding-top: 56.25%;
      height: 0;
      overflow: hidden;
      margin: 10px 0;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .presentation-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .delete-button {
      background-color: #d9534f;
      color: white;
      padding: 6px 12px;
      font-size: 0.9em;
      border-radius: 4px;
      cursor: pointer;
      border: none;
      margin-top: 10px;
      display: inline-block;
    }

    .delete-button:hover {
      background-color: #c9302c;
    }

    /* Custom Message Box & Loader (Global) */
    .custom-message-box-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .custom-message-box-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .custom-message-box {
      background-color: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 400px;
      text-align: center;
    }

    .custom-message-box p {
      margin-bottom: 20px;
      font-size: 16px;
      color: #333;
    }

    .custom-message-box-buttons button {
      padding: 10px 20px;
      margin: 0 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      min-width: 80px;
    }

    .custom-message-box-buttons .confirm-button {
      background-color: #1B5E20;
      /* Themed Green */
      color: white;
      border: none;
    }

    .custom-message-box-buttons .confirm-button:hover {
      background-color: #14532d;
      /* Darker Green */
    }

    .custom-message-box-buttons .cancel-button {
      background-color: #f0f0f0;
      color: #333;
      border: 1px solid #ccc;
    }

    .custom-message-box-buttons .cancel-button:hover {
      background-color: #e0e0e0;
    }

    .loading-indicator {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      z-index: 1001;
      text-align: center;
    }

    .loading-indicator p {
      margin: 0;
      font-size: 16px;
      color: #003366;
    }

    /* Can be themed green */
    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1B5E20;
      /* Themed Green */
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px auto;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .admin-only {
      display: none;
    }

    /* Admin controls are hidden by default */

    /* Infographic specific styles (prefixed with .infographic-active) */
    body.infographic-active .chart-container {
      position: relative;
      width: 100%;
      max-width: 450px;
      margin-left: auto;
      margin-right: auto;
      height: 280px;
      max-height: 350px;
    }

    @media (min-width: 768px) {
      body.infographic-active .chart-container {
        height: 320px;
      }
    }

    body.infographic-active .stat-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      /* rounded-lg */
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      /* shadow-md */
      padding: 1.5rem;
      /* p-6 */
      margin-bottom: 1.5rem;
      /* mb-6 */
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid #D1FAE5;
      /* Light green border */
    }

    body.infographic-active .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      /* shadow-lg */
    }

    body.infographic-active .section-title {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 1.5rem;
      /* Increased margin */
    }

    body.infographic-active .big-number {
      font-size: 3.5rem;
      /* Slightly larger */
      font-weight: 700;
      color: #4CAF50;
      line-height: 1;
    }

    body.infographic-active .icon-list-item {
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
      background-color: #F0FDF0;
      padding: 1rem;
      /* Increased padding */
      border-radius: 0.375rem;
      border-left: 4px solid #FFC107;
    }

    body.infographic-active .icon-list-item .icon {
      font-size: 1.75rem;
      /* Increased icon size */
      margin-right: 1rem;
      /* Increased margin */
      color: #1B5E20;
    }

    body.infographic-active .timeline-item {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #4CAF50;
    }

    body.infographic-active .timeline-item h4 {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .timeline-item ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .timeline-item ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      line-height: 1.6;
    }

    body.infographic-active .timeline-item ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #FFC107;
      font-weight: bold;
    }

    body.infographic-active .ownership-bar-container {
      display: flex;
      width: 100%;
      height: 40px;
      border-radius: 0.5rem;
      overflow: hidden;
      margin-top: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    body.infographic-active .ownership-bar-rmc {
      background-color: #1B5E20;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }

    body.infographic-active .ownership-bar-community {
      background-color: #4CAF50;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }

    body.infographic-active .org-chart-node {
      background-color: #F0FDF0;
      /* Light green background */
      border-radius: 0.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 1rem;
      text-align: center;
      margin: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #1B5E20;
      /* Darker green text */
      border: 1px solid #4CAF50;
      /* Medium Green border */
    }

    body.infographic-active .org-chart-level {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    body.infographic-active .org-chart-arrow {
      text-align: center;
      font-size: 1.5rem;
      color: #4CAF50;
      margin: 0.5rem 0;
    }

    body.infographic-active .org-chart-line {
      height: 20px;
      width: 2px;
      background-color: #4CAF50;
      margin: 0 auto;
    }

    body.infographic-active .org-chart-horizontal-line {
      height: 2px;
      background-color: #4CAF50;
      width: 100%;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    body.infographic-active .org-chart-connector {
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    body.infographic-active .org-chart-connector::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 10px;
      background-color: #4CAF50;
    }

    body.infographic-active .org-chart-connector::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 10px;
      background-color: #4CAF50;
    }

    body.infographic-active .org-chart-flex {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      width: 100%;
    }

    body.infographic-active .org-chart-flex>div {
      flex: 1 1 30%;
      max-width: 30%;
      box-sizing: border-box;
    }

    @media (max-width: 767px) {
      body.infographic-active .org-chart-flex>div {
        flex: 1 1 100%;
        max-width: 100%;
      }
    }

    body.infographic-active .stakeholder-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #1B5E20;
    }

    body.infographic-active .stakeholder-card h4 {
      color: #4CAF50;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .stakeholder-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .stakeholder-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .stakeholder-card ul li::before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #FFC107;
      font-weight: bold;
    }

    body.infographic-active .component-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #FFC107;
    }

    body.infographic-active .component-card h4 {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .component-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .component-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .component-card ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #4CAF50;
      font-weight: bold;
    }

    body.infographic-active .risk-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #1B5E20;
    }

    body.infographic-active .risk-card h4 {
      color: #4CAF50;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .risk-card h5 {
      color: #FFC107;
      font-weight: 600;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-size: 1.05rem;
    }

    body.infographic-active .risk-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .risk-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .risk-card ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #81C784;
      font-weight: bold;
    }

    body.infographic-active .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    body.infographic-active .data-table {
      width: 100%;
      border-collapse: collapse;
      background-color: #FFFFFF;
      font-size: 0.9rem;
      min-width: 800px;
    }

    body.infographic-active .data-table th,
    body.infographic-active .data-table td {
      padding: 0.75rem 1rem;
      border: 1px solid #E0E0E0;
      text-align: left;
    }

    body.infographic-active .data-table th {
      background-color: #1B5E20;
      color: white;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    body.infographic-active .data-table tbody tr:nth-child(odd) {
      background-color: #F0FDF0;
    }

    body.infographic-active .data-table tbody tr:hover {
      background-color: #DCF0DD;
    }
  </style>
</head>

<body class="tracker-active">
  <div id="app-container">
    <div class="navigation-buttons sticky top-0 z-50 bg-green-50 shadow-md p-3 flex flex-wrap justify-center gap-2">
      <button onclick="showHomePage()"
        class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Home</button>
      <button onclick="showSection('meetings-section')"
        class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50 transition-colors">Meetings</button>
      <button onclick="showSection('media-section')"
        class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50 transition-colors">Media</button>
      <button onclick="showSection('presentations-section')"
        class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50 transition-colors">Presentation</button>
      <button id="admin-nav-button" onclick="handleAdminNavClick()"
        class="px-4 py-2 text-sm font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition-colors">Admin</button>
    </div>

    <div id="main-content-wrapper" class="pt-20">
      <div id="tracker-content-area">
        <div id="meetings-section" style="display: none;">
          <h2>Bloomberg Cities Idea Exchange || India || Meeting & Action Tracker</h2>
          <div class="form-container">
            <form id="meeting-form" style="margin-top: 0; border: 2px solid #ccc;">
              <h3 style="margin-top: 0px;">Meeting Agenda and Discussions</h3>
              <div id="meeting-mode"
                style="margin: 10px 0; margin-bottom: 15px; padding: 5px; border: 2px solid #aaa; border-radius: 4px; background-color: #f5f5f5; font-weight: bold; color: #d9534f;">
                Mode: Add New Meeting</div>
              <input type="hidden" name="row">
              <div class="form-grid">
                <div><label for="meetingId">Meeting ID:</label><input type="text" name="meetingId" id="meetingId"
                    readonly></div>
                <div><label for="meetingDate">Meeting Date:</label><input type="date" name="meetingDate"
                    id="meetingDate" required></div>
                <div><label for="zoneM">Zone:</label><select name="zone" id="zoneM" required>
                    <option value="">Select Zone</option>
                    <option>Zone 1</option>
                    <option>Zone 2</option>
                    <option>Zone 3</option>
                  </select></div>
                <div><label for="districtM">District:</label><select name="district" id="districtM" required>
                    <option value="">Select District</option>
                    <option>Balangir</option>
                    <option>Bargarh</option>
                    <option>Cuttack</option>
                    <option>Ganjam</option>
                    <option>Kendujhar</option>
                    <option>Koraput</option>
                    <option>Mayurbhanj</option>
                    <option>Sambalpur</option>
                    <option>Sundargarh</option>
                  </select></div>
                <div><label for="coldRoomM">Cold Room Location (Optional):</label><select id="coldRoomM"
                    name="coldRoom">
                    <option value="">None</option>
                    <option>Desil</option>
                    <option>RMC Behera Market</option>
                    <option>RMC Sarandapali</option>
                    <option>Athagarh NAC</option>
                    <option>Nistipur</option>
                    <option>Dudhianali</option>
                    <option>RMC Kalabada Market Yard</option>
                    <option>RMC Digapahandi Market Yard</option>
                    <option>RMC Bhanjanagar Market Yard</option>
                    <option>Bahadapada</option>
                    <option>RMC Buguda Market Yard</option>
                    <option>Chatrapur Market</option>
                    <option>Kolasingi</option>
                    <option>Raisuan</option>
                    <option>Madarangajodi</option>
                    <option>Mukuna</option>
                    <option>Tikarapada</option>
                    <option>Nuagaon (Narsinghpur)</option>
                    <option>Baradapala</option>
                    <option>Ratanpur</option>
                    <option>Tulasichaura</option>
                    <option>Kathakaranjia</option>
                    <option>Ghatabhagra</option>
                    <option>Malimarla</option>
                    <option>Baghiatangar</option>
                    <option>Chapaldihi</option>
                    <option>Akhapolan</option>
                    <option>Sandhenkia</option>
                    <option>Tikhia</option>
                    <option>Kuchinda</option>
                    <option>Bhojpur</option>
                    <option>T.Niktimal</option>
                    <option>Charmal</option>
                    <option>Khetrajpur</option>
                    <option>Kardega</option>
                    <option>Kadalidhipa</option>
                    <option>Khariapada</option>
                    <option>Bhelluadihi</option>
                    <option>Domposh</option>
                    <option>Rajpur</option>
                    <option>Kansar</option>
                  </select></div>
                <div class="full-width"><label for="meetingTitle">Meeting Title:</label><input type="text"
                    id="meetingTitle" name="meetingTitle" required></div>
                <div><label for="conductedByM">Conducted By:</label><select name="conductedBy" id="conductedByM"
                    required>
                    <option>Akshaya Kumar Pallai</option>
                    <option>Vicky Vikram Das</option>
                    <option>Krushna Chandra Parida</option>
                    <option>Mary Helena Kujur</option>
                    <option>Hemanti Sabar</option>
                    <option>Amlan Abhinav</option>
                    <option>Asutosh Nayak</option>
                    <option>Pratham Parida</option>
                    <option>Rashmi Prava Nayak</option>
                    <option>Minati Mallick</option>
                    <option>Sunita Patra</option>
                    <option>Deepak Kumar Tudu</option>
                    <option>Swati Rani Achary</option>
                  </select></div>
                <div><label for="attendeesM">Attendees:</label><textarea name="attendees" id="attendeesM"
                    required></textarea></div>
                <div class="full-width"><label for="meetingAgendaM">Meeting Agenda:</label><textarea
                    name="meetingAgenda" id="meetingAgendaM" required></textarea></div>
                <div class="full-width"><label for="meetingDiscussionM">What points were discussed during the
                    meeting?</label><textarea name="meetingDiscussion" id="meetingDiscussionM"></textarea></div>
              </div>
              <button type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Save
                Meeting</button>
            </form>
            <form id="action-form" style="margin-top: 0; border: 2px solid #ccc;">
              <h3 style="margin-top: 0px;">Meeting Action Items</h3>
              <div id="action-mode"
                style="margin: 10px 0; margin-bottom: 15px; padding: 5px; border: 2px solid #aaa; border-radius: 4px; background-color: #f5f5f5; font-weight: bold; color: #d9534f;">
                Mode: Add New Action Item</div>
              <input type="hidden" name="row">
              <div class="form-grid">
                <div><label for="action-meetingId">Meeting ID:</label><input type="text" name="meetingId"
                    id="action-meetingId" readonly required></div>
                <div class="full-width"><label for="actionItemA">Action Item:</label><input type="text"
                    name="actionItem" id="actionItemA" required></div>
                <div><label for="assignedToA">Assigned To:</label><select name="assignedTo" id="assignedToA" required>
                    <option>Akshaya Kumar Pallai</option>
                    <option>Vicky Vikram Das</option>
                    <option>Krushna Chandra Parida</option>
                    <option>Mary Helena Kujur</option>
                    <option>Hemanti Sabar</option>
                    <option>Amlan Abhinav</option>
                    <option>Asutosh Nayak</option>
                    <option>Pratham Parida</option>
                    <option>Rashmi Prava Nayak</option>
                    <option>Minati Mallick</option>
                    <option>Sunita Patra</option>
                    <option>Deepak Kumar Tudu</option>
                    <option>Swati Rani Achary</option>
                  </select></div>
                <div><label for="deadlineA">Deadline:</label><input type="date" name="deadline" id="deadlineA" required>
                </div>
                <div class="full-width"><label for="statusA">Status:</label><select name="status" id="statusA" required>
                    <option value="">Select Status</option>
                    <option>Pending</option>
                    <option>In Progress</option>
                    <option>Completed</option>
                  </select></div>
              </div>
              <button type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Add Action
                Item</button>
              <button type="reset"
                class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">Clear</button>
            </form>
          </div>
          <h2 style="text-align: center; margin-top: 20px">All Meetings</h2>
          <table id="meeting-table">
            <thead></thead>
            <tbody></tbody>
          </table>
          <div style="height: 40px;"></div>
          <h2 style="text-align: center;">All Action Items</h2>
          <table id="action-table">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="media-section" style="display:none; text-align:center;">
          <h2>Upload Weekly Media Files</h2>
          <form id="media-upload-form" method="post" enctype="multipart/form-data"
            style="max-width: 800px; margin:0 auto; border:2px solid #ccc; padding:20px; border-radius:8px;">
            <div class="form-grid">
              <div> <label for="weekInfoMedia">Week:</label> <select name="weekInfo" id="weekInfoMedia" required>
                  <option value="">Select Week</option>
                  <option value="Week 19 (May 05 - May 11)">Week 19 (May 05 - May 11)</option>
                  <option value="Week 53 (Dec 29 - Dec 31)">Week 53 (Dec 29 - Dec 31)</option>
                </select> </div>
              <div> <label for="zoneMedia">Zone:</label> <select name="zone" id="zoneMedia" required>
                  <option value="">Select Zone</option>
                  <option>Zone 1</option>
                  <option>Zone 2</option>
                  <option>Zone 3</option>
                </select> </div>
              <div> <label for="districtMedia">District:</label> <select name="district" id="districtMedia" required>
                  <option value="">Select District</option>
                  <option>Balangir</option>
                  <option>Sundargarh</option>
                </select> </div>
              <div class="full-width"> <label for="mediaFileMedia">Upload Media (Photos/Videos):</label> <input
                  type="file" name="mediaFile" id="mediaFileMedia" accept="image/*,video/*" required> </div>
            </div><button type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Upload
              Media</button>
          </form>
          <h3>Uploaded Media Gallery</h3>
          <div id="media-gallery" style="margin-top: 40px;">
            <p>Loading media gallery...</p>
          </div>
        </div>
        <div id="presentations-section" style="display:none;">
          <h2>Project Presentations</h2>
          <div class="presentation-upload-form-container">
            <h3>Add New Presentation</h3>
            <form id="presentation-upload-form">
              <div> <label for="presentationWeekInfo">Week Number:</label> <select name="weekInfo"
                  id="presentationWeekInfo" required>
                  <option value="">Select Week</option>
                </select> </div>
              <div> <label for="presentationTitleInput">Presentation Title (Optional):</label> <input type="text"
                  name="presentationTitle" id="presentationTitleInput"> </div>
              <div> <label for="presentationIframeCode">Google Slides Embed Code (iframe):</label> <textarea
                  name="iframeCode" id="presentationIframeCode" required
                  placeholder="Paste the full <iframe> code from Google Slides here..."></textarea> </div><button
                type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Save
                Presentation</button>
            </form>
          </div>
          <div id="presentations-display-area" style="margin-top: 30px;">
            <p>Loading presentations...</p>
          </div>
        </div>
        <div id="admin-section" style="display: none;" class="max-w-md mx-auto mt-10">
          <form id="admin-login-form" class="bg-white p-8 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-6 text-center" style="color: #fff;">Admin Login</h2>
            <div class="mb-4">
              <label for="username" class="block text-gray-700 text-sm font-bold mb-2">Username:</label>
              <input type="text" id="username" name="username"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
            <div class="mb-6">
              <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
              <input type="password" id="password" name="password"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline">
            </div>
            <div class="flex items-center justify-between">
              <button type="submit"
                class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                Sign In
              </button>
            </div>
          </form>
        </div>
      </div>
      <div id="infographic-content-area" style="display:none;"></div>
    </div>
    <div id="loadingIndicator" class="loading-indicator">
      <div class="loader"></div>
      <p>Processing...</p>
    </div>
    <div id="customMessageBoxOverlay" class="custom-message-box-overlay">
      <div class="custom-message-box">
        <p id="customMessageText"></p>
        <div class="custom-message-box-buttons">
          <button id="customMessageConfirm" class="confirm-button">OK</button>
          <button id="customMessageCancel" class="cancel-button">Cancel</button>
        </div>
      </div>
    </div>

    <script>
      // scriptURL for Google Apps Script deployment. This needs to be replaced with a live deployment URL for full functionality.
      var scriptURL = 'https://script.google.com/macros/s/AKfycbyoLTLQaMjJXBnN3luRiscIiOM1fnYEcpfUY3yLmWAICTGhkU8DOukytwfB-yh8sJUMwQ/exec';

      let isAdminLoggedIn = false;

      // Store original head and body styles for switching back from infographic view
      const originalTrackerHeadContent = document.head.innerHTML;
      const originalTrackerBodyClasses = document.body.className;
      const originalTrackerBodyStyles = {
        fontFamily: document.body.style.fontFamily,
        margin: document.body.style.margin,
        padding: document.body.style.padding,
        maxWidth: document.body.style.maxWidth,
        backgroundColor: document.body.style.backgroundColor
      };

      // Infographic specific HTML content and Chart.js script
      const infographicPageHeadHTML_Base = `
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bloomberg Cities Idea Exchange - Project Infographic</title>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
        <style>
            /* Styles for Infographic Page are now primarily handled by Tailwind via .infographic-active on body */
        </style>
    `;
      const infographicPageBodyHTML = `
        <div class="p-4 md:p-8"> 
            <header class="text-center mb-16"> <h1 class="text-4xl md:text-5xl font-bold" style="color: #1B5E20;">Bloomberg Cities Idea Exchange</h1> <h2 class="text-2xl md:text-3xl mt-3" style="color: #4CAF50;">Economic Vulnerability Project: Powering Cold Storage with Solar Energy & Community Cooperatives</h2> </header> 
            <main class="space-y-16"> 
                <section class="stat-card text-center border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h3 class="section-title text-3xl mb-6">🎯 Project Objective Overview</h3> <p class="text-2xl font-semibold" style="color: #1B5E20;">Our Core Mission: Scaling the highly successful Rourkela Cold Room Project model statewide across Odisha, transforming local economies and empowering communities! <span class="text-3xl inline-block ml-2">🚀</span></p> </section> 
                <section> <h3 class="section-title text-3xl text-center mb-8">📍 Geographic Impact - Phase 1 Expansion</h3> <p class="text-center text-lg mb-8">We're expanding our reach across Odisha to bring sustainable cold storage solutions to more communities, fostering growth and reducing food loss.</p> <div class="stat-card text-center p-6 mb-8 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3" style="color: #4CAF50;">Cold Room Locations Across Odisha</h4> <p class="text-sm text-gray-600 mb-4">Visual representation of cold room distribution across the 9 target districts, highlighting the project's widespread impact.</p> <img src="https://1drv.ms/i/c/FCC27489BB0A4269/IQSvnAtoFx5ISp0qSdwMlPLUAendayx2MQsXZOFgVqua3D0?width=1024"
     width="1024"
     style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto;"
     alt="Cold Room Locations Across Odisha" />
</div> <div class="stat-card p-6 mb-8 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3 text-center" style="color: #4CAF50;">Phase 1 Cold Room Site Details</h4> <p class="text-sm text-center mb-4">A comprehensive list of all 41 cold room sites, detailing their location, type, capacity, operators, and supervision.</p> <div class="table-container"> <table class="data-table"> <thead><tr><th class="py-3 px-4">#</th><th class="py-3 px-4">District</th><th class="py-3 px-4">Sub-Division</th><th class="py-3 px-4">Block</th><th class="py-3 px-4">Nearby Urban Local Body</th><th class="py-3 px-4">Cold Room Type</th><th class="py-3 px-4">Locations</th><th class="py-3 px-4">Size (in MT)</th><th class="py-3 px-4">Operators</th><th class="py-3 px-4">Supervision By</th></tr></thead> <tbody> <tr><td>01</td><td>Balangir</td><td>Titila garh</td><td>Titila garh</td><td>Titilagarh Muni .</td><td>OREDA</td><td>Besil</td><td>10</td><td>Jaden FPC</td><td>DDH Balangir</td></tr> <tr><td>02</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh Muni .</td><td>Pre-Existing</td><td>RMC Behera Market</td><td>10</td><td>Premsai SHG</td><td>RMC Bargarh</td></tr> <tr><td>03</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh Muni .</td><td>Pre-Existing</td><td>RMC Sarandapali</td><td>10</td><td>Jawala SHG</td><td>RMC Bargarh</td></tr> <tr><td>04</td><td>Cuttack</td><td>Athagarh</td><td>Athagarh</td><td>Athagarh NAC</td><td>OREDA</td><td>Athagarh NAC</td><td>10</td><td>Sasmita Rout & Coop .</td><td>DDH Cuttack</td></tr> <tr><td>05</td><td>Cuttack</td><td>Banki</td><td>Banki</td><td>Banki NAC</td><td>OREDA</td><td>Nistipur</td><td>10</td><td>Jaydev Jena & Coop .</td><td>DDH Cuttack</td></tr> <tr><td>06</td><td>Cuttack</td><td>Cuttack</td><td>Tangi-Choudwar</td><td>Choudwar Muni .</td><td>OREDA</td><td>Dudhianali</td><td>10</td><td>Puspita Sahoo & Coop .</td><td>DDH Cuttack</td></tr> <tr><td>07</td><td>Ganjam</td><td>Berhampur</td><td>Chikiti</td><td>Chikiti NAC</td><td>Pre-Existing</td><td>RMC Kalabada Market Yard</td><td>10</td><td>RMC Digapahandi</td><td>RMC Digapahandi</td></tr> <tr><td>08</td><td>Ganjam</td><td>Berhampur</td><td>Digapahandi</td><td>Digapahandi NAC</td><td>Pre-Existing</td><td>RMC Digapahandi Market Yard</td><td>30</td><td>FPO</td><td>RMC Digapahandi</td></tr> <tr><td>09</td><td>Ganjam</td><td>Bhanjanagar</td><td>Bhanjanagar</td><td>Bhanjanagar NAC</td><td>Pre-Existing</td><td>RMC Bhanjanagar Market Yard</td><td>10</td><td>Maa Byaghradevi FPC</td><td>RMC Bhanjanagar</td></tr> <tr><td>10</td><td>Ganjam</td><td>Bhanjanagar</td><td>Bhanjanagar .</td><td>Bhanjanagar NAC</td><td>OREDA</td><td>Bahadapada</td><td>10</td><td>Khali Bishoyi & Coop .</td><td>DDH Ganjam</td></tr> <tr><td>11</td><td>Ganjam</td><td>Buguda</td><td>Buguda</td><td>Buguda NAC</td><td>Pre-Existing</td><td>RMC Buguda Market Yard</td><td>10</td><td>Gajalaxmi PG</td><td>RMC Bhanjanagar</td></tr> <tr><td>12</td><td>Ganjam</td><td>Chatrapur</td><td>Chatrapur</td><td>Chatrapur NAC</td><td>Pre-Existing</td><td>Chatrapur Market</td><td>30</td><td>Sampoorna Sukanya PC</td><td>RMC Hinjilicut</td></tr> <tr><td>13</td><td>Ganjam</td><td>Purushottampur</td><td>Purushottampur</td><td>Purushottampur NAC</td><td>OREDA</td><td>Kolasingi</td><td>10</td><td>Baba Biswanath FPO</td><td>DDH Ganjam</td></tr> <tr><td>14</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Raisuan</td><td>10</td><td>Maa Tarini Vegetable PG</td><td>DDH Keonjhar</td></tr> <tr><td>15</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Madarangajodi</td><td>05</td><td>Maa Mangala PG</td><td>DDH Keonjhar</td></tr> <tr><td>16</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Mukuna</td><td>05</td><td>Satya Narayana PG</td><td>DDH Keonjhar</td></tr> <tr><td>17</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Tikarapada</td><td>05</td><td>Maa Taratarini PG</td><td>DDH Keonjhar</td></tr> <tr><td>18</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Nuagaon ( Narsinghpur )</td><td>10</td><td>Radhakrishna PG</td><td>DDH Keonjhar</td></tr> <tr><td>19</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Baradapala ,</td><td>05</td><td>Maa Tarini vegetable PG</td><td>DDH Keonjhar</td></tr> <tr><td>20</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Ratanpur</td><td>05</td><td>Jay Hanuman PG</td><td>DDH Keonjhar</td></tr> <tr><td>21</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Tulasichaura</td><td>10</td><td>Meghmala Parida and FPO</td><td>DDH Keonjhar</td></tr> <tr><td>22</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Muni .</td><td>Pre-Existing</td><td>Kathakaranjia</td><td>05</td><td>Mandaramalini PG</td><td>DDH Keonjhar</td></tr> <tr><td>23</td><td>Koraput</td><td>Jeypore</td><td>Jeypore</td><td>Jeypore Muni .</td><td>Pre-Existing</td><td>Ghatabhagra</td><td>10</td><td>Bajrangbali SHG</td><td>DDH Koraput</td></tr> <tr><td>24</td><td>Koraput</td><td>Koraput</td><td>Semliguda</td><td>Sunabeda Muni .</td><td>Pre-Existing</td><td>Malimarla</td><td>10</td><td>Kailashgiri SHG</td><td>DDH Koraput</td></tr> <tr><td>25</td><td>Mayurbhanj</td><td>Bamanaghati</td><td>Rairangpur</td><td>Rairangpur Muni .</td><td>Pre-Existing</td><td>Baghiatangar</td><td>05</td><td>Padmabati SHG</td><td>DDH Mayurbhanj</td></tr> <tr><td>26</td><td>Mayurbhanj</td><td>Kaptipada</td><td>Udala</td><td>Udala NAC</td><td>Pre-Existing</td><td>Chapaldihi</td><td>05</td><td>Jai Maa Tarini SHG</td><td>DDH Mayurbharj</td></tr> <tr><td>27</td><td>Mayurbhanj</td><td>Panchapid</td><td>Karanjia</td><td>Karanjia Muni .</td><td>Pre-Existing</td><td>Akhapolan</td><td>10</td><td>Maa Mangala SHG</td><td>DDH Mayurbhanj</td></tr> <tr><td>28</td><td>Mayurbhanj</td><td>Baripada</td><td>Baripada</td><td>Baripada Muni .</td><td>OREDA</td><td>Sandhenkia</td><td>10</td><td>Sandhenkia SHG</td><td>DDH Mayurbhanj</td></tr> <tr><td>29</td><td>Mayurbhanj</td><td>Rairangpur</td><td>Rairangpur</td><td>Rairangpur Muni .</td><td>OREDA</td><td>Tikhia</td><td>10</td><td>Bahalda FPC</td><td>DDH Mayurbhanj</td></tr> <tr><td>30</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>Pre-Existing</td><td>Kuchinda</td><td>05</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr> <tr><td>31</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>Pre-Existing</td><td>Bhojpur</td><td>30</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr> <tr><td>32</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>OREDA</td><td>T.Niktimal</td><td>10</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr> <tr><td>33</td><td>Sambalpur</td><td>Rairakhol</td><td>Redhakhol</td><td>Redhakhol NAC</td><td>Pre-Existing</td><td>Charmal</td><td>05</td><td>RMC Redhakhol</td><td>RMC Redhakhol</td></tr> <tr><td>34</td><td>Sambalpur</td><td>Sambalpur</td><td>Dhankauda</td><td>Sambalpur MC</td><td>Pre-Existing</td><td>Khetrajpur</td><td>05</td><td>RMC Sambalpur</td><td>RMC Sambalpur</td></tr> <tr><td>35</td><td>Sundargarh</td><td>Panposh</td><td>Bisra</td><td>Biramitrapur Muni .</td><td>Pre-Existing</td><td>Kardega .</td><td>05</td><td>Samleswari SHG</td><td>DDH Sundargarh</td></tr> <tr><td>36</td><td>Sundargarh</td><td>Panposh</td><td>Lathikata</td><td>Rourkela MC</td><td>Pre-Existing</td><td>Kadalidhipa</td><td>05</td><td>Muskan SHG</td><td>DDH Sundargarh</td></tr> <tr><td>37</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Rajgangpur Muni .</td><td>Pre-Existing</td><td>Khariapada</td><td>05</td><td>Priya SHG</td><td>DDH Sundargarh</td></tr> <tr><td>38</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Pre-Existing</td><td>Bhelluadihi</td><td>05</td><td>Shaktirupa SHG</td><td>DDH Sundargarh</td></tr> <tr><td>39</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Pre-Existing</td><td>Domposh</td><td>05</td><td>Ritika SHG</td><td>DDH Sundargarh</td></tr> <tr><td>40</td><td>Sundargarh</td><td>Sundargarh</td><td>Sundargarh</td><td>Sundargarh Muni .</td><td>Pre-Existing</td><td>Rajpur</td><td>05</td><td>Bulbul SHG</td><td>DDH Sundargarh</td></tr> <tr><td>41</td><td>Sundargarh</td><td>Rourkela</td><td>Lathikata</td><td>Rourkela MC</td><td>OREDA</td><td>Kansar</td><td>10</td><td>Subhashree Mohanty & Coop .</td><td>DDH Sundargarh</td></tr> </tbody> </table> </div> </div> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">41</div><p class="text-xl mt-2">Total Sites <span class="text-3xl inline-block ml-1">🏗️</span></p><p class="text-sm text-gray-600">(Existing & Upcoming)</p></div> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">25</div><p class="text-xl mt-2">Cities Covered <span class="text-3xl inline-block ml-1">🏙️</span></p></div> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">9</div><p class="text-xl mt-2">Key Districts <span class="text-3xl inline-block ml-1">🗺️</span></p></div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start"> <div class="stat-card border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3 text-center" style="color: #4CAF50;">Site Distribution</h4> <p class="text-sm text-center mb-4">The 41 sites comprise both existing facilities and new installations, ensuring a broad and effective rollout.</p> <div class="chart-container"><canvas id="sitesChart"></canvas></div> </div> <div class="stat-card border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3" style="color: #4CAF50;">Districts Served in Odisha:</h4> <p class="text-sm mb-4">Our project aims to make a significant impact across these key agricultural regions within Odisha.</p> <ul class="space-y-2"> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Balangir</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Bargarh</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Sambalpur</li> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Sundargarh</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Keonjhar</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Mayurbhanj</li> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Cuttack</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Ganjam</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Koraput</li> </ul> </div> </div> </section>
                <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🤝 Key Partners & Execution Strategy</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center"><div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Dedicated Implementing Agency</h4> <p class="text-lg mb-2">Proudly implemented by:</p> <p class="text-2xl font-bold" style="color: #1B5E20;">Koel Fresh Private Limited</p> <p class="text-sm mt-1 text-gray-600">(As per the significant MoU between Directorate of Horticulture (Odisha) and Delivery Associates (UK))</p></div><div class="text-center"> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Phase 1 Timeline</h4> <p class="text-lg mb-2">This phase is designed for rapid, impactful deployment:</p> <div class="big-number" style="font-size: 4rem; color: #1B5E20;">2 <span class="text-3xl align-baseline">Years</span></div> <p class="text-xl mt-2">Focused Simultaneous Execution ⏳</p> <p class="text-sm text-gray-600">(Across all 41 sites)</p></div></div> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">🛠️ Strategic Pillars - Phase 1 Focus</h3> <p class="text-center text-lg mb-8">Our success in Phase 1 is built on three core strategic pillars, ensuring comprehensive development and sustainable impact.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"> <div class="stat-card text-center p-6"> <div class="text-5xl mb-4">🧊</div> <h4 class="font-semibold text-xl mb-2" style="color: #1B5E20;">Optimal Cold Room Utilization</h4> <p class="text-gray-600">Maximizing the efficiency and usage of cold storage facilities to preserve produce quality and extend shelf life.</p> </div> <div class="stat-card text-center p-6"> <div class="text-5xl mb-4">👩‍🏫</div> <h4 class="font-semibold text-xl mb-2" style="color: #4CAF50;">Robust SHG/FPO Capacity Building</h4> <p class="text-gray-600">Empowering Self-Help Groups and Farmer Producer Organizations with skills and knowledge for effective management.</p> </div> <div class="component-card text-center p-6"> <div class="text-5xl mb-4">🔗</div> <h4 class="font-semibold text-xl mb-2" style="color: #FFC107;">Strong Market Linkage Establishment</h4> <p class="text-gray-600">Connecting farmers and cooperatives to viable markets, ensuring better prices and consistent demand for their produce.</p> </div> </div> </section>
                <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🌟 The Rourkela Cold Room Project: A Model of Success! 🏆</h3> <p class="text-center text-lg mb-6">(A proud Winner of the Bloomberg Philanthropies Global Mayors Challenge 2021!)</p> <p class="text-center text-lg mb-8">The expansion builds upon the proven, impactful results of the Rourkela pilot project, which demonstrated significant benefits for farmers and the community.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center"> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="big-number" style="color: #1B5E20;">75%</div> <p class="text-xl mt-2 font-semibold">Food Waste Reduction 🗑️➡️✅</p> <p class="text-sm text-gray-600 mt-1">Dramatically reduced post-harvest losses.</p> </div> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="text-5xl mb-3" style="color: #4CAF50;">💰</div> <p class="text-xl mt-2 font-semibold">Higher Farmer Earnings</p> <p class="text-sm text-gray-600 mt-1">Enabled farmers to achieve significantly better prices for their valuable produce.</p> </div> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="text-5xl mb-3" style="color: #FFC107;">💪</div> <p class="text-xl mt-2 font-semibold">Women-Led Cooperative Empowerment</p> <p class="text-sm text-gray-600 mt-1">Fostered and strengthened women-led cooperatives, driving local economic growth.</p> </div> </div> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">🚀 Our Ambitious Project Goals</h3> <p class="text-center text-lg mb-8">We are committed to driving positive and lasting change across Odisha through these key objectives.</p> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div class="stat-card icon-list-item"> <span class="icon">🍎</span> <div> <h4 class="font-semibold text-lg">Combat Food Waste</h4> <p class="text-sm text-gray-600">Minimize food waste and eliminate distress selling among our valued small farmers and vendors.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">👩‍🌾</span> <div> <h4 class="font-semibold text-lg">Empower Local Communities</h4> <p class="text-sm text-gray-600">Uplift and empower women (SHGs/PGs) and farmer cooperatives (FPOs/FPCs) through sustainable practices.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">🔒</span> <div> <h4 class="font-semibold text-lg">Enhance Food Security</h4> <p class="text-sm text-gray-600">Strengthen regional food security and build resilient market linkages for a better future.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">🌱</span> <div> <h4 class="font-semibold text-lg">Foster Sustainable Enterprises</h4> <p class="text-sm text-gray-600">Cultivate and establish thriving, community-led cold room enterprises that last.</p> </div> </div> </div> </section>
                <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🗺️ The Roadmap: Key Components of the Full Master Plan</h3> <p class="text-center text-lg mb-8">The comprehensive master plan provides a clear and detailed pathway for successful project implementation, covering all critical aspects.</p> <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"> <li class="icon-list-item"><span class="icon">⏱️</span> A Detailed Comprehensive Timeline</li> <li class="icon-list-item"><span class="icon">👥</span> A Clear Stakeholder Framework</li> <li class="icon-list-item"><span class="icon">🛠️</span> An Actionable Implementation Strategy</li> <li class="icon-list-item"><span class="icon">📢</span> A Proactive Communication Approach</li> <li class="icon-list-item"><span class="icon">✅</span> A Robust Monitoring System</li> </ul> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">🗓️ Implementation Timeline: 12 Months, Concurrent Rollout</h3> <p class="text-center text-lg mb-8">All 41 cold room sites will be activated in parallel, with key phases overlapping across districts to ensure efficient and widespread impact.</p> <div class="space-y-6"> <div class="timeline-item"> <h4>Months 1-2: Kick-off, PMU Setup & Infrastructure Readiness 🚀</h4> <ul> <li><span class="font-semibold">Kick-off Meetings:</span> Launch project simultaneously across all selected districts with formal meetings by Koel Fresh, District Horticulture Offices, and District Administrations. Communicate objectives, timelines, roles, and outcomes.</li> <li><span class="font-semibold">Central Project Management Unit (PMU) Setup (State Level):</span> Establish within Koel Fresh's head office (Rourkela or Bhubaneswar). Appoint dedicated Project Director, Project Manager, M&E Specialist, Market Linkage Specialist, Digital Tools Expert, and Communications Officer. Centralize coordination with Delivery Associates, Directorate of Horticulture, OREDA, ORMAS, OLM, NGOs, and state-level stakeholders. Develop guidelines, SOPs, reporting formats, and deploy digital dashboards for oversight.</li> <li><span class="font-semibold">District-Level PMUs Setup:</span> Establish dedicated PMUs in each of the 9 districts, preferably at District Horticulture Offices. Appoint District Project Coordinators, Field Executives, Capacity Building Trainers, and Community Mobilizers. Ensure representation from district horticulture officials, collectors/CDOs, ORMAS, OLM, RMC officials, and local NGO representatives. Coordinate daily activities, site readiness, local capacity building, farmer outreach, operational support, and troubleshooting. Organize monthly district-level coordination meetings and provide weekly performance data to Central PMU.</li> <li><span class="font-semibold">Infrastructure Readiness & Equipment Setup:</span><ul><li><span class="font-semibold">New Cold Rooms (10 units):</span> Coordinate timely installation, commissioning, and final readiness checks with OREDA. Ensure technical readiness and operational handover by Month 2.</li><li><span class="font-semibold">Existing Cold Rooms (31 units):</span> Verify operational functionality, minor maintenance, and accessory installations (storage crates, digital scales, tablets). Ensure any minor repairs, cleaning, or equipment setup completed for full operational readiness by Month 2.</li></ul></li> </ul> </div> <div class="timeline-item"> <h4>Months 2-3: Training & Capacity Building 👩‍🏫</h4> <ul> <li><span class="font-semibold">Simultaneous Training Sessions:</span> Conduct training for all cold room operating groups: Women Self-Help Groups (SHGs), Producer Groups (PGs), Farmer Producer Organizations (FPOs), and Regulated Market Committee (RMC) staff.</li> <li><span class="font-semibold">Capacity Building Workshops:</span> Covering cold room operations and routine maintenance, digital inventory management using the Coldtivate app, basic financial bookkeeping and business management skills, and customer interaction and community engagement best practices.</li> <li><span class="font-semibold">Practical Trial Runs:</span> Initiate small-scale pilot storage operations at each site, allowing farmers/vendors to store produce and experience operational procedures firsthand. Provide continuous on-site guidance and support by Koel Fresh staff.</li> <li><span class="font-semibold">Monitoring and Feedback:</span> Regularly assess training effectiveness and operator readiness. Identify operational challenges early and refine training accordingly.</li> </ul> </div> <div class="timeline-item"> <h4>Months 3-8: Operational Launch, Awareness, Market Linkage Development 📈</h4> <ul> <li><span class="font-semibold">Cold Room Operations Begin:</span> Launch full-scale operations at all 41 sites by Month 4. Ensure daily availability of storage services for farmers and vendors.</li> <li><span class="font-semibold">Farmer & Vendor Onboarding:</span> Conduct targeted awareness drives in villages and markets. Promote cold room benefits through flyers, posters, loudspeaker announcements, and community meetings. Enroll farmers and vendors as regular users through SHG/FPO outreach.</li> <li><span class="font-semibold">Market Linkage Facilitation:</span> Koel Fresh teams connect SHGs/FPOs with bulk buyers such as wholesalers, retail chains, hotels, hospitals, hostels, food processors, and institutions. Schedule regular procurement pickups and aggregation planning.</li> <li><span class="font-semibold">Community Engagement:</span> Use existing platforms (weekly haats, panchayat meetings) to demonstrate use cases. Coordinate with NGOs and OLM to sustain participation and farmer confidence.</li> <li><span class="font-semibold">Mid-Project Review (Around Month 8):</span> Organize joint review meetings with district-level stakeholders. Evaluate utilization rates, SHG/FPO performance, and cold room impact. Identify and resolve any adoption, logistics, or maintenance challenges.</li> </ul> </div> <div class="timeline-item"> <h4>Months 9-12: Optimization, Evaluation & Sustainability Planning ✅</h4> <ul> <li><span class="font-semibold">Optimize Utilization & Financial Viability:</span> Focus on maximizing cold room usage across all sites. Analyze patterns of underutilization and implement corrective actions. Introduce or adjust incentive programs to encourage greater usage (if required).</li> <li><span class="font-semibold">Strong Market Linkages:</span> Refine existing procurement schedules with bulk buyers. Expand partnerships for consistent off-take of produce. Support operators in diversifying customer base (e.g., events, hostels, processors).</li> <li><span class="font-semibold">Build Long-Term Sustainability:</span> Assist SHGs/FPOs in developing Standard Operating Procedures (SOPs). Support preparation of basic business and operational plans for self-reliance. Guide cooperatives on setting service charges, reinvestment, and maintenance models.</li> <li><span class="font-semibold">Performance Evaluation:</span> Conduct site-wise assessment against Key Performance Indicators (KPIs) including utilization rates, farmer and SHG income improvements, market linkage volumes, and reduction in spoilage/waste. Capture field data, testimonials, and success stories.</li> </li><li><span class="font-semibold">Project Closure & Knowledge Sharing:</span> Organize district-level closure workshops to present results and highlight best practices. Host a state-level closure and learning event with all stakeholders. Document lessons learned and outline the roadmap for replication and long-term integration.</li> </ul> </div> </div> </section>
                <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">❄️ Cold Room Site Details: A Deeper Look ❄️</h3> <p class="text-center text-lg mb-8">The project strategically utilizes 41 cold storage rooms, integrating both existing infrastructure and new solar-powered units, tailored to local needs and community empowerment.</p> <div class="mb-8"> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Location & Ownership Model:</h4> <p class="text-md mb-4">Cold rooms are strategically located to maximize accessibility and impact, reflecting a dual ownership model to best serve local communities.</p> <div class="ownership-bar-container"> <div class="ownership-bar-rmc" style="width: calc(11 / 41 * 100%);">11 RMC Premises</div> <div class="ownership-bar-community" style="width: calc(30 / 41 * 100%);">30 Community-Managed</div> </div> <p class="text-sm text-gray-600 mt-2">11 sites are on Regulated Market Committee (RMC) yards, facilitating direct access for market vendors. The remaining 30 are at farm-gate or village cluster locations, operated by women’s Self-Help Groups (SHGs), Producer Groups (PGs), or Farmer Producer Organizations/Companies (FPOs/FPCs).</p> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Existing vs. New Facilities:</h4> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">🔄</span><div><h5 class="font-semibold text-lg">31 Existing Cold Rooms:</h5><p class="text-sm text-gray-600">Leveraged immediately, these units will be activated by training current operators or bringing in SHG/FPO management to address low utilization.</p></div></li> <li class="icon-list-item"><span class="icon">☀️</span><div><h5 class="font-semibold text-lg">10 New Solar-Powered Units (by OREDA):</h5><p class="text-sm text-gray-600">These 10MT units expand capacity in identified gaps, ensuring uninterrupted cooling with 5-year maintenance support, aligning with sustainable energy goals.</p></div></li> </ul> </div> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Capacity and Technology:</h4> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📦</span><div><h5 class="font-semibold text-lg">Storage Capacity:</h5><p class="text-sm text-gray-600">Each cold room typically ranges from 5 to 30 metric tons of perishable produce storage, adaptable to local needs.</p></div></li> <li class="icon-list-item"><span class="icon">⚙️</span><div><h5 class="font-semibold text-lg">Advanced Technology:</h5><p class="text-sm text-gray-600">All units, new and existing, are equipped with precise temperature control systems and IoT sensors for optimal monitoring and management.</p></div></li> </ul> </div> </div> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Community-Centric Operations Model:</h4> <p class="text-md mb-4">Each site adopts a community-centric model, empowering local groups and fostering ownership, a key to the project's success.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">👩‍👩‍👧‍👦</span><div><h5 class="font-semibold text-lg">Managed by Local Cooperatives:</h5><p class="text-sm text-gray-600">Wherever possible, cold rooms are managed by local women’s cooperatives (SHGs/FPOs), providing livelihood opportunities and encouraging local trust.</p></div></li> <li class="icon-list-item"><span class="icon">🌟</span><div><h5 class="font-semibold text-lg">Rourkela Pilot Success:</h5><p class="text-sm text-gray-600">The Rourkela pilot demonstrated that women-run cold rooms significantly increase farmers’ incomes and create new economic opportunities for women entrepreneurs.</p></div></li> <li><span class="icon">🤝</span><div><h5 class="font-semibold text-lg">Integrated Operations:</h5><p class="text-sm text-gray-600">At some sites, existing FPOs or cooperative marketing societies lead operations, integrating their members into project activities for seamless functionality.</p></div></li> </ul> </div> </section>
                <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-8">🏛️ Institutional Framework & Project Structure 🏛️</h3> <p class="text-center text-lg mb-8">A robust institutional framework, anchored by the MoU between the Directorate of Horticulture, Odisha and Delivery Associates UK, guides the project's implementation, establishing clear roles and collaboration mechanisms.</p> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Governing Bodies: State Level Oversight</h4> <p class="text-md text-center mb-6">Overall policy guidance and strategic direction are provided at the state level, ensuring alignment with government objectives and swift issue resolution.</p> <div class="flex flex-col items-center"> <div class="org-chart-node">Directorate of Horticulture (DoH)<br><span class="text-sm font-normal text-gray-600">Overall Policy Guidance & Integration</span></div><div class="org-chart-arrow">⬇️</div> <div class="org-chart-node">State-Level Steering Committee<br><span class="text-sm font-normal text-gray-600">Chaired by Director of Horticulture (Monthly Meetings)</span></div><div class="org-chart-line"></div> <div class="org-chart-flex"> <div class="org-chart-node"><span class="font-semibold">DDH (Nodal Officer)</span><br><span class="text-sm font-normal text-gray-600">Ensures district administration support</span></div> <div class="org-chart-node"><span class="font-semibold">OLM & ORMAS Officials</span><br><span class="text-sm font-normal text-gray-600">Livelihoods Mission & Rural Marketing Society</span></div> <div class="org-chart-node"><span class="font-semibold">RMC Leadership</span><br><span class="text-sm font-normal text-gray-600">Regulated Market Committee</span></div> <div class="org-chart-node"><span class="font-semibold">Koel Fresh District Coordinator</span><br><span class="text-sm font-normal text-gray-600">Liaison & Site-level Execution Oversight</span></div> </div> </div> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Koel Fresh’s Central Role: Project Management & Field Execution</h4> <p class="text-md text-center mb-6">Koel Fresh serves as the primary implementing agency, coordinating all activities across the 41 sites and driving the project's core focus areas.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📍</span><div><h5 class="font-semibold text-lg">Project Management Unit (PMU) & Field Arm</h5><p class="text-sm text-gray-600">Coordinates all activities from technical support and training to market linkage facilitation across all 41 sites.</p></div></li> <li class="icon-list-item"><span class="icon">🎯</span><div><h5 class="font-semibold text-lg">Executing Three Core Focus Areas</h5><ul class="list-disc list-inside text-sm text-gray-600 ml-4"><li>Maximizing cold room utilization</li><li>Building capacity of SHGs/FPOs to manage units</li><li>Linking farmers to markets for better incomes</li></ul><p class="text-sm text-gray-600 mt-1">These mirror the Rourkela model's success in providing infrastructure, connecting farmers to buyers, and empowering women's groups.</p></div></li> <li class="icon-list-item"><span class="icon">🗺️</span><div><h5 class="font-semibold text-lg">District Coordinators</h5><p class="text-sm text-gray-600">Dedicated coordinators deployed in each of the 9 districts to liaise with local officials and oversee site-level execution.</p></div></li> </ul> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Delivery Associates’ Role: Performance & Replication</h4> <p class="text-md text-center mb-6">Delivery Associates (UK) brings expertise in performance management, ensuring outcome-oriented implementation and facilitating knowledge sharing.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📊</span><div><h5 class="font-semibold text-lg">Performance Management & KPI Dashboards</h5><p class="text-sm text-gray-600">Helps design KPI dashboards and facilitates problem-solving sessions to ensure project stays outcome-oriented.</p></div></li> <li class="icon-list-item"><span class="icon">📝</span><div><h5 class="font-semibold text-lg">Documentation & Replication</h5><p class="text-sm text-gray-600">Documents the process for future replication and scaling of the successful model.</p></div></li> <li class="icon-list-item"><span class="icon">🤝</span><div><h5 class="font-semibold text-lg">Donor Reporting & Capacity Building</h5><p class="text-sm text-gray-600">Monitors and reports to donors (like Bloomberg Philanthropies) and may embed advisors to build capacity in data-driven delivery.</p></div></li> </ul> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Local Governance & Ownership: District Level Coordination</h4> <p class="text-md text-center mb-6">Institutional anchoring at the district level secures buy-in from all relevant authorities and keeps the project high on the agenda, ensuring local relevance and support.</p> <div class="flex flex-col items-center"> <div class="org-chart-node">District Collector / Addl. Collector<br><span class="text-sm font-normal text-gray-600">Chair of District Working Group (Bi-monthly Meetings)</span></div><div class="org-chart-arrow">⬇️</div> <div class="org-chart-node">District Working Group<br><span class="text-sm font-normal text-gray-600">Tracks progress, mobilizes resources, resolves issues</span></div><div class="org-chart-line"></div> <div class="org-chart-flex"> <div class="org-chart-node"><span class="font-semibold">DDH (Nodal Officer)</span><br><span class="text-sm font-normal text-gray-600">Ensures district administration support</span></div> <div class="org-chart-node"><span class="font-semibold">OLM & ORMAS Officials</span><br><span class="text-sm font-normal text-gray-600">Livelihoods Mission & Rural Marketing Society</span></div> <div class="org-chart-node"><span class="font-semibold">RMC Leadership</span><br><span class="text-sm font-normal text-gray-600">Regulated Market Committee</span></div> <div class="org-chart-node"><span class="font-semibold">Koel Fresh District Coordinator</span><br><span class="text-sm font-normal text-gray-600">Liaison & Site-level Execution Oversight</span></div> </div> </div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">This institutional setup effectively balances government oversight, professional project management, and crucial community ownership, ensuring all stakeholders work towards shared outcomes.</p> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">👥 Stakeholder Engagement & Roles: A Collaborative Ecosystem 👥</h3> <p class="text-center text-lg mb-8">Successful execution hinges on coordinated efforts among a diverse set of stakeholders, each playing a specific and crucial role in the project's success.</p> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"> <div class="stakeholder-card"><h4><span class="icon">🌿</span> Directorate of Horticulture (State Level)</h4> <p class="text-sm text-gray-600 mb-3">Provides overall leadership, policy guidance, and integration with state horticulture schemes.</p><ul><li>Issues necessary government orders for facility use and SHG/FPO management.</li><li>Monitors project progress against horticultural development goals.</li><li>Facilitates funds disbursement and champions the initiative to district officials.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🏡</span> District Horticulture Offices (DDH/ADH/AHO)</h4> <p class="text-sm text-gray-600 mb-3">Act as nodal points in each district, ensuring local integration and farmer mobilization.</p><ul><li>Convenes district working groups and mobilizes farmers through block-level officers.</li><li>Assists in new site selection, verifies cold room readiness, and supports training.</li><li>Validates data on utilization and farmer outreach for reporting.</li><li>Can utilize district funds to plug resource gaps (e.g., transport vehicles).</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🛒</span> Regulated Market Committee (RMC) Officials</h4> <p class="text-sm text-gray-600 mb-3">Crucial for cold rooms on market yards, facilitating access and market integration.</p><ul><li>Facilitates space allocation, infrastructure support, and utility access.</li><li>Helps advertise cold storage services to traders and farmers.</li><li>Assists in price discovery and may coordinate user fees and power collection.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👩‍👧‍👦</span> Odisha Livelihoods Mission (OLM)</h4> <p class="text-sm text-gray-600 mb-3">Empowers SHGs by mobilizing, recommending, and providing capacity building support.</p><ul><li>Mobilizes and recommends suitable Women’s Self-Help Groups (SHGs) to operate cold rooms.</li><li>Provides capacity building in group management and financial literacy.</li><li>May extend bank linkage programs or revolving funds for working capital.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">📈</span> Odisha Rural Development and Marketing Society (ORMAS)</h4> <p class="text-sm text-gray-600 mb-3">Specializes in market linkage for rural products, ensuring profitable outlets for produce.</p><ul><li>Connects cold room user groups with higher-order markets and bulk buyers.</li><li>Facilitates tie-ups with large buyers and includes produce in trade fairs.</li><li>Assists in developing branding/packaging and amplifies success stories.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👑</span> District Collectors and Administration</h4> <p class="text-sm text-gray-600 mb-3">Highest authority at the district level, providing oversight and administrative support.</p><ul><li>Convenes coordination meetings and expedites necessary permissions.</li><li>Lends administrative backing, signaling project importance to line departments.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🤝</span> Community Development/NGO Partners</h4> <p class="text-sm text-gray-600 mb-3">Ensures community buy-in, extends project reach, and provides local expertise.</p><ul><li><span class="font-semibold">SEWA:</span> Mobilizes women vendors, trains in business practices, provides mentorship.</li><li><span class="font-semibold">SEWAK:</span> Facilitates community meetings, resolves local issues, promotes horticulture.</li><li><span class="font-semibold">PRADAN/APC Agencies:</span> Mobilizes farmers in Producer Groups, provides technical knowledge on value chain development.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">⚡</span> OREDA (Odisha Renewable Energy Development Agency)</h4> <p class="text-sm text-gray-600 mb-3">Responsible for the technical aspects of new solar cold storage units.</p><ul><li>Ensures timely installation and technical commissioning of 10 new units.</li><li>Provides demos on basic maintenance and handles major technical servicing.</li><li>May integrate solar systems with data loggers for energy tracking.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👨‍💻</span> Koel Fresh Team</h4> <p class="text-sm text-gray-600 mb-3">Manages the project and engages daily with all stakeholders, ensuring smooth communication and coordination.</p><ul><li>Ensures smooth communication and updates with horticulture officers.</li><li>Collaborates with OLM/NGOs to avoid duplication in training efforts.</li><li>Orchestrates joint visits with key stakeholders to showcase progress and maintain transparency.</li></ul></div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">This integrated approach, with clearly defined roles and robust communication channels, ensures a holistic support system around each cold room site, mitigating risks and driving collective success.</p> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">⚙️ Implementation Components & Strategy: Actionable Steps ⚙️</h3> <p class="text-center text-lg mb-8">Koel Fresh implements the project through several interlinked components, each addressing a critical success factor for the cold room ecosystem, ensuring a comprehensive and effective rollout.</p> <ul><li><span class="icon">🔍</span> Feasibility Studies and Site Readiness</li><li><span class="font-semibold">Technical Feasibility:</span> Verify cold room functionality, inspect equipment, assess location specifics (access, water, security). Minor civil/electrical works in first 2 months.</li><li><span class="font-semibold">Economic Feasibility:</span> Analyze catchment area produce volume, peak harvest times, potential utilization, and revenue. Strategies for low-usage sites.</li><li><span class="font-semibold">Social Readiness:</span> Engage community early through meetings to gauge interest, address concerns, and integrate existing user groups.</li><li><span class="font-semibold">Institutional Readiness:</span> Ensure RMC resolutions/letters, formal SHG bank accounts, and facilitate any local licensing/paperwork.</li><li><span class="font-semibold">"Green Signal" Checklist:</span> District coordinator and central team verification before moving to next phase.</li></ul></div> <div class="component-card"><h4><span class="icon">🎓</span> Capacity Building of SHGs/FPOs to Operate Cold Rooms</h4><p class="text-sm text-gray-600 mb-3">A structured training and handholding program empowers local women’s groups and cooperatives to manage cold rooms as sustainable enterprises.</p><ul><li><span class="font-semibold">Cold Storage Operations:</span> Training on cold room mechanics, optimal temperatures, loading, stacking, and routine maintenance.</li><li><span class="font-semibold">Inventory Management & Mobile App:</span> Hands-on training on Coldtivate app (local language, visual cues, shelf-life prediction, SMS alerts).</li><li><span class="font-semibold">Customer Service & Community Engagement:</span> Soft skills, role-play, and conducting awareness sessions to become "cold chain entrepreneurs."</li><li><span class="font-semibold">Business & Financial Management:</span> Ledger maintenance, cost calculation, profit management, and understanding Cooling-as-a-Service (CaaS) model.</li><li><span class="font-semibold">Market Linkage & Quality Control:</span> Sorting, grading, packaging, negotiation, and exposure visits to markets/packhouses.</li><li><span class="font-semibold">Training Delivery:</span> 3-5 day intensive training (classroom & practical), visuals, peer learning, "train-the-trainer" approach, ongoing handholding.</li><li><span class="font-semibold">Outcomes:</span> Independent cold room management, accurate record-keeping, financial reporting, new member training, basic problem-solving.</li></ul></div> <div class="component-card"><h4><span class="icon">💰</span> Operational Support (Incentives, Working Capital, Onboarding)</h4><p class="text-sm text-gray-600 mb-3">Targeted support ensures quick operationalization and smooth running of cold rooms, especially in early stages.</p><ul><li><span class="font-semibold">Onboarding Support:</span> Guiding groups through operations plan, SOP handbook, and facilitating local kickoff events for legitimacy.</li><li><span class="font-semibold">Working Capital & Equipment Grants:</span> Working capital to be explored through OLM, ORMAS and other government programs.</li><li><span class="font-semibold">Incentive Facilitation:</span> Subsidized storage fees for farmers (e.g., free first days, promotions) and recognition for top-performing operators (acknowledgements, awards).</li><li><span class="font-semibold">Troubleshooting & Maintenance:</span> Rapid response mechanism, 48-hour issue resolution, regional technical assistants, 24x7 helpline.</li><li><span class="font-semibold">Standardizing Operating Procedures:</span> Uniform ticketing, daily sanitation routines, random checks for consistency and mentorship.</li></ul></div> <div class="component-card"><h4><span class="icon">📢</span> Awareness and Outreach Campaigns</h4><p class="text-sm text-gray-600 mb-3">Vigorous campaigns ensure farmers and market actors are informed and motivated to utilize the cold room facilities.</p><ul><li><span class="font-semibold">Local Launch Events:</span> Inaugurations with farmers, traders, demonstrations, and testimonials.</li><li><span class="font-semibold">Print Materials:</span> Simple, pictorial flyers/posters in local languages distributed widely.</li><li><span class="font-semibold">Village & Market Outreach:</span> Mobile announcements, info desks at weekly haats, collaboration with agri-input dealers.</li><li><span class="font-semibold">Mass Media & Digital:</span> Community radio, low-cost WhatsApp campaigns (explainer videos, infographics), engaging local influencers.</li><li><span class="font-semibold">School & Community Integration:</span> Competitions on food waste, SHG operators as community leaders.</li><li><span class="font-semibold">Continuous Promotion:</span> Sustained outreach, intensification before harvests, sharing success stories.</li></ul></div> <div class="component-card"><h4><span class="icon">🔗</span> Market Linkage Facilitation with Bulk Buyers</h4><p class="text-sm text-gray-600 mb-3">A core objective is to help farmers realize better prices and assured sales by facilitating connections with bulk buyers.</p><ul><li><span class="font-semibold">Identifying Bulk Buyers:</span> Mapping potential purchasers (retail chains, institutions, processors, city wholesale markets).</li><li><span class="font-semibold">Buyer MoUs & Aggregation:</span> Facilitating agreements, scheduling pickups, cold room as collection point, exploring transport solutions (e.rickshaw).</li><li><span class="font-semibold">Market Price Info & Decision Making:</span> Coldtivate app for market intelligence (prices, trends), tailored advice to operators/farmers.</li><li><span class="font-semibold">Facilitating Transactions:</span> Overseeing initial sales, quality checks, payment flow (direct to SHG/FPO), dispute resolution.</li><li><span class="font-semibold">Building Sustainable Supply Chains:</span> Institutionalizing linkages, meeting buyer preferences, basic value addition, targeting 2-3 regular buyers per site.</li><li><span class="font-semibold">Volume Targets:</span> Setting and tracking targets for produce sold via bulk linkages, troubleshooting lagging sites.</li></ul></div> <div class="component-card"><h4><span class="icon">📱</span> Digital Integration: Data Tracking, App, & Dashboards</h4><p class="text-sm text-gray-600 mb-3">Digital tools enhance efficiency, transparency, and decision-making, transforming cold rooms into data-driven hubs.</p><ul><li><span class="font-semibold">Coldtivate App Deployment:</span> Primary tool for inventory/operations, linked to IoT sensors, real-time logging, shelf-life prediction, SMS notifications.</li><li><span class="font-semibold">Data Dashboards:</span> Cloud-based system aggregating key metrics (utilization, farmers served, volume, turnover, issues) for managers and stakeholders.</li><li><span class="font-semibold">Decision Support & Alerts:</span> Automated alerts for temperature deviations, low utilization, or full capacity to trigger interventions.</li><li><span class="font-semibold">Integration with Government Systems:</span> Coordinating with Horticulture MIS for continuity and impact evaluation.</li><li><span class="font-semibold">Farmer Interface:</span> Basic phone list, web links/SMS query system for tech-savvy farmers, SHG/NGO as info conduits for others.</li><li><span class="font-semibold">Data Privacy & Ownership:</span> Secure storage, project partner ownership, consent for farmer data, anonymized donor reports.</li></ul><p class="text-md text-center mt-6 font-semibold" style="color: #4CAF50;">Digital integration is a game-changer, streamlining operations, providing sophisticated analytics, and building transparency and accountability across the project.</p></div> </div> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">📚 Communication Materials & Documentation: Sharing Knowledge & Impact 📚</h3> <p class="text-center text-lg mb-8">Koel Fresh will lead the creation of a comprehensive suite of communication materials to educate, motivate, and share learnings, serving both operational and stakeholder engagement needs.</p> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"> <div class="component-card"><h4><span class="icon">📖</span> Training Manuals and SOP Guides</h4><p class="text-sm text-gray-600 mb-3">User-friendly manuals and quick reference guides ensure operators have essential information for daily cold room management.</p><ul><li><span class="font-semibold">Operator’s Handbook:</span> In Odia and English, with step-by-step procedures, troubleshooting, safety, and support contacts. Heavily illustrated for semi-literate users.</li><li><span class="font-semibold">Quick Reference Posters:</span> For cold room/office walls, listing daily checklists, produce-specific storage tips, and operational flowcharts.</li><li><span class="font-semibold">Video Content:</span> Short explainer videos for farmers, testimonials from women operators, and training videos demonstrating operational steps.</li></ul></div> <div class="component-card"><h4><span class="icon">📣</span> Awareness and Promotional Materials</h4><p class="text-sm text-gray-600 mb-3">Attractive and targeted materials to inform farmers and market actors about the cold room facilities and their benefits.</p><ul><li><span class="font-semibold">Flyers and Brochures:</span> Pictorial, in local languages, with project branding, fees, and contact details. Tri-fold brochures for formal settings.</li><li><span class="font-semibold">Mass Media & Digital:</span> Community radio, low-cost WhatsApp campaigns (explainer videos, infographics), engaging local influencers.</li><li><span class="font-semibold">School & Community Integration:</span> Competitions on food waste, SHG operators as community leaders.</li><li><span class="font-semibold">Continuous Promotion:</span> Sustained outreach, intensification before harvests, sharing success stories.</li></ul></div> <div class="component-card"><h4><span class="icon">📝</span> Case Studies and Documentation</h4><p class="text-sm text-gray-600 mb-3">Compiling notable successes and challenges into narrative case studies to share learnings and demonstrate impact.</p><ul><li><span class="font-semibold">Farmer Success Story:</span> Highlighting income increase due to cold storage, with before/after data and quotes.</li><li><span class="font-semibold">Women SHG Empowerment Story:</span> Detailing capacity building, improved livelihoods, and gender impact.</li><li><span class="font-semibold">Technical Innovation Story:</span> Explaining digital integration (Coldtivate) and data-driven decision-making.</li></ul></div> <div class="component-card"><h4><span class="icon">📊</span> Progress Reports and Slide Decks</h4><p class="text-sm text-gray-600 mb-3">Concise and polished reports and presentations to keep government officials and donors engaged and informed of progress.</p><ul><li><span class="font-semibold">Weekly/Quarterly Decks:</span> Highlighting progress in numbers, field stories, and qualitative updates.</li><li><span class="font-semibold">Data Visualization:</span> Visualizing dashboard data, utilization trends, and overall project narrative.</li><li><span class="font-semibold">Consistent Format:</span> Ensuring easy trend spotting and alignment with global reporting best practices.</li></ul></div> <div class="component-card"><h4><span class="icon">🗣️</span> Multilingual and Culturally Adapted Materials</h4><p class="text-sm text-gray-600 mb-3">Ensuring materials are translated and culturally adapted to resonate with diverse local communities, including tribal regions.</p><ul><li><span class="font-semibold">Translation:</span> Materials in Odia and local tribal languages where applicable.</li><li><span class="font-semibold">Cultural Adaptation:</span> Incorporating local symbols or references to ensure messaging is respectful and relatable.</li><li><span class="font-semibold">Local Collaboration:</span> Working with NGO partners to ensure effective communication and community resonance.</li></ul></div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">By developing high-quality, consistent, and culturally relevant communication materials, the project builds credibility, fosters trust, and ensures widespread understanding and sustained engagement among all stakeholders.</p> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">📈 Monitoring, Evaluation & Reporting: Tracking Impact & Progress 📈</h3> <p class="text-center text-lg mb-8">Robust monitoring and reporting mechanisms are in place to track implementation, measure outcomes, and inform decision-making, ensuring accountability and real-time course correction.</p> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"> <div class="component-card"><h4><span class="icon">📊</span> Weekly Dashboard Reporting</h4><p class="text-sm text-gray-600 mb-3">Weekly updated dashboards summarize key performance indicators for each site and district, keeping the project team and government informed and maintaining momentum.</p><ul><li><span class="font-semibold">Key Indicators:</span> Cold room utilization rate, number of farmers/vendors (gender disaggregated), volume stored/sold, spoilage instances, income earned (SHG/FPO & farmers), downtime/technical issues.</li><li><span class="font-semibold">Routine Review Calls:</span> Brief virtual meetings to discuss dashboard, flag red flags, and share quick wins.</li></ul></div> <div class="component-card"><h4><span class="icon">🗓️</span> Monthly Review Meetings and Slide Decks</h4><p class="text-sm text-gray-600 mb-3">Comprehensive monthly reviews at state and district levels, using slide decks to highlight cumulative progress, targets, and qualitative insights.</p><ul><li><span class="font-semibold">Slide Deck Content:</span> Cumulative progress, comparison against targets, qualitative insights, charts (utilization trends, income increase), field photos, component updates.</li><li><span class="font-semibold">Review Forums:</span> State Steering Committee (with DoH & Delivery Associates) and District Working Group (chaired by Collector).</li></ul></div> <div class="component-card md:col-span-2"><h4><span class="icon">🎯</span> Key Performance Indicators (KPIs)</h4><p class="text-sm text-gray-600 mb-3">Specific KPIs are tracked to measure project success against its core objectives.</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-4"><ul><li><span class="icon">📊</span> <span class="font-semibold">Cold Room Utilization:</span> Target $\ge$ 70% average by year-end (higher during peak seasons).</li><li><span class="icon">💰</span> <span class="font-semibold">Farmer Income Increase:</span> Aim for 20-30% increase in average selling price for participating farmers (via surveys).</li><li><span class="icon">👩‍👧‍👦</span> <span class="font-semibold">SHG/Operator Income:</span> Target $\ge$ INR 5,000 net income per month per group by Month 12 for sustainable profit.</li></ul><ul><li><span class="icon">🗑️</span> <span class="font-semibold">Post-Harvest Loss Reduction:</span> Estimate reduction in waste/spoilage (aim for 75% reduction, similar to Rourkela pilot).</li><li><span class="icon">🔗</span> <span class="font-semibold">Market Linkage Volume and Value:</span> Total quantity/revenue from produce sold to bulk/institutional buyers (indicating market access improvement).</li><li><span class="icon">✅</span> <span class="font-semibold">Operational Sustainability:</span> Percentage of operating costs covered by revenues at each site by year-end (aim for basic expenses covered).</li><li><span class="icon">👥</span> <span class="font-semibold">Participation Metrics:</span> Number of women SHG members actively involved/trained, youth employed (additional social indicators).</li></ul></div></div> <div class="component-card"><h4><span class="icon">🚶‍♀️</span> Monitoring Visits</h4><p class="text-sm text-gray-600 mb-3">Regular field monitoring visits by Koel Fresh and government officials ensure oversight, data verification, and direct interaction with beneficiaries.</p><ul><li><span class="font-semibold">Frequency:</span> At least once a quarter for each district (joint site visits).</li><li><span class="font-semibold">Activities:</span> Observe operations, interact with farmers/SHG members, verify data (e.g., cross-check digital records with physical stock).</li><li><span class="font-semibold">Donor Involvement:</span> Anticipate and prepare for visits from donor representatives to showcase progress.</li></ul></div> <div class="component-card"><h4><span class="icon">🔄</span> Mid-Term Evaluation</h4><p class="text-sm text-gray-600 mb-3">An internal evaluation around the 6-month mark assesses progress against midline targets and informs mid-course corrections.</p><ul><li><span class="font-semibold">Process:</span> Survey sample of farmers and all SHG operators to gauge satisfaction, difficulties, and suggestions.</li><li><span class="font-semibold">Evaluation:</span> Against midline targets (e.g., ~50% of end target for KPIs).</li><li><span class="font-semibold">Outcome:</span> Mid-course correction plan if components are lagging (e.g., market linkage weakness).</li></ul></div> <div class="component-card md:col-span-2"><h4><span class="icon">📝</span> Final Evaluation and Reporting</h4><p class="text-sm text-gray-600 mb-3">A comprehensive year-end evaluation measures overall impact, compiles a master report, and informs future scale-up and funding.</p><ul><li><span class="font-semibold">Process:</span> Comprehensive evaluation, potentially with external agency or Delivery Associates experts for objectivity.</li><li><span class="font-semibold">Master Report:</span> Details activities, KPI data, impact case studies, lessons learned.</li><li><span class="font-semibold">Purpose:</span> Informs Odisha government for scale-up and Bloomberg/donors for future funding.</li><li><span class="font-semibold">Visuals:</span> Uses dashboard visuals and field stories (e.g., X tons stored, Y farmers served, Z income increase, P tons saved).</li></ul></div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">The M&E system serves as both an accountability exercise and a management tool, rigorously tracking performance to demonstrate success (improved farmer income, women's empowerment) with evidence, and ensuring prompt problem-solving.</p> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">⚠️ Risk Management: Proactive Mitigation for Success ⚠️</h3> <p class="text-center text-lg mb-8">A proactive risk management strategy is central to ensuring smooth implementation, sustainability, and long-term success of the cold room ecosystem, anticipating and addressing potential challenges.</p> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"> <div class="risk-card"><h4><span class="icon">⚙️</span> Operational Risks</h4><p class="text-sm text-gray-600 mb-3">Risks related to the day-to-day running of cold rooms and adherence to operational standards.</p><ul><li>Inconsistent cold room operation (limited local capacity, process lapses).</li><li>Improper produce handling (damage, spoilage, customer dissatisfaction).</li><li>Lack of adherence to SOPs or poor record-keeping by operators.</li></ul><h5>Mitigation Strategies:</h5><ul><li>Regular site visits by Koel Fresh field coordinators for assessment and issue resolution.</li><li>Weekly checklists for cleanliness, power, equipment, and user records.</li><li>Implement local language SOPs, accessible at each site.</li><li>Continuous mentoring and handholding for SHG/FPO operators (initial 6-8 months).</li><li>Utilize Coldtivate app for real-time inventory, operational alerts, and user tracking.</li></ul></div> <div class="risk-card"><h4><span class="icon">📉</span> Market Risks</h4><p class="text-sm text-gray-600 mb-3">Challenges related to connecting stored produce with profitable markets and managing price volatility.</p><h5>Potential Issues:</h5><ul><li>Inability to connect stored produce with reliable markets in time.</li><li>Price fluctuations or oversupply affecting farmer revenue.</li><li>Over-dependence on a single buyer or market channel.</li></ul><h5>Mitigation Strategies:</b><ul><li>Establish multiple market linkages per site (local traders, institutions, government, retail, processors).</li><li>Provide price intelligence and market demand info via Coldtivate app and field updates.</li><li>Facilitate forward purchase agreements or informal buy-back commitments.</li><li>Develop value-addition/aggregation models (packaging, branding, cold room-based vending) for income diversification).</li></ul></div> <div class="risk-card"><h4><span class="icon">🔌</span> Technical Risks</h4><p class="text-sm text-gray-600 mb-3">Threats related to equipment malfunction and the technical capacity to address them.</p><h5>Potential Issues:</h5><ul><li>Breakdowns in refrigeration, IoT, or solar equipment leading to storage failures.</li><li>Lack of technical knowledge among operators to identify or report issues.</li><li>Delays in repairs due to absence of maintenance contracts or spare parts.</li></ul><h5>Mitigation Strategies:</h5><ul><li>New solar cold rooms (10 units) come with 5-year maintenance contract by OREDA/vendors.</li><li>Map and onboard local refrigeration technicians in each district for rapid response.</li><li>Maintain a preventive maintenance calendar and checklist for operators.</li><li>Provide basic troubleshooting training to SHG/FPO members for early issue escalation.</li><li>Integrate IoT and temperature monitoring tools to flag anomalies and ensure data visibility.</li></ul></div> <div class="risk-card"><h4><span class="icon">💸</span> Financial Risks</h4><p class="text-sm text-gray-600 mb-3">Concerns regarding the financial viability and management of cold room operations by local groups.</p><h5>Potential Issues:</h5><ul><li>Low utilization in early months may not cover basic operating costs.</li><li>SHGs/FPOs may lack liquidity for operations (transport, packaging).</li><li>Poor financial management or record-keeping (misuse/underreporting of funds).</li><li>Lack of sustainability planning.</li></ul><h5>Mitigation Strategies:</h5><ul><li>Provide interest-free working capital grants at the beginning for startup costs.</li><li>Introduce performance-based incentives (rewards for high utilization, timely reporting).</li><li>Link SHGs/FPOs with banking partners via OLM/ORMAS for revolving funds/loans.</li><li>Train operators in basic bookkeeping/financial literacy; regular audits/record checks by Koel Fresh.</li><li>Enable digital receipts and payment records via Coldtivate/mobile apps for transparency.</li></ul></div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">These comprehensive measures ensure that common risks across operations, markets, technology, and finance are anticipated early, with mitigation plans embedded into the project design, supported by risk dashboards and escalation protocols.</p> </section>
                <section> <h3 class="section-title text-3xl text-center mb-8">🏁 Conclusion & Sustainability Roadmap: Long-Term Impact 🏁</h3> <p class="text-center text-lg mb-8">The cold room ecosystem initiative, led by Koel Fresh and anchored within the Bloomberg Cities Idea Exchange, is designed not only to address immediate post-harvest challenges but also to lay the foundation for long-term, community-driven agricultural resilience in Odisha.</p> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Expected Outcomes: One-Year Impact</h4> <p class="text-md text-center mb-6">By the end of the one-year implementation cycle, the project aims to deliver significant, measurable improvements across key areas.</p> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div class="component-card"><h4><span class="icon">📈</span> Increased Farmer Income</h4><p>Farmers gain the ability to store produce and delay sales until market prices are favorable, enhancing their bargaining power through aggregation and direct market linkages.</p></div> <div class="component-card"><h4><span class="icon">📉</span> Reduction in Post-Harvest Losses (Target ~75%)</h4><p>Temperature-controlled preservation for perishables like tomatoes, chilis, bananas, and leafy vegetables ensures more produce reaches the market in sellable condition, drastically reducing economic loss.</p></div> <div class="component-card"><h4><span class="icon">👩‍👧‍👦</span> Empowerment & Financial Sustainability for SHGs/FPOs</h4><p>Women’s SHGs and FPOs are trained as business entities, gaining confidence and income. Operational profits and institutional support build their entrepreneurial capacity for long-term success.</p></div> <div class="component-card"><h4><span class="icon">🤝</span> Robust Market Linkages</h4><p>Structured relationships with institutional buyers ensure predictable sales channels. Cold rooms serve as vital aggregation hubs, reducing the role of intermediaries and increasing direct market access for farmers.</p></div> </div> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Sustainability Beyond Project Timeline: Long-Term Vision</h4> <p class="text-md text-center mb-6">A key goal is for the ecosystem to continue functioning independently after the initial year, supported by local ownership, robust systems, and sustainable revenue streams.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"> <div class="component-card"><h4><span class="icon">自主</span> SHGs/FPOs Managing Cold Rooms Independently</h4><p>Community groups will be capable of handling all day-to-day operations, routine maintenance, user coordination, and customer service autonomously.</p></div> <div class="component-card"><h4><span class="icon">🔗</span> Institutionalized Market Relationships</h4><p>Ongoing tie-ups with buyers, fostered during the project, will ensure long-term demand assurance for cold room users, creating a steady income flow and keeping the infrastructure in use.</p>.</p></div> <div class="component-card"><h4><span class="icon">📱</span> Digital Tools Enabling Operational Efficiency</h4><p>The Coldtivate app will provide real-time data on inventory, temperature, utilization, and financials, ensuring data-driven decision making, performance monitoring, and transparent reporting long after project completion.</p></div> </div> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Future Recommendations: Scaling & Integration</h4> <p class="text-md text-center mb-6">To build on the success of the pilot phase, the following actions are recommended for broader impact and long-term viability.</p> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div class="component-card"><h4><span class="icon"> expand_content </span> Geographic Expansion into Additional Districts</h4><p>Replicate the successful model in other horticulture-intensive districts of Odisha, prioritizing areas with high distress selling, no current cold storage, or a strong existing presence of SHGs/FPOs.</p></div> <div class="component-card"><h4><span class="icon">🌍</span> National and Global Replication</h4><p>Showcase best practices and impact data to inspire adoption by other cities and states. Present the model on global platforms (e.g., COP, C40 Cities, GCF, SEforALL) to attract further investment and collaboration.</p></div> <div class="component-card"><h4><span class="icon"> integrad </span> Integration with Government Programs</li><p>Align with national schemes such as PMFME and MIDH, as well as state-level Agriculture Promotion and Investment Corporation (APICOL) programs, to achieve convergence and unlock co-funding opportunities.</p></div> <div class="component-card"><h4><span class="icon">💡</span> Knowledge Dissemination</h4><p>Develop and distribute comprehensive toolkits, Standard Operating Procedures (SOPs), and training modules for other implementing partners. Document institutional structures, pricing models, and digital tools to ease future scale-up efforts.</p></div> </div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">This roadmap ensures the project evolves beyond a standalone pilot, becoming a replicable, community-owned model for sustainable agriculture and women-led enterprise, rooted in decentralized governance and digital transparency.</p> </section>
            </main>
            <footer class="text-center mt-12 py-8 border-t-2 border-gray-200">
                <p style="color: #333333;">Driving sustainable agricultural practices and economic empowerment in Odisha.</p>
                <p class="text-sm mt-2" style="color: #1B5E20;">Bloomberg Cities Idea Exchange - Economic Vulnerability Project</p>
            </footer>
        </div> 
    `;
      const infographicPageChartScript = `
        function wrapLabels(label, maxLength = 16) { if (typeof label !== 'string') return label; if (label.length <= maxLength) return label; const words = label.split(' '); const lines = []; let currentLine = ''; for (const word of words) { if ((currentLine + word).length > maxLength && currentLine.length > 0) { lines.push(currentLine.trim()); currentLine = word + ' '; } else { currentLine += word + ' '; } } if (currentLine.trim().length > 0) lines.push(currentLine.trim()); return lines.length > 0 ? lines : [label]; }
        if (typeof Chart !== 'undefined' && document.getElementById('sitesChart')) { const sitesChartCtx = document.getElementById('sitesChart').getContext('2d'); new Chart(sitesChartCtx, { type: 'doughnut', data: { labels: [wrapLabels('Existing Cold Storage Installations'), wrapLabels('Brand New Upcoming Installations')], datasets: [{ label: 'Site Distribution', data: [31, 10], backgroundColor: ['#4CAF50', '#FFC107'], borderColor: ['#FFFFFF', '#FFFFFF'], borderWidth: 2 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { font: { size: 12, family: 'Open Sans' }, color: '#333333', padding: 15, boxWidth: 15 } }, tooltip: { backgroundColor: '#333333', titleFont: { size: 14, family: 'Montserrat', weight: 'bold' }, bodyFont: { size: 12, family: 'Open Sans' }, padding: 10, callbacks: { title: function(tooltipItems) { const item = tooltipItems[0]; let label = item.chart.data.labels[item.dataIndex]; return Array.isArray(label) ? label.join(' ') : label; } } } } } }); } else { console.error("Chart.js is not defined or canvas not found."); }
    `;

      const loadingIndicator = document.getElementById('loadingIndicator');
      function showLoading() { if (loadingIndicator) loadingIndicator.style.display = 'block'; }
      function hideLoading() { if (loadingIndicator) loadingIndicator.style.display = 'none'; }
      function showMessage(message, isConfirm = false, onConfirm = null) {
        const overlay = document.getElementById('customMessageBoxOverlay');
        const textEl = document.getElementById('customMessageText');
        const confirmBtn = document.getElementById('customMessageConfirm');
        const cancelBtn = document.getElementById('customMessageCancel');
        if (!overlay || !textEl || !confirmBtn || !cancelBtn) {
          // Fallback if message box elements are not found
          alert(message);
          if (isConfirm && onConfirm) onConfirm();
          return;
        }
        textEl.textContent = message;
        window.confirmCallback = onConfirm; // Store callback globally for confirmation
        if (isConfirm) {
          confirmBtn.textContent = 'Confirm';
          cancelBtn.style.display = 'inline-block';
        } else {
          confirmBtn.textContent = 'OK';
          cancelBtn.style.display = 'none';
        }
        overlay.classList.add('active'); // Show message box
      }

      // Event listeners for the custom message box buttons
      document.getElementById('customMessageConfirm')?.addEventListener('click', () => {
        document.getElementById('customMessageBoxOverlay').classList.remove('active');
        if (window.confirmCallback) {
          window.confirmCallback(); // Execute the stored callback
          window.confirmCallback = null; // Clear the callback
        }
      });
      document.getElementById('customMessageCancel')?.addEventListener('click', () => {
        document.getElementById('customMessageBoxOverlay').classList.remove('active');
        window.confirmCallback = null; // Clear the callback if canceled
      });


      // Function to update the visibility of elements with 'admin-only' class
      function updateAdminUI(isLoggedIn) {
        const adminElements = document.querySelectorAll('.admin-only');
        adminElements.forEach(el => {
          el.style.display = isLoggedIn ? 'inline-block' : 'none';
        });
      }

      // Handler for the Admin navigation button click
      function handleAdminNavClick() {
        if (isAdminLoggedIn) {
          // If already logged in, log out
          isAdminLoggedIn = false;
          document.getElementById('admin-nav-button').textContent = 'Admin';
          updateAdminUI(false); // Hide admin controls
          showMessage('You have been logged out.', false); // Show logout message
        } else {
          // If not logged in, show the admin login section
          showSection('admin-section');
        }
      }

      // Event listener for the admin login form submission
      document.getElementById('admin-login-form')?.addEventListener('submit', function (e) {
        e.preventDefault(); // Prevent default form submission
        const username = this.username.value;
        const password = this.password.value;

        // Simple hardcoded admin credentials for demonstration
        if (username === 'admin' && password === 'admin') {
          isAdminLoggedIn = true;
          document.getElementById('admin-nav-button').textContent = 'Logout'; // Change button text
          updateAdminUI(true); // Show admin controls
          showHomePage(); // Redirect to home page after login
          showMessage('Admin login successful.', false);
        } else {
          showMessage('Invalid username or password.', false);
          this.password.value = ''; // Clear password field
        }
      });

      // Function to show the Home (Infographic) page
      function showHomePage() {
        showLoading(); // Show loading indicator
        const trackerContentArea = document.getElementById('tracker-content-area');
        const infographicContentArea = document.getElementById('infographic-content-area');

        // Apply infographic-specific body class
        document.body.className = 'infographic-active';
        // Hide tracker content
        if (trackerContentArea) trackerContentArea.style.display = 'none';

        // Set infographic content and display it
        if (infographicContentArea) {
          infographicContentArea.innerHTML = infographicPageBodyHTML;
          infographicContentArea.style.display = 'block';
        }

        // Remove any existing Chart.js script to prevent conflicts
        const existingChartScript = document.head.querySelector('script[src="https://cdn.jsdelivr.net/npm/chart.js"]');
        if (existingChartScript) existingChartScript.remove();

        // Dynamically load Chart.js
        const chartJsScript = document.createElement('script');
        chartJsScript.src = "https://cdn.jsdelivr.net/npm/chart.js";
        chartJsScript.onload = () => {
          // Once Chart.js is loaded, initialize the chart
          const chartInitScriptElement = document.createElement('script');
          chartInitScriptElement.textContent = infographicPageChartScript;
          document.body.appendChild(chartInitScriptElement);
          hideLoading(); // Hide loading indicator after chart is rendered
        };
        chartJsScript.onerror = () => {
          console.error("Failed to load Chart.js.");
          hideLoading();
          showMessage("Error loading chart library.", false);
        };
        document.head.appendChild(chartJsScript);
      }


      function showSection(sectionIdToShow) {
        const trackerContentArea = document.getElementById('tracker-content-area');
        const infographicContentArea = document.getElementById('infographic-content-area');

        document.body.className = 'tracker-active';
        document.head.innerHTML = originalTrackerHeadContent;

        if (infographicContentArea) infographicContentArea.style.display = 'none';
        if (trackerContentArea) trackerContentArea.style.display = 'block';

        const allTrackerSectionDivIds = ['meetings-section', 'media-section', 'presentations-section', 'admin-section'];
        allTrackerSectionDivIds.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.style.display = (id === sectionIdToShow) ? 'block' : 'none';
          }
        });

        if (sectionIdToShow === 'media-section') fetchMediaGallery();
        if (sectionIdToShow === 'presentations-section') fetchPresentations();

        if (!document.querySelector('script[src="https://cdn.tailwindcss.com"]')) {
          const tailwindScript = document.createElement('script');
          tailwindScript.src = "https://cdn.tailwindcss.com";
          document.head.appendChild(tailwindScript);
        }
      }

      function fetchPresentations() {
        const presentationsContainer = document.getElementById('presentations-display-area');
        if (!presentationsContainer) { console.error("Presentations display area not found!"); return; }
        presentationsContainer.innerHTML = '<p style="text-align:center;">Loading presentations...</p>'; showLoading();
        // FIXED: Added sheetName parameter
        fetch(scriptURL + '?action=get_presentations&sheetName=Presentations')
          .then(res => res.json())
          .then(data => {
            if (data && data.error) throw new Error(data.error);
            const [headers, ...rows] = data;
            if (!Array.isArray(headers)) throw new Error("Invalid data format");
            const uniqueIdIndex = headers.indexOf('UniqueID');
            const weekIndex = headers.indexOf('Week');
            const titleIndex = headers.indexOf('Title');
            const iframeCodeIndex = headers.indexOf('IframeCode');

            let html = '';
            if (rows.length > 0) {
              const groupedByWeek = rows.reduce((acc, row) => {
                const week = row[weekIndex] || 'Uncategorized';
                if (!acc[week]) acc[week] = [];
                acc[week].push({
                  uniqueID: row[uniqueIdIndex],
                  title: row[titleIndex],
                  iframeCode: row[iframeCodeIndex]
                });
                return acc;
              }, {});

              Object.keys(groupedByWeek).sort((a, b) => (a.match(/\d+/) || [0])[0] - (b.match(/\d+/) || [0])[0]).forEach(week => {
                html += `<div class="presentation-week-group"><h3>${week}</h3>`;
                groupedByWeek[week].forEach(p => {
                  const responsiveIframeCode = p.iframeCode.replace(/width="[^"]*"/ig, '').replace(/height="[^"]*"/ig, '');
                  html += `<div class="presentation-item">${p.title ? `<h4>${p.title}</h4>` : ''}<div class="presentation-container">${responsiveIframeCode}</div><span class="admin-only"><button class="delete-button" onclick="deletePresentation('${p.uniqueID}')">Delete</button></span></div>`;
                });
                html += `</div>`;
              });
            } else {
              html = '<p style="text-align:center; margin-top:20px;">No presentations have been added yet.</p>';
            }
            presentationsContainer.innerHTML = html;
            updateAdminUI(isAdminLoggedIn); // Ensure admin controls visibility is correct
          })
          .catch(error => { console.error('Error fetching presentations:', error); presentationsContainer.innerHTML = `<p class="error-message">Error: ${error.message}</p>`; })
          .finally(() => hideLoading());
      }

      function renderTable(data, tableId, sectionType) {
        const tbody = document.querySelector(`#${tableId} tbody`);
        const thead = document.querySelector(`#${tableId} thead`);
        if (!thead || !tbody) { console.error(`Table elements not found for ${tableId}`); return; }
        thead.innerHTML = ""; tbody.innerHTML = "";

        if (!Array.isArray(data) || data.length === 0) {
          thead.innerHTML = `<tr><th>Notice</th></tr>`;
          tbody.innerHTML = `<tr><td>No entries found for ${sectionType}.</td></tr>`;
          return;
        }

        let [originalHeaders, ...rows] = data;
        let headersToDisplay = originalHeaders;
        let columnIndicesToKeep = Array.from({ length: originalHeaders.length }, (_, i) => i); // Default: keep all

        // Specific filtering for meeting-table
        if (tableId === 'meeting-table') {
          const excludedMeetingHeader = 'Photo URL'; // The header to exclude
          const photoUrlIndex = originalHeaders.indexOf(excludedMeetingHeader);

          if (photoUrlIndex > -1) {
            headersToDisplay = originalHeaders.filter(header => header !== excludedMeetingHeader);
            columnIndicesToKeep = originalHeaders
              .map((header, index) => ({ header, index }))
              .filter(item => item.header !== excludedMeetingHeader)
              .map(item => item.index);
          }
        }

        // Render table headers, adding an "Actions" column for admin
        thead.innerHTML = "<tr>" + headersToDisplay.map(h => `<th>${h}</th>`).join('') + "<th class='admin-only'>Actions</th></tr>";

        // Render table rows
        rows.forEach((row, i) => {
          const tr = tbody.insertRow();
          columnIndicesToKeep.forEach(colIndex => {
            const td = tr.insertCell();
            td.innerHTML = row[colIndex] || ''; // Using innerHTML to render line breaks if any
          });
          const actionCell = tr.insertCell();
          actionCell.className = 'admin-only';
          actionCell.innerHTML = `<button class="px-3 py-1 text-xs font-medium text-white bg-yellow-500 rounded hover:bg-yellow-600" onclick="edit${sectionType.charAt(0).toUpperCase() + sectionType.slice(1)}(${i + 2}, this.closest('tr'))">Edit</button>
                                  <button class="ml-1 px-3 py-1 text-xs font-medium text-white bg-red-600 rounded hover:bg-red-700" onclick="delete${sectionType.charAt(0).toUpperCase() + sectionType.slice(1)}(${i + 2})">Delete</button>`;
        });
        updateAdminUI(isAdminLoggedIn);
      }

      function fetchData() {
        showLoading();
        const meetingsUrl = scriptURL + '?action=get_meetings&sheetName=Meetings';
        const actionsUrl = scriptURL + '?action=get_actions&sheetName=Action Items';

        console.log("Fetching meetings from URL:", meetingsUrl);
        console.log("Fetching actions from URL:", actionsUrl);

        Promise.all([
          fetch(meetingsUrl).then(res => res.json()),
          fetch(actionsUrl).then(res => res.json())
        ])
          .then(([meetingsData, actionsData]) => {
            renderTable(meetingsData, 'meeting-table', 'meeting');
            renderTable(actionsData, 'action-table', 'action');
          })
          .catch(error => {
            console.error('Error fetching tracker data:', error);
            const meetingsColspan = 10;
            const actionsColspan = 6;
            document.querySelector('#meeting-table tbody').innerHTML = `<tr><td colspan="${meetingsColspan}" class="error-message">Error loading meetings: ${error.message}</td></tr>`;
            document.querySelector('#action-table tbody').innerHTML = `<tr><td colspan="${actionsColspan}" class="error-message">Error loading action items: ${error.message}</td></tr>`;
          })
          .finally(() => hideLoading());
      }

      function fetchMediaGallery() {
        const mediaGalleryDiv = document.getElementById('media-gallery');
        if (!mediaGalleryDiv) return;
        mediaGalleryDiv.innerHTML = '<p style="text-align:center;">Loading media gallery...</p>';
        showLoading();
        const fetchUrl = scriptURL + '?action=get_media_gallery&sheetName=Media';
        console.log("Fetching media gallery from URL:", fetchUrl);

        fetch(fetchUrl)
          .then(res => res.json())
          .then(data => {
            if (data && data.error) throw new Error(data.error);
            const [headers, ...rows] = data;
            if (!Array.isArray(headers)) throw new Error("Invalid data format");

            // Get indices for grouping
            const uniqueIdIndex = headers.indexOf('UniqueID');
            const weekInfoIndex = headers.indexOf('WeekInfo');
            const zoneIndex = headers.indexOf('Zone');
            const districtIndex = headers.indexOf('District');
            const fileUrlIndex = headers.indexOf('File URL');
            const fileTypeIndex = headers.indexOf('File Type');

            let html = '';
            if (rows.length > 0) {
              // Group by week, then by zone, then by district
              const grouped = {};
              rows.forEach(row => {
                const week = (weekInfoIndex !== -1 && row[weekInfoIndex]) ? String(row[weekInfoIndex]) : 'No Week Info';
                const zone = (zoneIndex !== -1 && row[zoneIndex]) ? String(row[zoneIndex]) : 'No Zone';
                const district = (districtIndex !== -1 && row[districtIndex]) ? String(row[districtIndex]) : 'No District';
                if (!grouped[week]) grouped[week] = {};
                if (!grouped[week][zone]) grouped[week][zone] = {};
                if (!grouped[week][zone][district]) grouped[week][zone][district] = [];
                grouped[week][zone][district].push({
                  uniqueID: row[uniqueIdIndex],
                  fileUrl: row[fileUrlIndex],
                  fileType: row[fileTypeIndex]
                });
              });

              Object.keys(grouped).sort((a, b) => {
                if (a === 'No Week Info') return 1;
                if (b === 'No Week Info') return -1;
                const numA = (a.match(/\d+/) || [0])[0];
                const numB = (b.match(/\d+/) || [0])[0];
                return numA - numB;
              }).forEach(week => {
                html += `<div class="media-week-group"><h3>${week}</h3>`;
                Object.keys(grouped[week]).sort().forEach(zone => {
                  html += `<div class="mb-4"><h4 style="color:#1B5E20;">Zone: ${zone}</h4>`;
                  Object.keys(grouped[week][zone]).sort().forEach(district => {
                    html += `<div class="mb-2"><h5 style="color:#388e3c;">District: ${district}</h5><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-2">`;
                    grouped[week][zone][district].forEach(media => {
                      let mediaHtml = '';
                      if (media.fileType && media.fileType.startsWith('image')) {
                        mediaHtml = `<img src="${media.fileUrl}" alt="Media" class="w-full h-48 object-cover rounded-md mb-2" onerror="this.onerror=null;this.src='https://placehold.co/400x240/cccccc/333333?text=Image+Load+Error';"/>`;
                      } else if (media.fileType && media.fileType.startsWith('video')) {
                        const driveFileIdMatch = media.fileUrl.match(/(?:(?:drive\.google\.com\/(?:file\/d\/|open\?id=))|(?:docs\.google\.com\/file\/d\/))([a-zA-Z0-9_-]+)(?:[\/\?&]|$)/);
                        const driveFileId = driveFileIdMatch ? driveFileIdMatch[1] : null;
                        let videoSrc = media.fileUrl;
                        if (driveFileId) {
                          videoSrc = `https://drive.google.com/uc?export=download&id=${driveFileId}`;
                        }
                        mediaHtml = `<video controls playsinline src="${videoSrc}" class="w-full h-48 object-cover rounded-md mb-2" onerror="this.onerror=null;this.src='https://placehold.co/400x240/cccccc/333333?text=Video+Thumbnail';"></video>`;
                      } else {
                        mediaHtml = `<img src="https://placehold.co/400x240/cccccc/333333?text=Unsupported+File" alt="Unsupported File" class="w-full h-48 object-cover rounded-md mb-2"/>`;
                      }
                      html += `<div class="media-item bg-gray-100 p-3 rounded-lg shadow-sm">${mediaHtml}<span class="admin-only"><button class="delete-button" onclick="deleteMedia('${media.uniqueID}')">Delete</button></span></div>`;
                    });
                    html += `</div></div>`;
                  });
                  html += `</div>`;
                });
                html += `</div>`;
              });
            } else {
              html = '<p style="text-align:center; margin-top:20px;">No media files have been uploaded yet.</p>';
            }
            mediaGalleryDiv.innerHTML = html;
            updateAdminUI(isAdminLoggedIn);
          })
          .catch(error => {
            console.error('Error fetching media gallery:', error);
            mediaGalleryDiv.innerHTML = `<p class="error-message">Error: ${error.message}</p>`;
          })
          .finally(() => hideLoading());
      }


      // --- Functions for Meeting Form Operations ---
      const meetingForm = document.getElementById('meeting-form');
      const actionForm = document.getElementById('action-form');
      const meetingModeDiv = document.getElementById('meeting-mode');
      const actionModeDiv = document.getElementById('action-mode');

      // Function to generate a simple unique ID
      function generateUniqueId() {
        return 'M' + Date.now() + Math.floor(Math.random() * 1000);
      }

      // Populate unique ID for new meeting
      if (meetingForm) {
        meetingForm.addEventListener('reset', () => {
          document.getElementById('meetingId').value = generateUniqueId();
          meetingModeDiv.textContent = 'Mode: Add New Meeting';
          meetingForm.querySelector('button[type="submit"]').textContent = 'Save Meeting';
        });
        document.getElementById('meetingId').value = generateUniqueId(); // Initial ID
      }

      if (actionForm) {
        actionForm.addEventListener('reset', () => {
          document.getElementById('action-meetingId').value = ''; // Action ID should be linked to Meeting ID
          actionModeDiv.textContent = 'Mode: Add New Action Item';
          actionForm.querySelector('button[type="submit"]').textContent = 'Add Action Item';
        });
      }


      // Function to post data to Google Apps Script
      function postData(formData, action, successMessage, formElement, isEditMode = false) {
        showLoading();
        let sheetName;
        // Determine sheetName based on action
        if (action.includes('meeting')) {
          sheetName = 'Meetings';
        } else if (action.includes('action')) {
          sheetName = 'Action Items'; // Corrected sheetName
        } else if (action.includes('media')) {
          sheetName = 'Media';
        } else if (action.includes('presentation')) {
          sheetName = 'Presentations';
        }

        // Append sheetName to formData for POST requests
        formData.append('sheetName', sheetName);

        console.log(`Posting data for action: ${action} to URL: ${scriptURL}`);
        // Log formData content for debugging POST requests
        for (let pair of formData.entries()) {
          console.log(pair[0] + ': ' + pair[1]);
        }

        fetch(scriptURL + `?action=${action}`, {
          method: 'POST',
          body: formData
        })
          .then(response => response.json())
          .then(data => {
            if (data.result === 'success') {
              showMessage(successMessage, false);
              formElement.reset(); // Clear form on success
              if (action.includes('meeting')) {
                fetchData(); // Refresh meeting/action tables
                document.getElementById('meetingId').value = generateUniqueId(); // Generate new ID for next entry
              } else if (action.includes('action')) {
                fetchData(); // Refresh meeting/action tables
              }
              else if (action.includes('media')) {
                fetchMediaGallery(); // Refresh media gallery
              } else if (action.includes('presentation')) {
                fetchPresentations(); // Refresh presentations
              }
            } else {
              throw new Error(data.error || 'Unknown error occurred.');
            }
          })
          .catch(error => {
            console.error('Error:', error);
            showMessage('Error: ' + error.message, false);
          })
          .finally(() => {
            hideLoading();
            // Reset form mode if it was an edit operation
            if (isEditMode) {
              if (action.includes('meeting')) {
                meetingModeDiv.textContent = 'Mode: Add New Meeting';
                formElement.querySelector('button[type="submit"]').textContent = 'Save Meeting';
              } else if (action.includes('action')) {
                actionModeDiv.textContent = 'Mode: Add New Action Item';
                formElement.querySelector('button[type="submit"]').textContent = 'Add Action Item';
              }
            }
          });
      }

      // Meeting Form Submission
      meetingForm?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        const rowToEdit = this.row.value;
        if (rowToEdit) {
          // Editing existing meeting
          formData.append('row', rowToEdit);
          postData(formData, 'edit_meeting', 'Meeting updated successfully!', this, true);
        } else {
          // Adding new meeting
          postData(formData, 'add_meeting', 'Meeting added successfully!', this);
        }
      });

      // Action Form Submission
      actionForm?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        const rowToEdit = this.row.value;
        if (rowToEdit) {
          // Editing existing action
          formData.append('row', rowToEdit);
          postData(formData, 'edit_action', 'Action item updated successfully!', this, true);
        } else {
          // Adding new action
          postData(formData, 'add_action', 'Action item added successfully!', this);
        }
      });

      // Media Upload Form Submission
      document.getElementById('media-upload-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        // Special handling for file uploads: Google Apps Script needs the file directly, not a URL
        // The script URL is designed to handle file uploads when method is POST and enctype is multipart/form-data
        postData(formData, 'add_media', 'Media uploaded successfully!', this);
      });

      // Presentation Upload Form Submission
      document.getElementById('presentation-upload-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        postData(formData, 'add_presentation', 'Presentation added successfully!', this);
      });

      // --- Edit Functions ---
      function editMeeting(rowNum, trElement) {
        if (!isAdminLoggedIn) {
          showMessage("Admin login required to edit entries.", false);
          return;
        }
        showMessage('Editing meeting at row ' + rowNum, false);
        meetingModeDiv.textContent = 'Mode: Edit Existing Meeting';
        meetingForm.querySelector('button[type="submit"]').textContent = 'Update Meeting';
        meetingForm.row.value = rowNum;

        const cells = trElement.querySelectorAll('td');
        const headers = Array.from(document.querySelector('#meeting-table thead tr').children).map(th => th.textContent.trim());

        // Map cells to form fields, skipping the 'Photo URL' if it exists in the data.
        // Assuming the order of fields in the form matches the order of data columns,
        // excluding 'Photo URL'.
        const photoUrlHeader = 'Photo URL';
        const originalHeadersFromTable = Array.from(document.querySelector('#meeting-table thead tr').children)
          .map(th => th.textContent.trim());
        const originalDataCells = Array.from(trElement.children); // Get all TD elements

        let currentCellIndex = 0;

        const mapFormAndCells = [
          { formFieldId: 'meetingId', headerName: 'Meeting ID' },
          { formFieldId: 'meetingDate', headerName: 'Meeting Date' },
          { formFieldId: 'zoneM', headerName: 'Zone' },
          { formFieldId: 'districtM', headerName: 'District' },
          { formFieldId: 'coldRoomM', headerName: 'Cold Room Location (Optional)' },
          { formFieldId: 'meetingTitle', headerName: 'Meeting Title' },
          { formFieldId: 'conductedByM', headerName: 'Conducted By' },
          { formFieldId: 'attendeesM', headerName: 'Attendees' },
          { formFieldId: 'meetingAgendaM', headerName: 'Meeting Agenda' },
          { formFieldId: 'meetingDiscussionM', headerName: 'Meeting Discussion' },
          // Note: 'Photo URL' is not in this map as it's excluded from the form.
        ];

        mapFormAndCells.forEach(mapping => {
          const headerIndexInOriginal = originalHeadersFromTable.indexOf(mapping.headerName);
          if (headerIndexInOriginal > -1) {
            // If the header exists in the *original* data structure, use its index to get the cell value
            const cellValue = originalDataCells[headerIndexInOriginal]?.textContent || '';
            const formField = document.getElementById(mapping.formFieldId);
            if (formField) {
              formField.value = cellValue;
            }
          }
        });

        // Scroll to the form
        meetingForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      function editAction(rowNum, trElement) {
        if (!isAdminLoggedIn) {
          showMessage("Admin login required to edit entries.", false);
          return;
        }
        showMessage('Editing action at row ' + rowNum, false);
        actionModeDiv.textContent = 'Mode: Edit Existing Action Item';
        actionForm.querySelector('button[type="submit"]').textContent = 'Update Action Item';
        actionForm.row.value = rowNum;

        const cells = trElement.querySelectorAll('td');
        const headers = Array.from(document.querySelector('#action-table thead tr').children).map(th => th.textContent.trim());

        const meetingIdIndex = headers.indexOf('Meeting ID');
        const actionItemIndex = headers.indexOf('Action Item');
        const assignedToIndex = headers.indexOf('Assigned To');
        const deadlineIndex = headers.indexOf('Deadline');
        const statusIndex = headers.indexOf('Status');

        document.getElementById('action-meetingId').value = cells[meetingIdIndex]?.textContent || '';
        document.getElementById('actionItemA').value = cells[actionItemIndex]?.textContent || '';
        document.getElementById('assignedToA').value = cells[assignedToIndex]?.textContent || '';
        document.getElementById('deadlineA').value = cells[deadlineIndex]?.textContent || '';
        document.getElementById('statusA').value = cells[statusIndex]?.textContent || '';

        // Scroll to the form
        actionForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      // --- Delete Functions ---
      function deleteEntry(rowNum, actionType, confirmMessage, successMessage) {
        if (!isAdminLoggedIn) {
          showMessage("Admin login required to delete entries.", false);
          return;
        }
        showMessage(confirmMessage, true, () => {
          showLoading();
          const formData = new FormData();
          formData.append('row', rowNum);

          let sheetName;
          // Determine sheetName based on action
          if (actionType.includes('meeting')) {
            sheetName = 'Meetings';
          } else if (actionType.includes('action')) {
            sheetName = 'Action Items'; // Corrected sheetName
          } else if (actionType.includes('media')) {
            sheetName = 'Media';
          } else if (actionType.includes('presentation')) {
            sheetName = 'Presentations';
          }
          formData.append('sheetName', sheetName); // Add sheetName for delete operations

          console.log(`Deleting entry for action: ${actionType} to URL: ${scriptURL}`);
          // Log formData content for debugging DELETE requests
          for (let pair of formData.entries()) {
            console.log(pair[0] + ': ' + pair[1]);
          }

          fetch(scriptURL + `?action=${actionType}`, {
            method: 'POST',
            body: formData
          })
            .then(response => response.json())
            .then(data => {
              if (data.result === 'success') {
                showMessage(successMessage, false);
                if (actionType.includes('meeting') || actionType.includes('action')) {
                  fetchData(); // Refresh meeting/action tables
                } else if (actionType.includes('media')) {
                  fetchMediaGallery(); // Refresh media gallery
                } else if (actionType.includes('presentation')) {
                  fetchPresentations(); // Refresh presentations
                }
              } else {
                throw new Error(data.error || 'Unknown error occurred.');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              showMessage('Error: ' + error.message, false);
            })
            .finally(() => hideLoading());
        });
      }

      function deleteMeeting(rowNum) {
        deleteEntry(rowNum, 'delete_meeting', 'Are you sure you want to delete this meeting entry?', 'Meeting deleted successfully!');
      }

      function deleteAction(rowNum) {
        deleteEntry(rowNum, 'delete_action', 'Are you sure you want to delete this action item?', 'Action item deleted successfully!');
      }

      function deleteMedia(uniqueID) {
        deleteEntry(uniqueID, 'delete_media', 'Are you sure you want to delete this media file?', 'Media file deleted successfully!');
      }

      function deletePresentation(uniqueID) {
        deleteEntry(uniqueID, 'delete_presentation', 'Are you sure you want to delete this presentation?', 'Presentation deleted successfully!');
      }


      // --- Populate Week Select Options for Media and Presentations ---
      function populateWeekSelects() {
        const weekSelectMedia = document.getElementById('weekInfoMedia');
        const weekSelectPresentation = document.getElementById('presentationWeekInfo');
        const currentYear = new Date().getFullYear();
        const weeks = [];

        // Generate weeks from Week 1 to Week 53 for the current year
        for (let i = 1; i <= 53; i++) {
          weeks.push(`Week ${i} (${currentYear})`);
        }

        // Add a few historical/future week examples if needed, or refine based on actual project weeks
        // For example:
        // weeks.push("Week 19 (May 05 - May 11)");
        // weeks.push("Week 53 (Dec 29 - Dec 31)");

        const createOption = (value) => {
          const option = document.createElement('option');
          option.value = option.textContent = value;
          return option;
        };

        if (weekSelectMedia) {
          weekSelectMedia.innerHTML = '<option value="">Select Week</option>'; // Reset
          weeks.forEach(week => weekSelectMedia.appendChild(createOption(week)));
        }
        if (weekSelectPresentation) {
          weekSelectPresentation.innerHTML = '<option value="">Select Week</option>'; // Reset
          weeks.forEach(week => weekSelectPresentation.appendChild(createOption(week)));
        }
      }


      // Initial setup on window load
      window.onload = function () {
        const trackerContentArea = document.getElementById('tracker-content-area');
        const infographicContentArea = document.getElementById('infographic-content-area');

        // Initially hide both content areas
        if (trackerContentArea) trackerContentArea.style.display = 'none';
        if (infographicContentArea) infographicContentArea.style.display = 'none';

        const allTrackerSectionDivIds = ['meetings-section', 'media-section', 'presentations-section', 'admin-section'];
        allTrackerSectionDivIds.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.style.display = 'none';
          }
        });

        fetchData(); // Fetch data in the background
        // No section is shown by default
      };
    </script>
</body>

</html>
