<!DOCTYPE html>
<html>

<head>
  <title>BCIEP Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    /* Base body styles for the tracker page */
    body.tracker-active {
      font-family: 'Segoe UI', sans-serif;
      margin: 0 auto;
      padding: 0;
      max-width: 1300px;
      background: #f9f9f9;
    }

    body.tracker-active #app-container {
      max-width: 1300px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Styles for Infographic Page */
    body.infographic-active {
      font-family: 'Open Sans', sans-serif;
      background-color: #E8F5E9;
      color: #333333;
      margin: 0;
      padding: 0;
      max-width: none;
    }

    body.infographic-active #app-container {
      max-width: none;
      margin: 0;
      padding: 0;
    }

    /* General h2 for tracker sections */
    h2 {
      text-align: center;
      margin-top: 40px;
      background-color: #1B5E20;
      color: #fff;
      padding: 10px;
      border-radius: 5px;
    }

    .form-container {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: space-between;
    }

    form {
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      flex: 1;
      min-width: 300px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    @media (min-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    .full-width {
      grid-column: 1 / -1;
    }

    label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
      background: white;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-radius: 6px;
      overflow: hidden;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
      text-align: left;
    }

    th {
      background-color: #e0e0e0;
      font-weight: bold;
    }

    tbody tr:nth-child(odd) {
      background-color: #f9f9f9;
    }

    tbody tr:hover {
      background-color: #f1f1f1;
    }

    .error-message {
      color: red;
      font-weight: bold;
    }

    .success-message {
      color: green;
      font-weight: bold;
      padding: 10px;
      background-color: #e6ffe6;
      border: 1px solid #b3ffb3;
      border-radius: 4px;
      margin-bottom: 15px;
      text-align: center;
    }

    .presentation-upload-form-container,
    #repository-upload-form-container {
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .presentation-week-group,
    .media-week-group,
    .repository-title-group {
      margin-bottom: 30px;
      border: 1px solid #ddd;
      padding: 20px 0;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .presentation-week-group h3,
    .media-week-group h3,
    .repository-title-group h3 {
      text-align: left;
      background: #2F855A;
      color: #fff;
      padding: 10px 15px;
      border-radius: 5px 5px 0 0;
      margin: -20px 0 20px -0;
      font-size: 1.3em;
    }

    .presentation-week-group h4,
    .media-week-group h4 {
      margin-top: 15px;
      margin-bottom: 10px;
      color: #333;
      font-size: 1.1em;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
      padding-left: 15px;
      padding-right: 15px;
    }

    .repository-files-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1.5rem;
    }

    .repository-file-item {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
      transition: box-shadow 0.2s;
    }

    .repository-file-item:hover {
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .repository-file-item a {
      text-decoration: none;
      color: #333;
    }

    .repository-file-item .file-icon {
      font-size: 4rem;
      margin-bottom: 0.5rem;
    }

    .repository-file-item .file-name {
      font-size: 0.875rem;
      word-break: break-all;
      font-weight: 500;
    }

    .presentation-item {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px dashed #eee;
      padding-left: 15px;
      padding-right: 15px;
    }

    .presentation-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .presentation-container {
      position: relative;
      width: 100%;
      max-width: 100%;
      padding-top: 56.25%;
      height: 0;
      overflow: hidden;
      margin: 10px 0;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .presentation-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .delete-button {
      background-color: #d9534f;
      color: white;
      padding: 6px 12px;
      font-size: 0.9em;
      border-radius: 4px;
      cursor: pointer;
      border: none;
      margin-top: 10px;
      display: inline-block;
    }

    .delete-button:hover {
      background-color: #c9302c;
    }

    .custom-message-box-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .custom-message-box-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .custom-message-box {
      background-color: white;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      width: 90%;
      max-width: 400px;
      text-align: center;
    }

    .custom-message-box p {
      margin-bottom: 20px;
      font-size: 16px;
      color: #333;
    }

    .custom-message-box-buttons button {
      padding: 10px 20px;
      margin: 0 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      min-width: 80px;
    }

    .custom-message-box-buttons .confirm-button {
      background-color: #1B5E20;
      color: white;
      border: none;
    }

    .custom-message-box-buttons .confirm-button:hover {
      background-color: #14532d;
    }

    .custom-message-box-buttons .cancel-button {
      background-color: #f0f0f0;
      color: #333;
      border: 1px solid #ccc;
    }

    .custom-message-box-buttons .cancel-button:hover {
      background-color: #e0e0e0;
    }

    .loading-indicator {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
      z-index: 1001;
      text-align: center;
    }

    .loading-indicator p {
      margin: 0;
      font-size: 16px;
      color: #003366;
    }

    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1B5E20;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px auto;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .admin-only {
      display: none;
    }

    body.infographic-active .chart-container {
      position: relative;
      width: 100%;
      max-width: 450px;
      margin-left: auto;
      margin-right: auto;
      height: 280px;
      max-height: 350px;
    }

    @media (min-width: 768px) {
      body.infographic-active .chart-container {
        height: 320px;
      }
    }

    body.infographic-active .stat-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid #D1FAE5;
    }

    body.infographic-active .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    body.infographic-active .section-title {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 1.5rem;
    }

    body.infographic-active .big-number {
      font-size: 3.5rem;
      font-weight: 700;
      color: #4CAF50;
      line-height: 1;
    }

    body.infographic-active .icon-list-item {
      display: flex;
      align-items: center;
      margin-bottom: 0.75rem;
      background-color: #F0FDF0;
      padding: 1rem;
      border-radius: 0.375rem;
      border-left: 4px solid #FFC107;
    }

    body.infographic-active .icon-list-item .icon {
      font-size: 1.75rem;
      margin-right: 1rem;
      color: #1B5E20;
    }

    body.infographic-active .timeline-item {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #4CAF50;
    }

    body.infographic-active .timeline-item h4 {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .timeline-item ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .timeline-item ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      line-height: 1.6;
    }

    body.infographic-active .timeline-item ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #FFC107;
      font-weight: bold;
    }

    body.infographic-active .ownership-bar-container {
      display: flex;
      width: 100%;
      height: 40px;
      border-radius: 0.5rem;
      overflow: hidden;
      margin-top: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    body.infographic-active .ownership-bar-rmc {
      background-color: #1B5E20;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }

    body.infographic-active .ownership-bar-community {
      background-color: #4CAF50;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.9rem;
    }

    body.infographic-active .org-chart-node {
      background-color: #F0FDF0;
      border-radius: 0.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      padding: 1rem;
      text-align: center;
      margin: 0.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      color: #1B5E20;
      border: 1px solid #4CAF50;
    }

    body.infographic-active .org-chart-level {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    body.infographic-active .org-chart-arrow {
      text-align: center;
      font-size: 1.5rem;
      color: #4CAF50;
      margin: 0.5rem 0;
    }

    body.infographic-active .org-chart-line {
      height: 20px;
      width: 2px;
      background-color: #4CAF50;
      margin: 0 auto;
    }

    body.infographic-active .org-chart-horizontal-line {
      height: 2px;
      background-color: #4CAF50;
      width: 100%;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    body.infographic-active .org-chart-connector {
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    body.infographic-active .org-chart-connector::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 10px;
      background-color: #4CAF50;
    }

    body.infographic-active .org-chart-connector::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 10px;
      background-color: #4CAF50;
    }

    body.infographic-active .org-chart-flex {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      width: 100%;
    }

    body.infographic-active .org-chart-flex>div {
      flex: 1 1 30%;
      max-width: 30%;
      box-sizing: border-box;
    }

    @media (max-width: 767px) {
      body.infographic-active .org-chart-flex>div {
        flex: 1 1 100%;
        max-width: 100%;
      }
    }

    body.infographic-active .stakeholder-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #1B5E20;
    }

    body.infographic-active .stakeholder-card h4 {
      color: #4CAF50;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .stakeholder-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .stakeholder-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .stakeholder-card ul li::before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #FFC107;
      font-weight: bold;
    }

    body.infographic-active .component-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #FFC107;
    }

    body.infographic-active .component-card h4 {
      color: #1B5E20;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .component-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .component-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .component-card ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #4CAF50;
      font-weight: bold;
    }

    body.infographic-active .risk-card {
      background-color: #FFFFFF;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 6px solid #1B5E20;
    }

    body.infographic-active .risk-card h4 {
      color: #4CAF50;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }

    body.infographic-active .risk-card h5 {
      color: #FFC107;
      font-weight: 600;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-size: 1.05rem;
    }

    body.infographic-active .risk-card ul {
      list-style: none;
      padding-left: 0;
    }

    body.infographic-active .risk-card ul li {
      position: relative;
      padding-left: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333333;
      font-size: 0.95rem;
    }

    body.infographic-active .risk-card ul li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: #81C784;
      font-weight: bold;
    }

    body.infographic-active .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    body.infographic-active .data-table {
      width: 100%;
      border-collapse: collapse;
      background-color: #FFFFFF;
      font-size: 0.9rem;
      min-width: 800px;
    }

    body.infographic-active .data-table th,
    body.infographic-active .data-table td {
      padding: 0.75rem 1rem;
      border: 1px solid #E0E0E0;
      text-align: left;
    }

    body.infographic-active .data-table th {
      background-color: #1B5E20;
      color: white;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    body.infographic-active .data-table tbody tr:nth-child(odd) {
      background-color: #F0FDF0;
    }

    body.infographic-active .data-table tbody tr:hover {
      background-color: #DCF0DD;
    }

    .infographic-container {
      padding: 1rem;
      max-width: 1300px;
      margin: 0 auto;
      padding: 0 20px;
    }

    @media (min-width: 768px) {
      .infographic-container {
        padding: 2rem;
      }
    }

    @media (min-width: 1024px) {
      .infographic-container {
        padding: 2.5rem;
      }
    }

    /* --- Progress Page Specific Styles --- */
    #progress-section {
      font-family: 'Inter', sans-serif;
    }

    #progress-section .table-container {
      max-width: 100%;
      max-height: calc(100vh - 250px);
      overflow: auto;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      background-color: #f9fafb;
    }

    #progress-section table {
      border-collapse: separate;
      border-spacing: 0;
      table-layout: fixed;
      width: auto;
      margin-top: 0;
    }

    #progress-section th,
    #progress-section td {
      border-bottom: 1px solid #e5e7eb;
      border-right: 1px solid #e5e7eb;
      padding: 10px;
      text-align: center;
      font-size: 12px;
      white-space: normal;
      word-wrap: break-word;
      vertical-align: middle;
      width: 180px;
      min-width: 180px;
    }

    #progress-section th {
      font-weight: 600;
      color: #1f2937;
    }

    #progress-section tbody td {
      transition: background-color 0.3s;
    }

    #progress-section tbody tr:hover td {
      background-color: #f3f4f6;
    }

    /* --- Sticky Positioning Rules --- */
    #progress-section thead th {
      position: sticky;
      background-color: #f3f4f6;
      z-index: 30;
      /* Headers on top */
    }

    #progress-section thead tr:nth-child(1) th {
      top: 0;
      height: 40px;
    }

    #progress-section thead tr:nth-child(2) th {
      top: 40px;
      height: 40px;
    }

    #progress-section thead tr:nth-child(3) th {
      top: 80px;
      height: 100px;
    }

    #progress-section thead tr:nth-child(4) th {
      top: 180px;
      z-index: 25;
    }

    /* Freeze % Complete Row */

    /* Frozen Columns */
    #progress-section th:nth-child(1),
    #progress-section td:nth-child(1) {
      position: sticky;
      left: 0;
      z-index: 31;
      background-color: #f9fafb !important;
      width: 200px;
      min-width: 200px;
      text-align: left;
    }

    #progress-section th:nth-child(2),
    #progress-section td:nth-child(2) {
      position: sticky;
      left: 200px;
      z-index: 31;
      background-color: #f9fafb !important;
      width: 150px;
      min-width: 150px;
      text-align: left;
    }

    #progress-section th:nth-child(3),
    #progress-section td:nth-child(3) {
      position: sticky;
      left: 350px;
      z-index: 31;
      background-color: #f9fafb !important;
      width: 150px;
      min-width: 150px;
      text-align: left;
    }

    /* Freeze Top-Left Corner Cells */
    #progress-section thead th:nth-child(1),
    #progress-section thead th:nth-child(2),
    #progress-section thead th:nth-child(3) {
      z-index: 40;
      /* Highest z-index */
    }

    /* --- Dropdown and Status Colors --- */
    #progress-section select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      border: none;
      background-color: transparent;
      width: 100%;
      height: 100%;
      padding: 8px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      border-radius: 4px;
    }

    #progress-section .status-complete {
      background-color: #dcfce7 !important;
    }

    #progress-section .status-in-progress {
      background-color: #fef9c3 !important;
    }

    #progress-section .status-not-started {
      background-color: #fee2e2 !important;
    }

    #progress-section .status-complete select {
      color: #166534;
    }

    #progress-section .status-in-progress select {
      color: #854d0e;
    }

    #progress-section .status-not-started select {
      color: #991b1b;
    }

    #progress-section .percent-complete-cell {
      font-weight: bold;
      font-size: 14px;
      color: #1B5E20;
      background-color: #e0e7ff !important;
    }

    /* Header & Filter Styles */
    #progress-section .workstream-header {
      background-color: #1B5E20;
      color: white;
    }

    #progress-section .sub-workstream-header {
      background-color: #2e7d32;
      color: white;
    }

    #filter-controls {
      padding: 1rem 1.5rem;
      background-color: #fff;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #filter-controls label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      transition: all 0.2s;
    }

    #filter-controls input:checked+span {
      font-weight: 600;
    }

    #filter-controls label:has(input:checked) {
      background-color: #1B5E20;
      color: white;
    }

    #filter-controls input {
      display: none;
    }

    /* 2. Freeze the Location, City, and District Columns */
    #progress-section th:nth-child(1),
    #progress-section td:nth-child(1) {
      position: sticky;
      left: 0;
      z-index: 30;
      background-color: #f9fafb !important;
      width: 200px;
      min-width: 200px;
      text-align: left;
    }

    #progress-section th:nth-child(2),
    #progress-section td:nth-child(2) {
      position: sticky;
      left: 200px;
      z-index: 30;
      background-color: #f9fafb !important;
      width: 150px;
      min-width: 150px;
      text-align: left;
    }

    #progress-section th:nth-child(3),
    #progress-section td:nth-child(3) {
      position: sticky;
      left: 350px;
      z-index: 30;
      background-color: #f9fafb !important;
      width: 150px;
      min-width: 150px;
      text-align: left;
    }

    /* 3. Freeze the Top-Left Corner Header Cells */
    #progress-section thead th:nth-child(1),
    #progress-section thead th:nth-child(2),
    #progress-section thead th:nth-child(3) {
      z-index: 40;
      /* Highest z-index for the corner */
    }

    /* 4. Freeze the "% Complete" Row */
    #progress-section #percentage-row td {
      position: sticky;
      top: 180px;
      /* Sum of the 3 header rows' heights and top positions */
      background-color: #e0e7ff !important;
      z-index: 25;
    }

    #progress-section #percentage-row td:nth-child(1) {
      left: 0;
      z-index: 35;
    }

    #progress-section #percentage-row td:nth-child(2) {
      left: 200px;
      z-index: 35;
    }

    #progress-section #percentage-row td:nth-child(3) {
      left: 350px;
      z-index: 35;
    }


    /* --- Dropdown and Status Colors --- */
    #progress-section select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      border: none;
      background-color: transparent;
      width: 100%;
      height: 100%;
      padding: 8px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      border-radius: 4px;
    }

    #progress-section .status-complete {
      background-color: #dcfce7 !important;
    }

    #progress-section .status-in-progress {
      background-color: #fef9c3 !important;
    }

    #progress-section .status-not-started {
      background-color: #fee2e2 !important;
    }

    #progress-section .status-complete select {
      color: #166534;
    }

    #progress-section .status-in-progress select {
      color: #854d0e;
    }

    #progress-section .status-not-started select {
      color: #991b1b;
    }

    #progress-section .percent-complete-cell {
      font-weight: bold;
      font-size: 14px;
      color: #1B5E20;
    }

    /* --- Header & Filter Styles --- */
    #progress-section .workstream-header {
      background-color: #1B5E20;
      color: white;
    }

    #progress-section .sub-workstream-header {
      background-color: #2e7d32;
      color: white;
    }

    #filter-controls {
      padding: 1rem 1.5rem;
      background-color: #fff;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #filter-controls label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      transition: all 0.2s;
    }

    #filter-controls input:checked+span {
      font-weight: 600;
    }

    #filter-controls label:has(input:checked) {
      background-color: #1B5E20;
      color: white;
    }

    #filter-controls input {
      display: none;
    }

    /* --- Column Visibility --- */
    .ws-op-excellence,
    .ws-revenue-div,
    .ws-farmer-vendor,
    .ws-mentorship-skill,
    .ws-gov-stakeholder {
      display: none;
    }

    .visible-cell {
      display: table-cell !important;
    }

    #percentage-row {
      display: none;
    }

    #percentage-row.visible-row {
      display: table-row !important;
    }

    /* Freeze the first column (Location) */
    #progress-table th.location-col,
    #progress-table td.location-col {
      position: sticky;
      left: 0;
      background: #fff;
      z-index: 2;
    }

    #progress-table {
      position: relative;
    }

    #progress-table th:first-child,
    #progress-table td:first-child {
      position: sticky;
      left: 0;
      z-index: 10;
      background-color: white;
      /* Add shadow for visual separation */
      box-shadow: 2px 0 4px -2px rgba(0, 0, 0, 0.15);
    }

    #progress-table th:first-child {
      background-color: #f3f4f6;
      /* Match your header background */
      z-index: 11;
      /* Higher than td to stay on top */
    }

    /* --- Dropdown and Status Colors --- */
    #progress-section select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      border: none;
      background-color: transparent;
      width: 100%;
      height: 100%;
      padding: 8px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      border-radius: 4px;
    }

    #progress-section .status-complete {
      background-color: #dcfce7 !important;
    }

    #progress-section .status-in-progress {
      background-color: #fef9c3 !important;
    }

    #progress-section .status-not-started {
      background-color: #fee2e2 !important;
    }

    #progress-section .status-complete select {
      color: #166534;
    }

    #progress-section .status-in-progress select {
      color: #854d0e;
    }

    #progress-section .status-not-started select {
      color: #991b1b;
    }

    #progress-section .percent-complete-cell {
      font-weight: bold;
      font-size: 14px;
      color: #1B5E20;
      background-color: #e0e7ff !important;
    }

    /* Header background colors */
    #progress-section .workstream-header {
      background-color: #1B5E20;
      color: white;
    }

    #progress-section .sub-workstream-header {
      background-color: #2e7d32;
      color: white;
    }

    /* --- Filter Controls --- */
    #filter-controls {
      padding: 1rem 1.5rem;
      background-color: #fff;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #filter-controls label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      transition: all 0.2s;
    }

    #filter-controls input:checked+span {
      font-weight: 600;
    }

    #filter-controls label:has(input:checked) {
      background-color: #1B5E20;
      color: white;
    }

    #filter-controls input {
      display: none;
    }

    /* Dropdown and color styles */
    #progress-section select {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      border: none;
      background-color: transparent;
      width: 100%;
      height: 100%;
      padding: 8px;
      font-weight: bold;
      text-align: center;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.2s ease-in-out;
    }

    #progress-section .status-complete {
      background-color: #dcfce7 !important;
      color: #166534;
    }

    #progress-section .status-in-progress {
      background-color: #fef9c3 !important;
      color: #854d0e;
    }

    #progress-section .status-not-started {
      background-color: #fee2e2 !important;
      color: #991b1b;
    }

    #progress-section .status-complete select,
    #progress-section .status-in-progress select,
    #progress-section .status-not-started select {
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    #progress-section .percent-complete-cell {
      font-weight: bold;
      font-size: 14px;
      color: #1B5E20;
      background-color: #e0e7ff !important;
    }

    /* Header background colors */
    #progress-section .workstream-header {
      background-color: #1B5E20;
      color: white;
    }

    #progress-section .sub-workstream-header {
      background-color: #2e7d32;
      color: white;
    }

    /* Filter controls */
    #filter-controls {
      padding: 1rem 1.5rem;
      background-color: #fff;
      border-bottom: 1px solid #e2e8f0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: center;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #filter-controls label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      padding: 0.5rem 1rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      transition: all 0.2s;
    }

    #filter-controls input:checked+span {
      font-weight: 600;
    }

    #filter-controls label:has(input:checked) {
      background-color: #1B5E20;
      color: white;
    }

    #filter-controls input {
      display: none;
    }

    .hidden-col {
      display: none;
    }

    #percentage-row.hidden-row {
      display: none;
    }
  </style>
</head>

<body>
  <div id="app-container">
    <div class="navigation-buttons sticky top-0 z-50 bg-green-50 shadow-md p-3 flex flex-wrap justify-center gap-2">
      <button onclick="showHomePage()"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Home</button>
      <button onclick="showSection('plan-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Plan</button>
      <button onclick="showSection('meetings-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Meetings</button>
      <button onclick="showSection('media-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Gallery</button>
      <button onclick="showSection('presentations-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Reports</button>
      <button onclick="showSection('progress-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Progress</button>
      <button onclick="showSection('repository-section')"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Repository</button>
      <button id="admin-nav-button" onclick="handleAdminNavClick()"
        class="w-32 px-4 py-2 text-sm font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition-colors">Admin</button>
    </div>

    <div id="main-content-wrapper">
      <div id="tracker-content-area" style="display:none;">
        <div id="meetings-section" style="display: none;">
          <h2>Bloomberg Cities Idea Exchange || India || Meeting & Action Tracker</h2>
          <div class="form-container">
            <form id="meeting-form" style="margin-top: 0; border: 2px solid #ccc;">
              <h3 style="margin-top: 0px;">Meeting Agenda and Discussions</h3>
              <div id="meeting-mode"
                style="margin: 10px 0; margin-bottom: 15px; padding: 5px; border: 2px solid #aaa; border-radius: 4px; background-color: #f5f5f5; font-weight: bold; color: #d9534f;">
                Mode: Add New Meeting</div>
              <input type="hidden" name="row">
              <div class="form-grid">
                <div><label for="meetingId">Meeting ID:</label><input type="text" name="meetingId" id="meetingId"
                    readonly></div>
                <div><label for="meetingDate">Meeting Date:</label><input type="date" name="meetingDate"
                    id="meetingDate" required></div>
                <div><label for="zoneM">Zone:</label><select name="zone" id="zoneM" required>
                    <option value="">Select Zone</option>
                    <option>Zone 1</option>
                    <option>Zone 2</option>
                    <option>Zone 3</option>
                  </select></div>
                <div><label for="districtM">District:</label><select name="district" id="districtM" required>
                    <option value="">Select District</option>
                    <option>Balangir</option>
                    <option>Bargarh</option>
                    <option>Cuttack</option>
                    <option>Ganjam</option>
                    <option>Kendujhar</option>
                    <option>Koraput</option>
                    <option>Mayurbhanj</option>
                    <option>Sambalpur</option>
                    <option>Sundargarh</option>
                  </select></div>
                <div><label for="coldRoomM">Cold Room Location (Optional):</label><select id="coldRoomM"
                    name="coldRoom">
                    <option value="">None</option>
                    <option>Desil</option>
                    <option>RMC Behera Market</option>
                    <option>RMC Sarandapali</option>
                    <option>Athagarh NAC</option>
                    <option>Nistipur</option>
                    <option>Dudhianali</option>
                    <option>RMC Kalabada Market Yard</option>
                    <option>RMC Digapahandi Market Yard</option>
                    <option>RMC Bhanjanagar Market Yard</option>
                    <option>Bahadapada</option>
                    <option>RMC Buguda Market Yard</option>
                    <option>Chatrapur Market</option>
                    <option>Kolasingi</option>
                    <option>Raisuan</option>
                    <option>Madarangajodi</option>
                    <option>Mukuna</option>
                    <option>Tikarapada</option>
                    <option>Nuagaon (Narsinghpur)</option>
                    <option>Baradapala</option>
                    <option>Ratanpur</option>
                    <option>Tulasichaura</option>
                    <option>Kathakaranjia</option>
                    <option>Ghatabhagra</option>
                    <option>Malimarla</option>
                    <option>Baghiatangar</option>
                    <option>Chapaldihi</option>
                    <option>Akhapolan</option>
                    <option>Sandhenkia</option>
                    <option>Tikhia</option>
                    <option>Kuchinda</option>
                    <option>Bhojpur</option>
                    <option>T.Niktimal</option>
                    <option>Charmal</option>
                    <option>Khetrajpur</option>
                    <option>Kardega</option>
                    <option>Kadalidhipa</option>
                    <option>Khariapada</option>
                    <option>Bhelluadihi</option>
                    <option>Domposh</option>
                    <option>Rajpur</option>
                    <option>Kansar</option>
                  </select></div>
                <div class="full-width"><label for="meetingTitle">Meeting Title:</label><input type="text"
                    id="meetingTitle" name="meetingTitle" required></div>
                <div><label for="conductedByM">Conducted By:</label><select name="conductedBy" id="conductedByM"
                    required>
                    <option>Akshaya Kumar Pallai</option>
                    <option>Vicky Vikram Das</option>
                    <option>Krushna Chandra Parida</option>
                    <option>Mary Helena Kujur</option>
                    <option>Hemanti Sabar</option>
                    <option>Amlan Abhinav</option>
                    <option>Asutosh Nayak</option>
                    <option>Pratham Parida</option>
                    <option>Rashmi Prava Nayak</option>
                    <option>Minati Mallick</option>
                    <option>Sunita Patra</option>
                    <option>Deepak Kumar Tudu</option>
                    <option>Swati Rani Achary</option>
                  </select></div>
                <div><label for="attendeesM">Attendees:</label><textarea name="attendees" id="attendeesM"
                    required></textarea></div>
                <div class="full-width"><label for="meetingAgendaM">Meeting Agenda:</label><textarea
                    name="meetingAgenda" id="meetingAgendaM" required></textarea></div>
                <div class="full-width"><label for="meetingDiscussionM">What points were discussed during the
                    meeting?</label><textarea name="meetingDiscussion" id="meetingDiscussionM"></textarea></div>
              </div>
              <button type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Save
                Meeting</button>
            </form>
            <form id="action-form" style="margin-top: 0; border: 2px solid #ccc;">
              <h3 style="margin-top: 0px;">Meeting Action Items</h3>
              <div id="action-mode"
                style="margin: 10px 0; margin-bottom: 15px; padding: 5px; border: 2px solid #aaa; border-radius: 4px; background-color: #f5f5f5; font-weight: bold; color: #d9534f;">
                Mode: Add New Action Item</div>
              <input type="hidden" name="row">
              <div class="form-grid">
                <div><label for="action-meetingId">Meeting ID:</label><input type="text" name="meetingId"
                    id="action-meetingId" readonly required></div>
                <div class="full-width"><label for="actionItemA">Action Item:</label><input type="text"
                    name="actionItem" id="actionItemA" required></div>
                <div><label for="assignedToA">Assigned To:</label><select name="assignedTo" id="assignedToA" required>
                    <option>Akshaya Kumar Pallai</option>
                    <option>Vicky Vikram Das</option>
                    <option>Krushna Chandra Parida</option>
                    <option>Mary Helena Kujur</option>
                    <option>Hemanti Sabar</option>
                    <option>Amlan Abhinav</option>
                    <option>Asutosh Nayak</option>
                    <option>Pratham Parida</option>
                    <option>Rashmi Prava Nayak</option>
                    <option>Minati Mallick</option>
                    <option>Sunita Patra</option>
                    <option>Deepak Kumar Tudu</option>
                    <option>Swati Rani Achary</option>
                  </select></div>
                <div><label for="deadlineA">Deadline:</label><input type="date" name="deadline" id="deadlineA" required>
                </div>
                <div class="full-width"><label for="statusA">Status:</label><select name="status" id="statusA" required>
                    <option value="">Select Status</option>
                    <option>Pending</option>
                    <option>In Progress</option>
                    <option>Completed</option>
                  </select></div>
              </div>
              <button type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Add Action
                Item</button>
              <button type="reset"
                class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300">Clear</button>
            </form>
          </div>
          <h2 style="text-align: center; margin-top: 20px">All Meetings</h2>
          <table id="meeting-table">
            <thead></thead>
            <tbody></tbody>
          </table>
          <div style="height: 40px;"></div>
          <h2 style="text-align: center;">All Action Items</h2>
          <table id="action-table">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
        <div id="media-section" style="display:none; text-align:center;">
          <h2>Upload Weekly Media Files</h2>
          <form id="media-upload-form" method="post" enctype="multipart/form-data"
            style="max-width: 800px; margin:0 auto; border:2px solid #ccc; padding:20px; border-radius:8px;">
            <div class="form-grid">
              <div>
                <label for="weekInfoMedia">Week:</label>
                <select name="weekInfo" id="weekInfoMedia" required>
                </select>
              </div>
              <div> <label for="zoneMedia">Zone:</label> <select name="zone" id="zoneMedia" required>
                  <option value="">Select Zone</option>
                  <option>Zone 1</option>
                  <option>Zone 2</option>
                  <option>Zone 3</option>
                </select> </div>
              <div> <label for="districtMedia">District:</label> <select name="district" id="districtMedia" required>
                  <option value="">Select District</option>
                  <option>Balangir</option>
                  <option>Bargarh</option>
                  <option>Cuttack</option>
                  <option>Ganjam</option>
                  <option>Keonjhar</option>
                  <option>Koraput</option>
                  <option>Mayurbhanj</option>
                  <option>Sambalpur</option>
                  <option>Sundargarh</option>
                </select> </div>
              <div class="full-width"> <label for="mediaFileMedia">Upload Media (Photos/Videos):</label> <input
                  type="file" name="mediaFile" id="mediaFileMedia" accept="image/*,video/*" required> </div>
            </div><button type="submit"
              class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Upload
              Media</button>
          </form>
          <h3>Uploaded Media Gallery</h3>
          <div id="media-gallery" style="margin-top: 40px;">
            <p>Loading media gallery...</p>
          </div>
        </div>
        <div id="presentations-section" style="display:none;">
          <h2>Project Presentations</h2>
          <div class="presentation-upload-form-container">
            <h3>Add New Presentation</h3>
            <form id="presentation-upload-form">
              <div> <label for="presentationWeekInfo">Week Number:</label> <select name="weekInfo"
                  id="presentationWeekInfo" required>
                </select> </div>
              <div> <label for="presentationIframeCode">Google Slides Embed Code (iframe):</label> <textarea
                  name="iframeCode" id="presentationIframeCode" required
                  placeholder="Paste the full &lt;iframe&gt; code from Google Slides here..."></textarea> </div><button
                type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Save
                Presentation</button>
            </form>
          </div>
          <div id="presentations-display-area" style="margin-top: 30px;">
            <p>Loading presentations...</p>
          </div>
        </div>
        <div id="admin-section" style="display: none;" class="max-w-md mx-auto mt-10">
          <form id="admin-login-form" class="bg-white p-8 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-6 text-center" style="color: #fff;">Admin Login</h2>
            <div class="mb-4">
              <label for="username" class="block text-gray-700 text-sm font-bold mb-2">Username:</label>
              <input type="text" id="username" name="username"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            </div>
            <div class="mb-6">
              <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
              <input type="password" id="password" name="password"
                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline">
            </div>
            <div class="flex items-center justify-between">
              <button type="submit"
                class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                Sign In
              </button>
            </div>
          </form>
        </div>
        <div id="repository-section" style="display:none;">
          <h2>Document Repository</h2>
          <div id="repository-upload-form-container">
            <h3>Add New File</h3>
            <form id="repository-upload-form">
              <label for="repositoryTitle">Title (Select existing or type a new one):</label>
              <input list="repository-titles" id="repositoryTitle" name="title" required>
              <datalist id="repository-titles"></datalist>

              <label for="repositoryDocName">Document Name:</label>
              <input type="text" id="repositoryDocName" name="docName" required>

              <label for="repositoryFileLink">File Link (Google Drive, OneDrive, etc.):</label>
              <input type="url" id="repositoryFileLink" name="fileLink" required>

              <button type="submit"
                class="px-4 py-2 text-sm font-medium text-white bg-teal-600 rounded-lg hover:bg-teal-700">Add
                File</button>
            </form>
          </div>
          <div id="repository-display-area" class="mt-8">
            <!-- Repository files will be displayed here -->
          </div>
        </div>
      </div>
      <div id="plan-section" style="display:none;">
        <h2>Project Plan - Gantt Chart</h2>
        <iframe id="plan-gantt-iframe" srcdoc=""
          style="width:100%; height:85vh; border:none; margin-top: 20px;"></iframe>
      </div>
      <div id="progress-section" style="display:none;">
        <!-- Content will be injected by initializeProgressTracker() -->
      </div>
      <div id="infographic-content-area" style="display:none;"></div>
    </div>
    <div id="loadingIndicator" class="loading-indicator">
      <div class="loader"></div>
      <p>Processing...</p>
    </div>
    <div id="customMessageBoxOverlay" class="custom-message-box-overlay">
      <div class="custom-message-box">
        <p id="customMessageText"></p>
        <div class="custom-message-box-buttons">
          <button id="customMessageConfirm" class="confirm-button">OK</button>
          <button id="customMessageCancel" class="cancel-button">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- APP-WIDE CONSTANTS & STATE ---
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyoLTLQaMjJXBnN3luRiscIiOM1fnYEcpfUY3yLmWAICTGhkU8DOukytwfB-yh8sJUMwQ/exec';
    let isAdminLoggedIn = false;

    // --- HTML CONTENT FOR DYNAMIC PAGES ---
    const infographicPageBodyHTML = `
  <div class="infographic-container">
    <header class="text-center mb-16"> <h1 class="text-4xl md:text-5xl font-bold" style="color: #1B5E20;">Bloomberg Cities Idea Exchange</h1> <h2 class="text-2xl md:text-3xl mt-3" style="color: #4CAF50;">Economic Vulnerability Project: Powering Cold Storage with Solar Energy & Community Cooperatives</h2> </header>
    <main class="space-y-16">
      <section class="stat-card text-center border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h3 class="section-title text-3xl mb-6">🎯 Project Objective Overview</h3> <p class="text-2xl font-semibold" style="color: #1B5E20;">Our Core Mission: Scaling the highly successful Rourkela Cold Room Project model statewide across Odisha, transforming local economies and empowering communities! <span class="text-3xl inline-block ml-2">🚀</span></p> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">📍 Geographic Impact - Phase 1 Expansion</h3> <p class="text-center text-lg mb-8">We're expanding our reach across Odisha to bring sustainable cold storage solutions to more communities, fostering growth and reducing food loss.</p> <div class="stat-card text-center p-6 mb-8 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3" style="color: #4CAF50;">Cold Room Locations Across Odisha</h4> <p class="text-sm text-gray-600 mb-4">Visual representation of cold room distribution across the 9 target districts, highlighting the project's widespread impact.</p> <img src="https://i.ibb.co/xKHycNFJ/Odisha-Cold-Room-Phase1-Map.png" 
      style="display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);"
      alt="Cold Room Locations Across Odisha" />
</div> <div class="stat-card p-6 mb-8 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3 text-center" style="color: #4CAF50;">Phase 1 Cold Room Site Details</h4> <p class="text-sm text-center mb-4">A comprehensive list of all 41 cold room sites, detailing their location, type, capacity, operators, and supervision.</p> <div class="table-container"> <table class="data-table"> <thead><tr><th class="py-3 px-4">#</th><th class="py-3 px-4">District</th><th class="py-3 px-4">Sub-Division</th><th class="py-3 px-4">Block</th><th class="py-3 px-4">Nearby Urban Local Body</th><th class="py-3 px-4">Cold Room Type</th><th class="py-3 px-4">Locations</th><th class="py-3 px-4">Size (in MT)</th><th class="py-3 px-4">Operators</th><th class="py-3 px-4">Supervision By</th></tr></thead> 
  <tbody> 
    <tr><td>01</td><td>Balangir</td><td>Titila garh</td><td>Titilagarh</td><td>Titilagarh Municipality</td><td>OREDA</td><td>Besil</td><td>10</td><td>Jaden FPC</td><td>DDH Balangir</td></tr> 
    <tr><td>02</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh Municipality</td><td>Pre-Existing</td><td>RMC Behera Market</td><td>10</td><td>Premsai SHG</td><td>RMC Bargarh</td></tr> 
    <tr><td>03</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh</td><td>Bargarh Municipality</td><td>Pre-Existing</td><td>RMC Sarandapali</td><td>10</td><td>Jawala SHG</td><td>RMC Bargarh</td></tr> 
    <tr><td>04</td><td>Cuttack</td><td>Athagarh</td><td>Athagarh</td><td>Athagarh NAC</td><td>OREDA</td><td>Athagarh NAC</td><td>10</td><td>Sasmita Rout & Coop .</td><td>DDH Cuttack</td></tr> 
    <tr><td>05</td><td>Cuttack</td><td>Banki</td><td>Banki</td><td>Banki NAC</td><td>OREDA</td><td>Nistipur</td><td>10</td><td>Jaydev Jena & Coop .</td><td>DDH Cuttack</td></tr>
    <tr><td>06</td><td>Cuttack</td><td>Cuttack</td><td>Tangi-Choudwar</td><td>Choudwar Municipality</td><td>OREDA</td><td>Dudhianali</td><td>10</td><td>Puspita Sahoo & Coop .</td><td>DDH Cuttack</td></tr>
    <tr><td>07</td><td>Ganjam</td><td>Berhampur</td><td>Chikiti</td><td>Chikiti NAC</td><td>Pre-Existing</td><td>RMC Kalabada Market Yard</td><td>10</td><td>RMC Digapahandi</td><td>RMC Digapahandi</td></tr>
    <tr><td>08</td><td>Ganjam</td><td>Berhampur</td><td>Digapahandi</td><td>Digapahandi NAC</td><td>Pre-Existing</td><td>RMC Digapahandi Market Yard</td><td>30</td><td>FPO</td><td>RMC Digapahandi</td></tr>
    <tr><td>09</td><td>Ganjam</td><td>Bhanjanagar</td><td>Bhanjanagar</td><td>Bhanjanagar NAC</td><td>Pre-Existing</td><td>RMC Bhanjanagar Market Yard</td><td>10</td><td>Maa Byaghradevi FPC</td><td>RMC Bhanjanagar</td></tr>
    <tr><td>10</td><td>Ganjam</td><td>Bhanjanagar</td><td>Bhanjanagar .</td><td>Bhanjanagar NAC</td><td>OREDA</td><td>Bahadapada</td><td>10</td><td>Khali Bishoyi & Coop .</td><td>DDH Ganjam</td></tr>
    <tr><td>11</td><td>Ganjam</td><td>Buguda</td><td>Buguda</td><td>Buguda NAC</td><td>Pre-Existing</td><td>RMC Buguda Market Yard</td><td>10</td><td>Gajalaxmi PG</td><td>RMC Bhanjanagar</td></tr>
    <tr><td>12</td><td>Ganjam</td><td>Chatrapur</td><td>Chatrapur</td><td>Chatrapur NAC</td><td>Pre-Existing</td><td>Chatrapur Market</td><td>30</td><td>Sampoorna Sukanya PC</td><td>RMC Hinjilicut</td></tr>
    <tr><td>13</td><td>Ganjam</td><td>Purushottampur</td><td>Purushottampur</td><td>Purushottampur NAC</td><td>OREDA</td><td>Kolasingi</td><td>10</td><td>Baba Biswanath FPO</td><td>DDH Ganjam</td></tr>
    <tr><td>14</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Raisuan</td><td>10</td><td>Maa Tarini Vegetable PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>15</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Madarangajodi</td><td>05</td><td>Maa Mangala PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>16</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Mukuna</td><td>05</td><td>Satya Narayana PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>17</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Tikarapada</td><td>05</td><td>Maa Taratarini PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>18</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Nuagaon ( Narsinghpur )</td><td>10</td><td>Radhakrishna PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>19</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Baradapala ,</td><td>05</td><td>Maa Tarini vegetable PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>20</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Ratanpur</td><td>05</td><td>Jay Hanuman PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>21</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Tulasichaura</td><td>10</td><td>Meghmala Parida and FPO</td><td>DDH Keonjhar</td></tr>
    <tr><td>22</td><td>Kendujhar</td><td>Keonjhar sadar</td><td>Keonjhar</td><td>Keonjhar Municipality</td><td>Pre-Existing</td><td>Kathakaranjia</td><td>05</td><td>Mandaramalini PG</td><td>DDH Keonjhar</td></tr>
    <tr><td>23</td><td>Koraput</td><td>Jeypore</td><td>Jeypore</td><td>Jeypore Municipality</td><td>Pre-Existing</td><td>Ghatabhagra</td><td>10</td><td>Bajrangbali SHG</td><td>DDH Koraput</td></tr>
    <tr><td>24</td><td>Koraput</td><td>Koraput</td><td>Semliguda</td><td>Sunabeda Municipality</td><td>Pre-Existing</td><td>Malimarla</td><td>10</td><td>Kailashgiri SHG</td><td>DDH Koraput</td></tr>
    <tr><td>25</td><td>Mayurbhanj</td><td>Bamanaghati</td><td>Rairangpur</td><td>Rairangpur Municipality</td><td>Pre-Existing</td><td>Baghiatangar</td><td>05</td><td>Padmabati SHG</td><td>DDH Mayurbhanj</td></tr>
    <tr><td>26</td><td>Mayurbhanj</td><td>Kaptipada</td><td>Udala</td><td>Udala NAC</td><td>Pre-Existing</td><td>Chapaldihi</td><td>05</td><td>Jai Maa Tarini SHG</td><td>DDH Mayurbharj</td></tr>
    <tr><td>27</td><td>Mayurbhanj</td><td>Panchapid</td><td>Karanjia</td><td>Karanjia Municipality</td><td>Pre-Existing</td><td>Akhapolan</td><td>10</td><td>Maa Mangala SHG</td><td>DDH Mayurbhanj</td></tr>
    <tr><td>28</td><td>Mayurbhanj</td><td>Baripada</td><td>Baripada</td><td>Baripada Municipality</td><td>OREDA</td><td>Sandhenkia</td><td>10</td><td>Sandhenkia SHG</td><td>DDH Mayurbhanj</td></tr>
    <tr><td>29</td><td>Mayurbhanj</td><td>Rairangpur</td><td>Rairangpur</td><td>Rairangpur Municipality</td><td>OREDA</td><td>Tikhia</td><td>10</td><td>Bahalda FPC</td><td>DDH Mayurbhanj</td></tr>
    <tr><td>30</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>Pre-Existing</td><td>Kuchinda</td><td>05</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr>
    <tr><td>31</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>Pre-Existing</td><td>Bhojpur</td><td>30</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr>
    <tr><td>32</td><td>Sambalpur</td><td>Kuchinda</td><td>Kuchinda</td><td>Kuchinda NAC</td><td>OREDA</td><td>T.Niktimal</td><td>10</td><td>RMC Kuchinda</td><td>RMC Kuchinda</td></tr>
    <tr><td>33</td><td>Sambalpur</td><td>Rairakhol</td><td>Redhakhol</td><td>Redhakhol NAC</td><td>Pre-Existing</td><td>Charmal</td><td>05</td><td>RMC Redhakhol</td><td>RMC Redhakhol</td></tr>
    <tr><td>34</td><td>Sambalpur</td><td>Sambalpur</td><td>Dhankauda</td><td>Sambalpur Municipal Corporation</td><td>Pre-Existing</td><td>Khetrajpur</td><td>05</td><td>RMC Sambalpur</td><td>RMC Sambalpur</td></tr>
    <tr><td>35</td><td>Sundargarh</td><td>Panposh</td><td>Bisra</td><td>Biramitrapur Municipality</td><td>Pre-Existing</td><td>Kardega .</td><td>05</td><td>Samleswari SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>36</td><td>Sundargarh</td><td>Panposh</td><td>Lathikata</td><td>Rourkela Municipal Corporation</td><td>Pre-Existing</td><td>Kadalidhipa</td><td>05</td><td>Muskan SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>37</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Rajgangpur Municipality</td><td>Pre-Existing</td><td>Khariapada</td><td>05</td><td>Priya SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>38</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Rajgangpur Municipality</td><td>Pre-Existing</td><td>Bhelluadihi</td><td>05</td><td>Shaktirupa SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>39</td><td>Sundargarh</td><td>Panposh</td><td>Rajgangpur</td><td>Rajgangpur Municipality</td><td>Pre-Existing</td><td>Domposh</td><td>05</td><td>Ritika SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>40</td><td>Sundargarh</td><td>Sundargarh</td><td>Sundargarh</td><td>Sundargarh Municipality</td><td>Pre-Existing</td><td>Rajpur</td><td>05</td><td>Bulbul SHG</td><td>DDH Sundargarh</td></tr>
    <tr><td>41</td><td>Sundargarh</td><td>Rourkela</td><td>Lathikata</td><td>Rourkela Municipal Corporation</td><td>OREDA</td><td>Kansar</td><td>10</td><td>Subhashree Mohanty & Coop .</td><td>DDH Sundargarh</td></tr> 
    </tbody> </table> </div> </div> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">41</div><p class="text-xl mt-2">Total Sites <span class="text-3xl inline-block ml-1">🏗️</span></p><p class="text-sm text-gray-600">(Existing & Upcoming)</p></div> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">25</div><p class="text-xl mt-2">Cities Covered <span class="text-3xl inline-block ml-1">🏙️</span></p></div> <div class="stat-card text-center p-6 border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"><div class="big-number">9</div><p class="text-xl mt-2">Key Districts <span class="text-3xl inline-block ml-1">🗺️</span></p></div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start"> <div class="stat-card border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3 text-center" style="color: #4CAF50;">Site Distribution</h4> <p class="text-sm text-center mb-4">The 41 sites comprise both existing facilities and new installations, ensuring a broad and effective rollout.</p> <div class="chart-container"><canvas id="sitesChart"></canvas></div> </div> <div class="stat-card border border-gray-200 hover:shadow-xl hover:transform hover:-translate-y-1 transition-all duration-300 ease-in-out"> <h4 class="font-semibold text-xl mb-3" style="color: #4CAF50;">Districts Served in Odisha:</h4> <p class="text-sm mb-4">Our project aims to make a significant impact across these key agricultural regions within Odisha.</p> <ul class="space-y-2"> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Balangir</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Bargarh</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Sambalpur</li> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Sundargarh</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Keonjhar</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Mayurbhanj</li> <li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Cuttack</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Ganjam</li><li class="icon-list-item"><span class="icon text-2xl mr-3">🗺️</span> Koraput</li> </ul> </div> </div> </section>
      <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🤝 Key Partners & Execution Strategy</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center"><div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Dedicated Implementing Agency</h4> <p class="text-lg mb-2">Proudly implemented by:</p> <p class="text-2xl font-bold" style="color: #1B5E20;">Koel Fresh Private Limited</p> <p class="text-sm mt-1 text-gray-600">(As per the significant MoU between Directorate of Horticulture (Odisha) and Delivery Associates (UK))</p></div><div class="text-center"> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Phase 1 Timeline</h4> <p class="text-lg mb-2">This phase is designed for rapid, impactful deployment:</p> <div class="big-number" style="font-size: 4rem; color: #1B5E20;">2 <span class="text-3xl align-baseline">Years</span></div> <p class="text-xl mt-2">Focused Simultaneous Execution ⏳</p> <p class="text-sm text-gray-600">(Across all 41 sites)</p></div></div> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">🛠️ Strategic Pillars - Phase 1 Focus</h3> <p class="text-center text-lg mb-8">Our success in Phase 1 is built on three core strategic pillars, ensuring comprehensive development and sustainable impact.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"> <div class="stat-card text-center p-6"> <div class="text-5xl mb-4">🧊</div> <h4 class="font-semibold text-xl mb-2" style="color: #1B5E20;">Optimal Cold Room Utilization</h4> <p class="text-gray-600">Maximizing the efficiency and usage of cold storage facilities to preserve produce quality and extend shelf life.</p> </div> <div class="stat-card text-center p-6"> <div class="text-5xl mb-4">👩‍🏫</div> <h4 class="font-semibold text-xl mb-2" style="color: #4CAF50;">Robust SHG/FPO Capacity Building</h4> <p class="text-gray-600">Empowering Self-Help Groups and Farmer Producer Organizations with skills and knowledge for effective management.</p> </div> <div class="component-card text-center p-6"> <div class="text-5xl mb-4">🔗</div> <h4 class="font-semibold text-xl mb-2" style="color: #FFC107;">Strong Market Linkage Establishment</h4> <p class="text-gray-600">Connecting farmers and cooperatives to viable markets, ensuring better prices and consistent demand for their produce.</p> </div> </div> </section>
      <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🌟 The Rourkela Cold Room Project: A Model of Success! 🏆</h3> <p class="text-center text-lg mb-6">(A proud Winner of the Bloomberg Philanthropies Global Mayors Challenge 2021!)</p> <p class="text-center text-lg mb-8">The expansion builds upon the proven, impactful results of the Rourkela pilot project, which demonstrated significant benefits for farmers and the community.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center"> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="big-number" style="color: #1B5E20;">75%</div> <p class="text-xl mt-2 font-semibold">Food Waste Reduction 🗑️➡️✅</p> <p class="text-sm text-gray-600 mt-1">Dramatically reduced post-harvest losses.</p> </div> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="text-5xl mb-3" style="color: #4CAF50;">💰</div> <p class="text-xl mt-2 font-semibold">Higher Farmer Earnings</p> <p class="text-sm text-gray-600 mt-1">Enabled farmers to achieve significantly better prices for their valuable produce.</p> </div> <div class="p-6 bg-white rounded-lg shadow-inner border border-gray-200"> <div class="text-5xl mb-3" style="color: #FFC107;">💪</div> <p class="text-xl mt-2 font-semibold">Women-Led Cooperative Empowerment</p> <p class="text-sm text-gray-600 mt-1">Fostered and strengthened women-led cooperatives, driving local economic growth.</p> </div> </div> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">🚀 Our Ambitious Project Goals</h3> <p class="text-center text-lg mb-8">We are committed to driving positive and lasting change across Odisha through these key objectives.</p> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div class="stat-card icon-list-item"> <span class="icon">🍎</span> <div> <h4 class="font-semibold text-lg">Combat Food Waste</h4> <p class="text-sm text-gray-600">Minimize food waste and eliminate distress selling among our valued small farmers and vendors.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">👩‍🌾</span> <div> <h4 class="font-semibold text-lg">Empower Local Communities</h4> <p class="text-sm text-gray-600">Uplift and empower women (SHGs/PGs) and farmer cooperatives (FPOs/FPCs) through sustainable practices.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">🔒</span> <div> <h4 class="font-semibold text-lg">Enhance Food Security</h4> <p class="text-sm text-gray-600">Strengthen regional food security and build resilient market linkages for a better future.</p> </div> </div> <div class="stat-card icon-list-item"> <span class="icon">🌱</span> <div> <h4 class="font-semibold text-lg">Foster Sustainable Enterprises</h4> <p class="text-sm text-gray-600">Cultivate and establish thriving, community-led cold room enterprises that last.</p> </div> </div> </div> </section>
      <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-6">🗺️ The Roadmap: Key Components of the Full Master Plan</h3> <p class="text-center text-lg mb-8">The comprehensive master plan provides a clear and detailed pathway for successful project implementation, covering all critical aspects.</p> <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"> <li class="icon-list-item"><span class="icon">⏱️</span> A Detailed Comprehensive Timeline</li> <li class="icon-list-item"><span class="icon">👥</span> A Clear Stakeholder Framework</li> <li class="icon-list-item"><span class="icon">🛠️</span> An Actionable Implementation Strategy</li> <li class="icon-list-item"><span class="icon">📢</span> A Proactive Communication Approach</li> <li class="icon-list-item"><span class="icon">✅</span> A Robust Monitoring System</li> </ul> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">🗓️ Implementation Timeline: 12 Months, Concurrent Rollout</h3> <p class="text-center text-lg mb-8">All 41 cold room sites will be activated in parallel, with key phases overlapping across districts to ensure efficient and widespread impact.</p> <div class="space-y-6"> <div class="timeline-item"> <h4>Months 1-2: Kick-off, PMU Setup & Infrastructure Readiness 🚀</h4> <ul> <li><span class="font-semibold">Kick-off Meetings:</span> Launch project simultaneously across all selected districts with formal meetings by Koel Fresh, District Horticulture Offices, and District Administrations. Communicate objectives, timelines, roles, and outcomes.</li> <li><span class="font-semibold">Central Project Management Unit (PMU) Setup (State Level):</span> Establish within Koel Fresh's head office (Rourkela or Bhubaneswar). Appoint dedicated Project Director, Project Manager, M&E Specialist, Market Linkage Specialist, Digital Tools Expert, and Communications Officer. Centralize coordination with Delivery Associates, Directorate of Horticulture, OREDA, ORMAS, OLM, NGOs, and state-level stakeholders. Develop guidelines, SOPs, reporting formats, and deploy digital dashboards for oversight.</li> <li><span class="font-semibold">District-Level PMUs Setup:</span> Establish dedicated PMUs in each of the 9 districts, preferably at District Horticulture Offices. Appoint District Project Coordinators, Field Executives, Capacity Building Trainers, and Community Mobilizers. Ensure representation from district horticulture officials, collectors/CDOs, ORMAS, OLM, RMC officials, and local NGO representatives. Coordinate daily activities, site readiness, local capacity building, farmer outreach, operational support, and troubleshooting. Organize monthly district-level coordination meetings and provide weekly performance data to Central PMU.</li> <li><span class="font-semibold">Infrastructure Readiness & Equipment Setup:</span><ul><li><span class="font-semibold">New Cold Rooms (10 units):</span> Coordinate timely installation, commissioning, and final readiness checks with OREDA. Ensure technical readiness and operational handover by Month 2.</li><li><span class="font-semibold">Existing Cold Rooms (31 units):</span> Verify operational functionality, minor maintenance, and accessory installations (storage crates, digital scales, tablets). Ensure any minor repairs, cleaning, or equipment setup completed for full operational readiness by Month 2.</li></ul></li> </ul> </div> <div class="timeline-item"> <h4>Months 2-3: Training & Capacity Building 👩‍🏫</h4> <ul> <li><span class="font-semibold">Simultaneous Training Sessions:</span> Conduct training for all cold room operating groups: Women Self-Help Groups (SHGs), Producer Groups (PGs), Farmer Producer Organizations (FPOs), and Regulated Market Committee (RMC) staff.</li> <li><span class="font-semibold">Capacity Building Workshops:</span> Covering cold room operations and routine maintenance, digital inventory management using a mobile application, basic financial bookkeeping and business management skills, and customer interaction and community engagement best practices.</li> <li><span class="font-semibold">Practical Trial Runs:</span> Initiate small-scale pilot storage operations at each site, allowing farmers/vendors to store produce and experience operational procedures firsthand. Provide continuous on-site guidance and support by Koel Fresh staff.</li> <li><span class="font-semibold">Monitoring and Feedback:</span> Regularly assess training effectiveness and operator readiness. Identify operational challenges early and refine training accordingly.</li> </ul> </div> <div class="timeline-item"> <h4>Months 3-8: Operational Launch, Awareness, Market Linkage Development 📈</h4> <ul> <li><span class="font-semibold">Cold Room Operations Begin:</span> Launch full-scale operations at all 41 sites by Month 4. Ensure daily availability of storage services for farmers and vendors.</li> <li><span class="font-semibold">Farmer & Vendor Onboarding:</span> Conduct targeted awareness drives in villages and markets. Promote cold room benefits through flyers, posters, loudspeaker announcements, and community meetings. Enroll farmers and vendors as regular users through SHG/FPO outreach.</li> <li><span class="font-semibold">Market Linkage Facilitation:</span> Koel Fresh teams connect SHGs/FPOs with bulk buyers such as wholesalers, retail chains, hotels, hospitals, hostels, food processors, and institutions. Schedule regular procurement pickups and aggregation planning.</li> <li><span class="font-semibold">Community Engagement:</span> Use existing platforms (weekly haats, panchayat meetings) to demonstrate use cases. Coordinate with NGOs and OLM to sustain participation and farmer confidence.</li> <li><span class="font-semibold">Mid-Project Review (Around Month 8):</span> Organize joint review meetings with district-level stakeholders. Evaluate utilization rates, SHG/FPO performance, and cold room impact. Identify and resolve any adoption, logistics, or maintenance challenges.</li> </ul> </div> <div class="timeline-item"> <h4>Months 9-12: Optimization, Evaluation & Sustainability Planning ✅</h4> <ul> <li><span class="font-semibold">Optimize Utilization & Financial Viability:</span> Focus on maximizing cold room usage across all sites. Analyze patterns of underutilization and implement corrective actions. Introduce or adjust incentive programs to encourage greater usage (if required).</li> <li><span class="font-semibold">Strong Market Linkages:</span> Refine existing procurement schedules with bulk buyers. Expand partnerships for consistent off-take of produce. Support operators in diversifying customer base (e.g., events, hostels, processors).</li> <li><span class="font-semibold">Build Long-Term Sustainability:</span> Assist SHGs/FPOs in developing Standard Operating Procedures (SOPs). Support preparation of basic business and operational plans for self-reliance. Guide cooperatives on setting service charges, reinvestment, and maintenance models.</li> <li><span class="font-semibold">Performance Evaluation:</span> Conduct site-wise assessment against Key Performance Indicators (KPIs) including utilization rates, farmer and SHG income improvements, market linkage volumes, and reduction in spoilage/waste. Capture field data, testimonials, and success stories.</li> </li><li><span class="font-semibold">Project Closure & Knowledge Sharing:</span> Organize district-level closure workshops to present results and highlight best practices. Host a state-level closure and learning event with all stakeholders. Document lessons learned and outline the roadmap for replication and long-term integration.</li> </ul> </div> </div> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">❄️ Cold Room Site Details: A Deeper Look ❄️</h3> <p class="text-center text-lg mb-8">The project strategically utilizes 41 cold storage rooms, integrating both existing infrastructure and new solar-powered units, tailored to local needs and community empowerment.</p> <div class="mb-8"> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Location & Ownership Model:</h4> <p class="text-md mb-4">Cold rooms are strategically located to maximize accessibility and impact, reflecting a dual ownership model to best serve local communities.</p> <div class="ownership-bar-container"> <div class="ownership-bar-rmc" style="width: calc(11 / 41 * 100%);">11 RMC Premises</div> <div class="ownership-bar-community" style="width: calc(30 / 41 * 100%);">30 Community-Managed</div> </div> <p class="text-sm text-gray-600 mt-2">11 sites are on Regulated Market Committee (RMC) yards, facilitating direct access for market vendors. The remaining 30 are at farm-gate or village cluster locations, operated by women’s Self-Help Groups (SHGs), Producer Groups (PGs), or Farmer Producer Organizations/Companies (FPOs/FPCs).</p> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Existing vs. New Facilities:</h4> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">🔄</span><div><h5 class="font-semibold text-lg">31 Existing Cold Rooms:</h5><p class="text-sm text-gray-600">Leveraged immediately, these units will be activated by training current operators or bringing in SHG/FPO management to address low utilization.</p></div></li> <li class="icon-list-item"><span class="icon">☀️</span><div><h5 class="font-semibold text-lg">10 New Solar-Powered Units (by OREDA):</h5><p class="text-sm text-gray-600">These 10MT units expand capacity in identified gaps, ensuring uninterrupted cooling with 5-year maintenance support, aligning with sustainable energy goals.</p></div></li> </ul> </div> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Capacity and Technology:</h4> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📦</span><div><h5 class="font-semibold text-lg">Storage Capacity:</h5><p class="text-sm text-gray-600">Each cold room typically ranges from 5 to 30 metric tons of perishable produce storage, adaptable to local needs.</p></div></li> <li class="icon-list-item"><span class="icon">⚙️</span><div><h5 class="font-semibold text-lg">Advanced Technology:</h5><p class="text-sm text-gray-600">All units, new and existing, are equipped with precise temperature control systems and IoT sensors for optimal monitoring and management.</p></div></li> </ul> </div> </div> <div> <h4 class="font-semibold text-2xl mb-3" style="color: #4CAF50;">Community-Centric Operations Model:</h4> <p class="text-md mb-4">Each site adopts a community-centric model, empowering local groups and fostering ownership, a key to the project's success.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">👩‍👩‍👧‍👦</span><div><h5 class="font-semibold text-lg">Managed by Local Cooperatives:</h5><p class="text-sm text-gray-600">Wherever possible, cold rooms are managed by local women’s cooperatives (SHGs/FPOs), providing livelihood opportunities and encouraging local trust.</p></div></li> <li class="icon-list-item"><span class="icon">🌟</span><div><h5 class="font-semibold text-lg">Rourkela Pilot Success:</h5><p class="text-sm text-gray-600">The Rourkela pilot demonstrated that women-run cold rooms significantly increase farmers’ incomes and create new economic opportunities for women entrepreneurs.</p></div></li> <li><span class="icon">🤝</span><div><h5 class="font-semibold text-lg">Integrated Operations:</h5><p class="text-sm text-gray-600">At some sites, existing FPOs or cooperative marketing societies lead operations, integrating their members into project activities for seamless functionality.</p></div></li> </ul> </div> </section>
      <section class="stat-card"> <h3 class="section-title text-3xl text-center mb-8">🏛️ Institutional Framework & Project Structure 🏛️</h3> <p class="text-center text-lg mb-8">A robust institutional framework, anchored by the MoU between the Directorate of Horticulture, Odisha and Delivery Associates UK, guides the project's implementation, establishing clear roles and collaboration mechanisms.</p> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Governing Bodies: State Level Oversight</h4> <p class="text-md text-center mb-6">Overall policy guidance and strategic direction are provided at the state level, ensuring alignment with government objectives and swift issue resolution.</p> <div class="flex flex-col items-center"> <div class="org-chart-node">Directorate of Horticulture (DoH)<br><span class="text-sm font-normal text-gray-600">Overall Policy Guidance & Integration</span></div><div class="org-chart-arrow">⬇️</div> <div class="org-chart-node">State-Level Steering Committee<br><span class="text-sm font-normal text-gray-600">Chaired by Director of Horticulture (Monthly Meetings)</span></div><div class="org-chart-line"></div> <div class="org-chart-flex"> <div class="org-chart-node"><span class="font-semibold">DDH (Nodal Officer)</span><br><span class="text-sm font-normal text-gray-600">Ensures district administration support</span></div> <div class="org-chart-node"><span class="font-semibold">OLM & ORMAS Officials</span><br><span class="text-sm font-normal text-gray-600">Livelihoods Mission & Rural Marketing Society</span></div> <div class="org-chart-node"><span class="font-semibold">RMC Leadership</span><br><span class="text-sm font-normal text-gray-600">Regulated Market Committee</span></div> <div class="org-chart-node"><span class="font-semibold">Koel Fresh District Coordinator</span><br><span class="text-sm font-normal text-gray-600">Liaison & Site-level Execution Oversight</span></div> </div> </div> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Koel Fresh’s Central Role: Project Management & Field Execution</h4> <p class="text-md text-center mb-6">Koel Fresh serves as the primary implementing agency, coordinating all activities across the 41 sites and driving the project's core focus areas.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📍</span><div><h5 class="font-semibold text-lg">Project Management Unit (PMU) & Field Arm</h5><p class="text-sm text-gray-600">Coordinates all activities from technical support and training to market linkage facilitation across all 41 sites.</p></div></li> <li class="icon-list-item"><span class="icon">🎯</span><div><h5 class="font-semibold text-lg">Executing Three Core Focus Areas</h5><ul class="list-disc list-inside text-sm text-gray-600 ml-4"><li>Maximizing cold room utilization</li><li>Building capacity of SHGs/FPOs to manage units</li><li>Linking farmers to markets for better incomes</li></ul><p class="text-sm text-gray-600 mt-1">These mirror the Rourkela model's success in providing infrastructure, connecting farmers to buyers, and empowering women's groups.</p></div></li> <li class="icon-list-item"><span class="icon">🗺️</span><div><h5 class="font-semibold text-lg">District Coordinators</h5><p class="text-sm text-gray-600">Dedicated coordinators deployed in each of the 9 districts to liaise with local officials and oversee site-level execution.</p></div></li> </ul> </div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Delivery Associates’ Role: Performance & Replication</h4> <p class="text-md text-center mb-6">Delivery Associates (UK) brings expertise in performance management, ensuring outcome-oriented implementation and facilitating knowledge sharing.</p> <ul class="space-y-3"> <li class="icon-list-item"><span class="icon">📊</span><div><h5 class="font-semibold text-lg">Performance Management & KPI Dashboards</h5><p class="text-sm text-gray-600">Helps design KPI dashboards and facilitates problem-solving sessions to ensure project stays outcome-oriented.</p></div></li> <li class="icon-list-item"><span class="icon">📝</span><div><h5 class="font-semibold text-lg">Documentation & Replication</h5><p class="text-sm text-gray-600">Documents the process for future replication and scaling of the successful model.</p></div></li> <li class="icon-list-item"><span class="icon">🤝</span><div><h5 class="font-semibold text-lg">Donor Reporting & Capacity Building</h5><p class="text-sm text-gray-600">Monitors and reports to donors (like Bloomberg Philanthropies) and may embed advisors to build capacity in data-driven delivery.</p></div></li> </ul></div> <div class="mb-10"> <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Local Governance & Ownership: District Level Coordination</h4> <p class="text-md text-center mb-6">Institutional anchoring at the district level secures buy-in from all relevant authorities and keeps the project high on the agenda, ensuring local relevance and support.</p> <div class="flex flex-col items-center"> <div class="org-chart-node">District Collector / Addl. Collector<br><span class="text-sm font-normal text-gray-600">Chair of District Working Group (Bi-monthly Meetings)</span></div><div class="org-chart-arrow">⬇️</div> <div class="org-chart-node">District Working Group<br><span class="text-sm font-normal text-gray-600">Tracks progress, mobilizes resources, resolves issues</span></div><div class="org-chart-line"></div> <div class="org-chart-flex"> <div class="org-chart-node"><span class="font-semibold">DDH (Nodal Officer)</span><br><span class="text-sm font-normal text-gray-600">Ensures district administration support</span></div> <div class="org-chart-node"><span class="font-semibold">OLM & ORMAS Officials</span><br><span class="text-sm font-normal text-gray-600">Livelihoods Mission & Rural Marketing Society</span></div> <div class="org-chart-node"><span class="font-semibold">RMC Leadership</span><br><span class="text-sm font-normal text-gray-600">Regulated Market Committee</span></div> <div class="org-chart-node"><span class="font-semibold">Koel Fresh District Coordinator</span><br><span class="text-sm font-normal text-gray-600">Liaison & Site-level Execution Oversight</span></div> </div> </div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">This institutional setup effectively balances government oversight, professional project management, and crucial community ownership, ensuring all stakeholders work towards shared outcomes.</p> </section>
      <section> <h3 class="section-title text-3xl text-center mb-8">👥 Stakeholder Engagement & Roles: A Collaborative Ecosystem 👥</h3> <p class="text-center text-lg mb-8">Successful execution hinges on coordinated efforts among a diverse set of stakeholders, each playing a specific and crucial role in the project's success.</p> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6"> <div class="stakeholder-card"><h4><span class="icon">🌿</span> Directorate of Horticulture (State Level)</h4> <p class="text-sm text-gray-600 mb-3">Provides overall leadership, policy guidance, and integration with state horticulture schemes.</p><ul><li>Issues necessary government orders for facility use and SHG/FPO management.</li><li>Monitors project progress against horticultural development goals.</li><li>Facilitates funds disbursement and champions the initiative to district officials.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🏡</span> District Horticulture Offices (DDH/ADH/AHO)</h4> <p class="text-sm text-gray-600 mb-3">Act as nodal points in each district, ensuring local integration and farmer mobilization.</p><ul><li>Convenes district working groups and mobilizes farmers through block-level officers.</li><li>Assists in new site selection, verifies cold room readiness, and supports training.</li><li>Validates data on utilization and farmer outreach for reporting.</li><li>Can utilize district funds to plug resource gaps (e.g., transport vehicles).</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🛒</span> Regulated Market Committee (RMC) Officials</h4> <p class="text-sm text-gray-600 mb-3">Crucial for cold rooms on market yards, facilitating access and market integration.</p><ul><li>Facilitates space allocation, infrastructure support, and utility access.</li><li>Helps advertise cold storage services to traders and farmers.</li><li>Assists in price discovery and may coordinate user fees and power collection.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👩‍👧‍👦</span> Odisha Livelihoods Mission (OLM)</h4> <p class="text-sm text-gray-600 mb-3">Empowers SHGs by mobilizing, recommending, and providing capacity building support.</p><ul><li>Mobilizes and recommends suitable Women’s Self-Help Groups (SHGs) to operate cold rooms.</li><li>Provides capacity building in group management and financial literacy.</li><li>May extend bank linkage programs or revolving funds for working capital.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">📈</span> Odisha Rural Development and Marketing Society (ORMAS)</h4> <p class="text-sm text-gray-600 mb-3">Specializes in market linkage for rural products, ensuring profitable outlets for produce.</p><ul><li>Connects cold room user groups with higher-order markets and bulk buyers.</li><li>Facilitates tie-ups with large buyers and includes produce in trade fairs.</li><li>Assists in developing branding/packaging and amplifies success stories.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👑</span> District Collectors and Administration</h4> <p class="text-sm text-gray-600 mb-3">Highest authority at the district level, providing oversight and administrative support.</p><ul><li>Convenes coordination meetings and expedites necessary permissions.</li><li>Lends administrative backing, signaling project importance to line departments.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">🤝</span> Community Development/NGO Partners</h4> <p class="text-sm text-gray-600 mb-3">Ensures community buy-in, extends project reach, and provides local expertise.</p><ul><li><span class="font-semibold">SEWA:</span> Mobilizes women vendors, trains in business practices, provides mentorship.</li><li><span class="font-semibold">SEWAK:</span> Facilitates community meetings, resolves local issues, promotes horticulture.</li><li><span class="font-semibold">PRADAN/APC Agencies:</span> Mobilizes farmers in Producer Groups, provides technical knowledge on value chain development.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">⚡</span> OREDA (Odisha Renewable Energy Development Agency)</h4> <p class="text-sm text-gray-600 mb-3">Responsible for the technical aspects of new solar cold storage units.</p><ul><li>Ensures timely installation and technical commissioning of 10 new units.</li><li>Provides demos on basic maintenance and handles major technical servicing.</li><li>May integrate solar systems with data loggers for energy tracking.</li></ul></div> <div class="stakeholder-card"><h4><span class="icon">👨‍💻</span> Koel Fresh Team</h4> <p class="text-sm text-gray-600 mb-3">Manages the project and engages daily with all stakeholders, ensuring smooth communication and coordination.</p><ul><li>Ensures smooth communication and updates with horticulture officers.</li><li>Collaborates with OLM/NGOs to avoid duplication in training efforts.</li><li>Orchestrates joint visits with key stakeholders to showcase progress and maintain transparency.</li></ul></div> </div> <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">This integrated approach, with clearly defined roles and robust communication channels, ensures a holistic support system around each cold room site, mitigating risks and driving collective success.</p> </section>
          <section>
            <h3 class="section-title text-3xl text-center mb-8">⚙️ Implementation Components & Strategy: Actionable Steps ⚙️</h3>
            <p class="text-center text-lg mb-8">Koel Fresh implements the project through several interlinked components, each addressing a critical success factor for the cold room ecosystem, ensuring a comprehensive and effective rollout.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                <div class="component-card">
                    <h4><span class="icon">🔍</span> Feasibility Studies and Site Readiness</h4>
                    <p class="text-sm text-gray-600 mb-3">Thorough assessments ensure each cold room site is technically, economically, socially, and institutionally prepared for successful operations.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Technical Feasibility:</span> Verify cold room functionality, inspect equipment, assess location specifics (access, water, security). Minor civil/electrical works in first 2 months.</li>
                        <li><span class="font-semibold">Economic Feasibility:</span> Analyze catchment area produce volume, peak harvest times, potential utilization, and revenue. Strategies for low-usage sites.</li>
                        <li><span class="font-semibold">Social Readiness:</span> Engage community early through meetings to gauge interest, address concerns, and integrate existing user groups.</li>
                        <li><span class="font-semibold">Institutional Readiness:</span> Ensure RMC resolutions/letters, formal SHG bank accounts, and facilitate any local licensing/paperwork.</li>
                        <li><span class="font-semibold">"Green Signal" Checklist:</span> District coordinator and central team verification before moving to next phase.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🎓</span> Capacity Building of SHGs/FPOs to Operate Cold Rooms</h4>
                    <p class="text-sm text-gray-600 mb-3">A structured training and handholding program empowers local women’s groups and cooperatives to manage cold rooms as sustainable enterprises.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Cold Storage Operations:</span> Training on cold room mechanics, optimal temperatures, loading, stacking, and routine maintenance.</li>
                        <li><span class="font-semibold">Inventory Management & Mobile App:</span> Hands-on training on a mobile application (local language, visual cues, shelf-life prediction, SMS alerts).</li>
                        <li><span class="font-semibold">Customer Service & Community Engagement:</span> Soft skills, role-play, and conducting awareness sessions to become "cold chain entrepreneurs."</li>
                        <li><span class="font-semibold">Business & Financial Management:</span> Ledger maintenance, cost calculation, profit management, and understanding Cooling-as-a-Service (CaaS) model.</li>
                        <li><span class="font-semibold">Market Linkage & Quality Control:</span> Sorting, grading, packaging, negotiation, and exposure visits to markets/packhouses.</li>
                        <li><span class="font-semibold">Training Delivery:</span> 3-5 day intensive training (classroom & practical), visuals, peer learning, "train-the-trainer" approach, ongoing handholding.</li>
                        <li><span class="font-semibold">Outcomes:</span> Independent cold room management, accurate record-keeping, financial reporting, new member training, basic problem-solving.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">💰</span> Operational Support (Incentives, Working Capital, Onboarding)</h4>
                    <p class="text-sm text-gray-600 mb-3">Targeted support ensures quick operationalization and smooth running of cold rooms, especially in early stages.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Onboarding Support:</span> Guiding groups through operations plan, SOP handbook, and facilitating local kickoff events for legitimacy.</li>
                        <li><span class="font-semibold">Working Capital & Equipment Grants:</span> (Mentioned in source, implied as part of support).</li>
                        <li><span class="font-semibold">Incentive Facilitation:</span> Subsidized storage fees for farmers (e.g., free first days, promotions) and recognition for top-performing operators (acknowledgements, awards).</li>
                        <li><span class="font-semibold">Troubleshooting & Maintenance:</span> Rapid response mechanism, 48-hour issue resolution, regional technical assistants, 24x7 helpline.</li>
                        <li><span class="font-semibold">Standardizing Operating Procedures:</span> Uniform ticketing, daily sanitation routines, random checks for consistency and mentorship.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">📢</span> Awareness and Outreach Campaigns</h4>
                    <p class="text-sm text-gray-600 mb-3">Vigorous campaigns ensure farmers and market actors are informed and motivated to utilize the cold room facilities.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Local Launch Events:</span> Inaugurations with farmers, traders, demonstrations, and testimonials.</li>
                        <li><span class="font-semibold">Print Materials:</span> Simple, pictorial flyers/posters in local languages distributed widely.</li>
                        <li><span class="font-semibold">Village & Market Outreach:</span> Mobile announcements, info desks at weekly haats, collaboration with agri-input dealers.</li>
                        <li><span class="font-semibold">Mass Media & Digital:</span> Community radio, low-cost WhatsApp campaigns (explainer videos, infographics), engaging local influencers.</li>
                        <li><span class="font-semibold">School & Community Integration:</span> Competitions on food waste, SHG operators as community leaders.</li>
                        <li><span class="font-semibold">Continuous Promotion:</span> Sustained outreach, intensification before harvests, sharing success stories.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🔗</span> Market Linkage Facilitation with Bulk Buyers</h4>
                    <p class="text-sm text-gray-600 mb-3">A core objective is to help farmers realize better prices and assured sales by facilitating connections with bulk buyers.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Identifying Bulk Buyers:</span> Mapping potential purchasers (retail chains, institutions, processors, city wholesale markets).</li>
                        <li><span class="font-semibold">Buyer MoUs & Aggregation:</span> Facilitating agreements, scheduling pickups, cold room as collection point, exploring transport solutions (e.rickshaw).</li>
                        <li><span class="font-semibold">Market Price Info & Decision Making:</span> Mobile application for market intelligence (prices, trends), tailored advice to operators/farmers.</li>
                        <li><span class="font-semibold">Facilitating Transactions:</span> Overseeing initial sales, quality checks, payment flow (direct to SHG/FPO), dispute resolution.</li>
                        <li><span class="font-semibold">Building Sustainable Supply Chains:</span> Institutionalizing linkages, meeting buyer preferences, basic value addition, targeting 2-3 regular buyers per site.</li>
                        <li><span class="font-semibold">Volume Targets:</span> Setting and tracking targets for produce sold via bulk linkages, troubleshooting lagging sites.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">📱</span> Digital Integration: Data Tracking, App, & Dashboards</h4>
                    <p class="text-sm text-gray-600 mb-3">Digital tools enhance efficiency, transparency, and decision-making, transforming cold rooms into data-driven hubs.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Mobile application Deployment:</span> Primary tool for inventory/operations, linked to IoT sensors, real-time logging, shelf-life prediction, SMS notifications.</li>
                        <li><span class="font-semibold">Data Dashboards:</span> Cloud-based system aggregating key metrics (utilization, farmers served, volume, turnover, issues) for managers and stakeholders.</li>
                        <li><span class="font-semibold">Decision Support & Alerts:</span> Automated alerts for temperature deviations, low utilization, or full capacity to trigger interventions.</li>
                        <li><span class="font-semibold">Integration with Government Systems:</span> Coordinating with Horticulture MIS for continuity and impact evaluation.</li>
                        <li><span class="font-semibold">Farmer Interface:</span> Basic phone list, web links/SMS query system for tech-savvy farmers, SHG/NGO as info conduits for others.</li>
                        <li><span class="font-semibold">Data Privacy & Ownership:</span> Secure storage, project partner ownership, consent for farmer data, anonymized donor reports.</li>
                    </ul>
                    <p class="text-md text-center mt-6 font-semibold" style="color: #4CAF50;">
                        Digital integration is a game-changer, streamlining operations, providing sophisticated analytics, and building transparency and accountability across the project.
                    </p>
                </div>
            </div>
        </section>

        <section>
            <h3 class="section-title text-3xl text-center mb-8">📚 Communication Materials & Documentation: Sharing Knowledge & Impact 📚</h3>
            <p class="text-center text-lg mb-8">Koel Fresh will lead the creation of a comprehensive suite of communication materials to educate, motivate, and share learnings, serving both operational and stakeholder engagement needs.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                <div class="component-card">
                    <h4><span class="icon">📖</span> Training Manuals and SOP Guides</h4>
                    <p class="text-sm text-gray-600 mb-3">User-friendly manuals and quick reference guides ensure operators have essential information for daily cold room management.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Operator’s Handbook:</span> In Odia and English, with step-by-step procedures, troubleshooting, safety, and support contacts. Heavily illustrated for semi-literate users.</li>
                        <li><span class="font-semibold">Quick Reference Posters:</span> For cold room/office walls, listing daily checklists, produce-specific storage tips, and operational flowcharts.</li>
                        <li><span class="font-semibold">Mobile application How-To Guide:</span> Laminated sheet/booklet with screenshots and local language captions for app navigation.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">📣</span> Awareness and Promotional Materials</h4>
                    <p class="text-sm text-gray-600 mb-3">Attractive and targeted materials to inform farmers and market actors about the cold room facilities and their benefits.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Flyers and Brochures:</span> Pictorial, in local languages, with project branding, fees, and contact details. Tri-fold brochures for formal settings.</li>
                        <li><span class="font-semibold">Posters and Banners:</span> Large format, consistent visual identity (e.g., mascot), used at events and as site signage.</li>
                        <li><span class="font-semibold">Video Content:</span> Short explainer videos for farmers, testimonials from women operators, and training videos demonstrating operational steps.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">📝</span> Case Studies and Documentation</h4>
                    <p class="text-sm text-gray-600 mb-3">Compiling notable successes and challenges into narrative case studies to share learnings and demonstrate impact.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Farmer Success Story:</span> Highlighting income increase due to cold storage, with before/after data and quotes.</li>
                        <li><span class="font-semibold">Women SHG Empowerment Story:</span> Detailing capacity building, improved livelihoods, and gender impact.</li>
                        <li><span class="font-semibold">Technical Innovation Story:</span> Explaining digital integration (mobile application) and data-driven decision-making.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">📊</span> Progress Reports and Slide Decks</h4>
                    <p class="text-sm text-gray-600 mb-3">Concise and polished reports and presentations to keep government officials and donors engaged and informed of progress.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Weekly/Quarterly Decks:</span> Highlighting progress in numbers, field stories, and qualitative updates.</li>
                        <li><span class="font-semibold">Data Visualization:</span> Visualizing dashboard data, utilization trends, and overall project narrative.</li>
                        <li><span class="font-semibold">Consistent Format:</span> Ensuring easy trend spotting and alignment with global reporting best practices.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🗣️</span> Multilingual and Culturally Adapted Materials</h4>
                    <p class="text-sm text-gray-600 mb-3">Ensuring materials are translated and culturally adapted to resonate with diverse local communities, including tribal regions.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Translation:</span> Materials in Odia and local tribal languages where applicable.</li>
                        <li><span class="font-semibold">Cultural Adaptation:</span> Incorporating local symbols or references to ensure messaging is respectful and relatable.</li>
                        <li><span class="font-semibold">Local Collaboration:</span> Working with NGO partners to ensure effective communication and community resonance.</li>
                    </ul>
                </div>
            </div>
            <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">
                By developing high-quality, consistent, and culturally relevant communication materials, the project builds credibility, fosters trust, and ensures widespread understanding and sustained engagement among all stakeholders.
            </p>
        </section>

        <section>
            <h3 class="section-title text-3xl text-center mb-8">📈 Monitoring, Evaluation & Reporting: Tracking Impact & Progress 📈</h3>
            <p class="text-center text-lg mb-8">Robust monitoring and reporting mechanisms are in place to track implementation, measure outcomes, and inform decision-making, ensuring accountability and real-time course correction.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                <div class="component-card">
                    <h4><span class="icon">📊</span> Weekly Dashboard Reporting</h4>
                    <p class="text-sm text-gray-600 mb-3">Weekly updated dashboards summarize key performance indicators for each site and district, keeping the project team and government informed and maintaining momentum.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Key Indicators:</span> Cold room utilization rate, number of farmers/vendors (gender disaggregated), volume stored/sold, spoilage instances, income earned (SHG/FPO & farmers), downtime/technical issues.</li>
                        <li><span class="font-semibold">Routine Review Calls:</span> Brief virtual meetings to discuss dashboard, flag red flags, and share quick wins.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🗓️</span> Monthly Review Meetings and Slide Decks</h4>
                    <p class="text-sm text-gray-600 mb-3">Comprehensive monthly reviews at state and district levels, using slide decks to highlight cumulative progress, targets, and qualitative insights.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Slide Deck Content:</span> Cumulative progress, comparison against targets, qualitative insights, charts (utilization trends, income increase), field photos, component updates.</li>
                        <li><span class="font-semibold">Review Forums:</span> State Steering Committee (with DoH & Delivery Associates) and District Working Group (chaired by Collector).</li>
                    </ul>
                </div>

                <div class="component-card md:col-span-2">
                    <h4><span class="icon">🎯</span> Key Performance Indicators (KPIs)</h4>
                    <p class="text-sm text-gray-600 mb-3">Specific KPIs are tracked to measure project success against its core objectives.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <ul class="space-y-2">
                            <li><span class="icon">📊</span> <span class="font-semibold">Cold Room Utilization:</span> Target $\ge$ 70% average by year-end (higher during peak seasons).</li>
                            <li><span class="icon">💰</span> <span class="font-semibold">Farmer Income Increase:</span> Aim for 20-30% increase in average selling price for participating farmers (via surveys).</li>
                            <li><span class="icon">👩‍👧‍👦</span> <span class="font-semibold">SHG/Operator Income:</span> Target $\ge$ INR 5,000 net income per month per group by Month 12 for sustainable profit.</li>
                        </ul>
                        <ul class="space-y-2">
                            <li><span class="icon">🗑️</span> <span class="font-semibold">Post-Harvest Loss Reduction:</span> Estimate reduction in waste/spoilage (aim for 75% reduction, similar to Rourkela pilot).</li>
                            <li><span class="icon">🔗</span> <span class="font-semibold">Market Linkage Volume and Value:</span> Total quantity/revenue from produce sold to bulk/institutional buyers (indicating market access improvement).</li>
                            <li><span class="icon">✅</span> <span class="font-semibold">Operational Sustainability:</span> Percentage of operating costs covered by revenues at each site by year-end (aim for basic expenses covered).</li>
                            <li><span class="icon">👥</span> <span class="font-semibold">Participation Metrics:</span> Number of women SHG members actively involved/trained, youth employed (additional social indicators).</li>
                        </ul>
                    </div>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🚶‍♀️</span> Monitoring Visits</h4>
                    <p class="text-sm text-gray-600 mb-3">Regular field monitoring visits by Koel Fresh and government officials ensure oversight, data verification, and direct interaction with beneficiaries.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Frequency:</span> At least once a quarter for each district (joint site visits).</li>
                        <li><span class="font-semibold">Activities:</span> Observe operations, interact with farmers/SHG members, verify data (e.g., cross-check digital records with physical stock).</li>
                        <li><span class="font-semibold">Donor Involvement:</span> Anticipate and prepare for visits from donor representatives to showcase progress.</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4><span class="icon">🔄</span> Mid-Term Evaluation</h4>
                    <p class="text-sm text-gray-600 mb-3">An internal evaluation around the 6-month mark assesses progress against midline targets and informs mid-course corrections.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Process:</span> Survey sample of farmers and all SHG operators to gauge satisfaction, difficulties, and suggestions.</li>
                        <li><span class="font-semibold">Evaluation:</span> Against midline targets (e.g., ~50% of end target for KPIs).</li>
                        <li><span class="font-semibold">Outcome:</span> Mid-course correction plan if components are lagging (e.g., market linkage weakness).</li>
                    </ul>
                </div>

                <div class="component-card md:col-span-2">
                    <h4><span class="icon">📝</span> Final Evaluation and Reporting</h4>
                    <p class="text-sm text-gray-600 mb-3">A comprehensive year-end evaluation measures overall impact, compiles a master report, and informs future scale-up and funding.</p>
                    <ul class="space-y-2">
                        <li><span class="font-semibold">Process:</span> Comprehensive evaluation, potentially with external agency or Delivery Associates experts for objectivity.</li>
                        <li><span class="font-semibold">Master Report:</span> Details activities, KPI data, impact case studies, lessons learned.</li>
                        <li><span class="font-semibold">Purpose:</span> Informs Odisha government for scale-up and Bloomberg/donors for future funding.</li>
                        <li><span class="font-semibold">Visuals:</span> Uses dashboard visuals and field stories (e.g., X tons stored, Y farmers served, Z income increase, P tons saved).</li>
                    </ul>
                </div>
            </div>

            <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">
                The M&E system serves as both an accountability exercise and a management tool, rigorously tracking performance to demonstrate success (improved farmer income, women's empowerment) with evidence, and ensuring prompt problem-solving.
            </p>
        </section>

        <section>
            <h3 class="section-title text-3xl text-center mb-8">⚠️ Risk Management: Proactive Mitigation for Success ⚠️</h3>
            <p class="text-center text-lg mb-8">A proactive risk management strategy is central to ensuring smooth implementation, sustainability, and long-term success of the cold room ecosystem, anticipating and addressing potential challenges.</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
                <div class="risk-card">
                    <h4><span class="icon">⚙️</span> Operational Risks</h4>
                    <p class="text-sm text-gray-600 mb-3">Risks related to the day-to-day running of cold rooms and adherence to operational standards.</p>
                    <h5>Potential Issues:</h5>
                    <ul>
                        <li>Inconsistent cold room operation (limited local capacity, process lapses).</li>
                        <li>Improper produce handling (damage, spoilage, customer dissatisfaction).</li>
                        <li>Lack of adherence to SOPs or poor record-keeping by operators.</li>
                    </ul>
                    <h5>Mitigation Strategies:</h5>
                    <ul>
                        <li>Regular site visits by Koel Fresh field coordinators for assessment and issue resolution.</li>
                        <li>Weekly checklists for cleanliness, power, equipment, and user records.</li>
                        <li>Implement local language SOPs, accessible at each site.</li>
                        <li>Continuous mentoring and handholding for SHG/FPO operators (initial 6-8 months).</li>
                        <li>Utilize mobile application for real-time inventory, operational alerts, and user tracking.</li>
                    </ul>
                </div>

                <div class="risk-card">
                    <h4><span class="icon">📉</span> Market Risks</h4>
                    <p class="text-sm text-gray-600 mb-3">Challenges related to connecting stored produce with profitable markets and managing price volatility.</p>
                    <h5>Potential Issues:</h5>
                    <ul>
                        <li>Inability to connect stored produce with reliable markets in time.</li>
                        <li>Price fluctuations or oversupply affecting farmer revenue.</li>
                        <li>Over-dependence on a single buyer or market channel.</li>
                    </ul>
                    <h5>Mitigation Strategies:</h5>
                    <ul>
                        <li>Establish multiple market linkages per site (local traders, institutions, government, retail, processors).</li>
                        <li>Provide price intelligence and market demand info via a mobile application and field updates.</li>
                        <li>Facilitate forward purchase agreements or informal buy-back commitments.</li>
                        <li>Develop value-addition/aggregation models (packaging, branding, cold room-based vending) for income diversification.</li>
                    </ul>
                </div>

                <div class="risk-card">
                    <h4><span class="icon">🔌</span> Technical Risks</h4>
                    <p class="text-sm text-gray-600 mb-3">Threats related to equipment malfunction and the technical capacity to address them.</p>
                    <h5>Potential Issues:</h5>
                    <ul>
                        <li>Breakdowns in refrigeration, IoT, or solar equipment leading to storage failures.</li>
                        <li>Lack of technical knowledge among operators to identify or report issues.</li>
                        <li>Delays in repairs due to absence of maintenance contracts or spare parts.</li>
                    </ul>
                    <h5>Mitigation Strategies:</h5>
                    <ul>
                        <li>New solar cold rooms (10 units) come with 5-year maintenance contract by OREDA/vendors.</li>
                        <li>Map and onboard local refrigeration technicians in each district for rapid response.</li>
                        <li>Maintain a preventive maintenance calendar and checklist for operators.</li>
                        <li>Provide basic troubleshooting training to SHG/FPO members for early issue escalation.</li>
                        <li>Integrate IoT and temperature monitoring tools to flag anomalies and ensure data visibility.</li>
                    </ul>
                </div>

                <div class="risk-card">
                    <h4><span class="icon">💸</span> Financial Risks</h4>
                    <p class="text-sm text-gray-600 mb-3">Concerns regarding the financial viability and management of cold room operations by local groups.</p>
                    <h5>Potential Issues:</h5>
                    <ul>
                        <li>Low utilization in early months may not cover basic operating costs.</li>
                        <li>SHGs/FPOs may lack liquidity for operations (transport, packaging).</li>
                        <li>Poor financial management or record-keeping (misuse/underreporting of funds).</li>
                    </ul>
                    <h5>Mitigation Strategies:</h5>
                    <ul>
                        <li>Provide interest-free working capital grants at the beginning for startup costs.</li>
                        <li>Introduce performance-based incentives (rewards for high utilization, timely reporting).</li>
                        <li>Link SHGs/FPOs with banking partners via OLM/ORMAS for revolving funds/loans.</li>
                        <li>Train operators in basic bookkeeping/financial literacy; regular audits/record checks by Koel Fresh.</li>
                        <li>Enable digital receipts and payment records via a mobile apps for transparency.</li>
                    </ul>
                </div>
            </div>
            <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">
                These comprehensive measures ensure that common risks across operations, markets, technology, and finance are anticipated early, with mitigation plans embedded into the project design, supported by risk dashboards and escalation protocols.
            </p>
        </section>

        <section>
            <h3 class="section-title text-3xl text-center mb-8">🏁 Conclusion & Sustainability Roadmap: Long-Term Impact 🏁</h3>
            <p class="text-center text-lg mb-8">The cold room ecosystem initiative, led by Koel Fresh and anchored within the Bloomberg Cities Idea Exchange, is designed not only to address immediate post-harvest challenges but also to lay the foundation for long-term, community-driven agricultural resilience in Odisha.</p>

            <div class="mb-10">
                <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Expected Outcomes: One-Year Impact</h4>
                <p class="text-md text-center mb-6">By the end of the one-year implementation cycle, the project aims to deliver significant, measurable improvements across key areas.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="component-card">
                        <h4><span class="icon">📈</span> Increased Farmer Income</h4>
                        <ul class="space-y-1">
                            <li>Farmers gain ability to store and delay sales until market prices are favorable.</li>
                            <li>Enhanced bargaining power through aggregation and market linkages.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">📉</span> Reduction in Post-Harvest Losses (Target ~75%)</h4>
                        <ul class="space-y-1">
                            <li>Temperature-controlled preservation for perishables (tomato, chili, banana, leafy vegetables).</li>
                            <li>More produce reaches market in sellable condition, reducing economic loss.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">👩‍👧‍👦</span> Empowerment & Financial Sustainability for SHGs/FPOs</h4>
                        <ul class="space-y-1">
                            <li>Women’s SHGs and FPOs trained as business entities, gaining confidence and income.</li>
                            <li>Operational profits and institutional support build entrepreneurial capacity.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">🤝</span> Robust Market Linkages</h4>
                        <ul class="space-y-1">
                            <li>Structured relationships with institutional buyers ensure predictable sales.</li>
                            <li>Cold rooms serve as aggregation hubs, reducing intermediaries and increasing market access.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="mb-10">
                <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Sustainability Beyond Project Timeline: Long-Term Vision</h4>
                <p class="text-md text-center mb-6">A key goal is for the ecosystem to continue functioning independently after the initial year, supported by local ownership, robust systems, and sustainable revenue streams.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="component-card">
                        <h4><span class="icon"> autonomy </span> SHGs/FPOs Managing Cold Rooms Independently</h4>
                        <ul class="space-y-1">
                            <li>Community groups capable of handling operations, maintenance, user coordination, and customer service.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">🔗</span> Institutionalized Market Relationships</h4>
                        <ul class="space-y-1">
                            <li>Ongoing tie-ups with buyers ensure long-term demand assurance for cold room users.</li>
                            <li>Creates steady income flow and keeps infrastructure in use.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">📱</span> Digital Tools Enabling Operational Efficiency</h4>
                        <ul class="space-y-1">
                            <li>Mobile application provides real-time data on inventory, temperature, utilization, and financials.</li>
                            <li>Ensures data-driven decision making, performance monitoring, and transparent reporting.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="mb-10">
                <h4 class="font-semibold text-2xl mb-4 text-center" style="color: #4CAF50;">Future Recommendations: Scaling & Integration</h4>
                <p class="text-md text-center mb-6">To build on the success of the pilot phase, the following actions are recommended for broader impact and long-term viability.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="component-card">
                        <h4><span class="icon">🌍</span> Geographic Expansion into Additional Districts</h4>
                        <ul class="space-y-1">
                            <li>Replicate model in other horticulture-intensive districts.</li>
                            <li>Target areas with high distress selling, no current cold storage, or strong SHG/FPO presence.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">🌍</span> National and Global Replication</h4>
                        <ul class="space-y-1">
                            <li>Showcase best practices and impact data to inspire adoption by other cities.</li>
                            <li>Present model on global platforms (e.g., COP, C40 Cities, GCF, SEforALL).</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">🌍</span> Integration with Government Programs</h4>
                        <ul class="space-y-1">
                            <li>Align with national schemes (PMFME, MIDH) and state APC programs for convergence and co-funding.</li>
                        </ul>
                    </div>
                    <div class="component-card">
                        <h4><span class="icon">🌍</span> Knowledge Dissemination</h4>
                        <ul class="space-y-1">
                            <li>Develop toolkits, SOPs, and training modules for other implementing partners.</li>
                            <li>Document institutional structures, pricing models, and digital tools to ease scale-up.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <p class="text-center text-lg mt-10 font-semibold" style="color: #1B5E20;">
                This roadmap ensures the project evolves beyond a standalone pilot, becoming a replicable, community-owned model for sustainable agriculture and women-led enterprise, rooted in decentralized governance and digital transparency.
            </p>
        </section>
</div>
    </main>
    <footer class="text-center mt-12 py-8 border-t-2 border-gray-200">
        <p style="color: #333333;">Driving sustainable agricultural practices and economic empowerment in Odisha.</p>
        <p class="text-sm mt-2" style="color: #1B5E20;">Bloomberg Cities Idea Exchange - Economic Vulnerability Project</p>
    </footer>
  </div> 
    `;

    const infographicPageChartScript = `
        function wrapLabels(label, maxLength = 16) { if (typeof label !== 'string') return label; if (label.length <= maxLength) return label; const words = label.split(' '); const lines = []; let currentLine = ''; for (const word of words) { if ((currentLine + word).length > maxLength && currentLine.length > 0) { lines.push(currentLine.trim()); currentLine = word + ' '; } else { currentLine += word + ' '; } } if (currentLine.trim().length > 0) lines.push(currentLine.trim()); return lines.length > 0 ? lines : [label]; }
        if (typeof Chart !== 'undefined' && document.getElementById('sitesChart')) { const sitesChartCtx = document.getElementById('sitesChart').getContext('2d'); new Chart(sitesChartCtx, { type: 'doughnut', data: { labels: [wrapLabels('Existing Cold Storage Installations'), wrapLabels('Brand New Upcoming Installations')], datasets: [{ label: 'Site Distribution', data: [31, 10], backgroundColor: ['#4CAF50', '#FFC107'], borderColor: ['#FFFFFF', '#FFFFFF'], borderWidth: 2 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { font: { size: 12, family: 'Open Sans' }, color: '#333333', padding: 15, boxWidth: 15 } }, tooltip: { backgroundColor: '#333333', titleFont: { size: 14, family: 'Montserrat', weight: 'bold' }, bodyFont: { size: 12, family: 'Open Sans' }, padding: 10, callbacks: { title: function(tooltipItems) { const item = tooltipItems[0]; let label = item.chart.data.labels[item.dataIndex]; return Array.isArray(label) ? label.join(' ') : label; } } } } } }); } else { console.error("Chart.js is not defined or canvas not found."); }
    `;

    const planGanttHTML = `
      <!DOCTYPE html>
      <html lang="en">
      <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Gantt Chart</title>
          <script src="https://cdn.tailwindcss.com"><\/script>
          <link rel="preconnect" href="https://fonts.googleapis.com">
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
          <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
          <style>
            body { font-family: 'Inter', sans-serif; background-color: #f9f9f9; color: #334155; padding: 20px 0; display: flex; flex-direction: column; height: 98vh; }
            .chart-scroll-wrapper { overflow: auto; flex-grow: 1; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid #ddd; position: relative; }
            .gantt-chart-container { width: fit-content; background-color: #ffffff; padding: 20px; }
            .gantt-header { font-weight: bold; background-color: #e0e0e0; padding: 10px 5px; border-radius: 8px; margin-bottom: 10px; display: flex; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            .gantt-row { display: flex; align-items: center; padding: 8px 5px; border-bottom: 1px solid #e2e8f0; position: relative; background-color: #ffffff; z-index: 20; }
            .gantt-row-main-category { 
              font-weight: bold;
              color: #1B5E20;
              background-color: #dcfce7 !important;
              padding: 0.75rem;
              text-align: left;
              margin-top: 1rem;
              border-radius: 0.5rem;
            }
            .gantt-row-category { background-color: #f0fdf4; font-weight: bold; color: #1B5E20; }
            .serial-number { flex-shrink: 0; width: 50px; text-align: center; font-size: 0.85em; color: #64748b; position: sticky; left: 0; z-index: 50; box-shadow: 2px 0 3px rgba(0,0,0,0.05); background-color: inherit; }
            .task-name { flex-shrink: 0; width: 300px; font-size: 0.9em; word-wrap: break-word; padding-right: 10px; position: sticky; left: 50px; z-index: 50; box-shadow: 2px 0 3px rgba(0,0,0,0.05); background-color: inherit; }
            .gantt-header .serial-number, .gantt-header .task-name { background-color: #e0e0e0; box-shadow: none; z-index: 101; }
            .timeline { flex-grow: 1; display: grid; grid-template-columns: repeat(17, minmax(75px, 1fr)); gap: 2px; align-items: center; position: relative; }
            .month-header { text-align: center; font-size: 0.8em; color: #475569; padding-bottom: 2px; }
            .year-header { text-align: center; font-size: 0.7em; color: #64748b; }
            .timeline-grid-bg { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: grid; grid-template-columns: repeat(17, minmax(75px, 1fr)); gap: 2px; z-index: 5; }
            .timeline-grid-bg > div { border-right: 1px solid #e2e8f0; }
            .gantt-header .timeline > div { border-right: 1px solid #d1d5db; }
            .gantt-header .timeline > div:last-child { border-right: none; }
            .task-bar { background-color: #4CAF50; height: 20px; border-radius: 5px; position: relative; z-index: 10; cursor: grab; display: flex; justify-content: space-between; align-items: center; min-width: 20px; }
            .resize-handle { width: 8px; height: 100%; background-color: rgba(255,255,255,0.4); border-radius: 2px; cursor: ew-resize; z-index: 20; }
            .resize-handle.left { border-top-left-radius: 5px; border-bottom-left-radius: 5px; }
            .resize-handle.right { border-top-right-radius: 5px; border-bottom-right-radius: 5px; }
          </style>
      </head>
      <body>
          <div class="chart-scroll-wrapper">
              <div class="gantt-chart-container">
                  <div class="gantt-header rounded-lg">
                      <div class="serial-number px-2 text-slate-700">No.</div>
                      <div class="task-name px-2 text-slate-700">Workstreams, Sub-Workstreams, and Deliverables</div>
                      <div class="timeline">
                          <div class="text-center"><div class="month-header">May</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">June</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">July</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">August</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">September</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">October</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">November</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">December</div><div class="year-header">2025</div></div><div class="text-center"><div class="month-header">January</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">February</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">March</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">April</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">May</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">June</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">July</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">August</div><div class="year-header">2026</div></div><div class="text-center"><div class="month-header">September</div><div class="year-header">2026</div></div>
                      </div>
                  </div>
                  <div id="gantt-rows-container">
                  </div>
              </div>
          </div>
          <script>
            document.addEventListener('DOMContentLoaded', () => {
                const scriptURL = 'https://script.google.com/macros/s/AKfycbyoLTLQaMjJXBnN3luRiscIiOM1fnYEcpfUY3yLmWAICTGhkU8DOukytwfB-yh8sJUMwQ/exec';

                function renderGanttRows(ganttData) {
                    const container = document.getElementById('gantt-rows-container');
                    container.innerHTML = '';
                    ganttData.forEach(item => {
                        const row = document.createElement('div');
                        let innerHTML = '';
                         if (item.type === 'main-category') {
                             row.className = 'gantt-row-main-category';
                             innerHTML = item.name;
                        } else {
                            row.className = 'gantt-row';
                            if (item.type === 'category') {
                                row.classList.add('gantt-row-category');
                                innerHTML = \`<div class="serial-number"></div><div class="task-name px-2 pl-6">\${item.name}</div><div class="timeline"><div class="task-bar" data-task-name="\${item.name}" data-start-month="\${item.start}" data-end-month="\${item.end}"><div class="resize-handle left"></div><div class="resize-handle right"></div></div></div>\`;
                            } else { 
                                innerHTML = \`<div class="serial-number"></div><div class="task-name px-2 pl-8">\${item.name}</div><div class="timeline"><div class="task-bar" data-task-name="\${item.name}" data-start-month="\${item.start}" data-end-month="\${item.end}"><div class="resize-handle left"></div><div class="resize-handle right"></div></div></div>\`;
                            }
                        }
                        row.innerHTML = innerHTML;
                        container.appendChild(row);
                    });
                    initializeGantt();
                }

                function initializeGantt() {
                    document.querySelectorAll('.gantt-row .timeline').forEach(timeline => {
                        if (timeline.querySelector('.timeline-grid-bg')) return;
                        const bgGrid = document.createElement('div');
                        bgGrid.classList.add('timeline-grid-bg');
                        for(let i=0; i<17; i++) {
                            const lineCell = document.createElement('div');
                            bgGrid.appendChild(lineCell);
                        }
                        timeline.prepend(bgGrid);
                    });
                    
                    const assignSerialNumbers = () => {
                        const rowsToNumber = document.querySelectorAll('.gantt-row:not(.gantt-row-main-category)');
                        let serialNum = 1;
                        rowsToNumber.forEach(row => {
                            const serialNumDiv = row.querySelector('.serial-number');
                            if (serialNumDiv) serialNumDiv.textContent = serialNum++;
                        });
                    };
                    assignSerialNumbers();

                    const initializeTaskBars = () => {
                        document.querySelectorAll('.task-bar').forEach(bar => {
                            updateTaskBarPosition(bar);
                            attachDragListeners(bar);
                        });
                    };

                    const updateTaskBarPosition = (bar) => {
                        const startMonth = parseInt(bar.dataset.startMonth);
                        const endMonth = parseInt(bar.dataset.endMonth);
                        bar.style.gridColumn = \`\${startMonth} / \${endMonth}\`;
                    };

                    const attachDragListeners = (bar) => {
                        let isDragging = false, dragType = '', initialMouseX = 0, initialStartMonth = 0, initialEndMonth = 0;
                        const timeline = bar.closest('.timeline');
                        if (!timeline) return;
                        let monthColumnWidth = timeline.offsetWidth / 17;

                        const onMouseDown = (e) => {
                            if (e.button !== 0) return;
                            isDragging = true;
                            initialMouseX = e.clientX;
                            initialStartMonth = parseInt(bar.dataset.startMonth);
                            initialEndMonth = parseInt(bar.dataset.endMonth);
                            monthColumnWidth = timeline.offsetWidth / 17;
                            dragType = e.target.classList.contains('resize-handle') ? (e.target.classList.contains('left') ? 'left' : 'right') : 'move';
                            bar.style.cursor = 'grabbing';
                            document.body.style.userSelect = 'none';
                            document.addEventListener('mousemove', onMouseMove);
                            document.addEventListener('mouseup', onMouseUp);
                            e.preventDefault();
                        };

                        const onMouseMove = (e) => {
                            if (!isDragging) return;
                            const deltaX = e.clientX - initialMouseX;
                            const colDelta = Math.round(deltaX / monthColumnWidth);
                            let newStart = initialStartMonth, newEnd = initialEndMonth;
                            const duration = initialEndMonth - initialStartMonth;
                            
                            if (dragType === 'left') {
                                newStart = Math.max(1, Math.min(initialEndMonth - 1, initialStartMonth + colDelta));
                            } else if (dragType === 'right') {
                                newEnd = Math.min(18, Math.max(initialStartMonth + 1, initialEndMonth + colDelta));
                            } else {
                                newStart = Math.max(1, initialStartMonth + colDelta);
                                newEnd = newStart + duration;
                                if (newEnd > 18) { newStart = 18 - duration; newEnd = 18; }
                            }
                            bar.dataset.startMonth = newStart;
                            bar.dataset.endMonth = newEnd;
                            updateTaskBarPosition(bar);
                        };

                        const onMouseUp = () => {
                            isDragging = false;
                            bar.style.cursor = 'grab';
                            document.body.style.userSelect = '';
                            document.removeEventListener('mousemove', onMouseMove);
                            document.removeEventListener('mouseup', onMouseUp);
                            updateTaskInSheet(bar.dataset.taskName, bar.dataset.startMonth, bar.dataset.endMonth);
                        };
                        bar.addEventListener('mousedown', onMouseDown);
                    };
                    initializeTaskBars();
                }
                
                function updateTaskInSheet(taskName, startMonth, endMonth) {
                  const payload = {
                      action: 'update_gantt_task',
                      taskName: taskName,
                      startMonth: startMonth,
                      endMonth: endMonth
                  };
                  fetch(scriptURL, { 
                      method: 'POST', 
                      body: JSON.stringify(payload),
                      headers: { 'Content-Type': 'application/json' },
                      mode: 'no-cors' 
                  })
                    .then(() => console.log('Gantt update sent.'))
                    .catch(error => console.error('Error saving Gantt update:', error));
                }

                fetch(scriptURL + '?action=get_gantt_tasks&sheetName=GanttChart')
                    .then(res => res.json())
                    .then(data => {
                        if (!Array.isArray(data) || data.length < 1) {
                            console.error("Gantt data from sheet is invalid or empty.");
                            return;
                        }
                        const ganttData = data.slice(1).map(row => ({
                            name: row[0],
                            type: row[1],
                            start: parseInt(row[2]),
                            end: parseInt(row[3])
                        }));
                        renderGanttRows(ganttData);
                    })
                    .catch(error => console.error('Error fetching Gantt data:', error));

            });
          <\/script>
      </body>
      </html>
    `;

    const progressPageHTML = `
  <div id="progress-container" class="p-1">
    <div class="bg-white shadow-lg rounded-lg overflow-hidden">
      <div id="filter-controls" class="p-1 bg-gray-100 border-b border-gray-200 flex flex-wrap gap-x-1 gap-y-1 justify-center text-xs">
        <label class="flex items-center space-x-1 cursor-pointer"><input type="checkbox" data-ws="ws-op-excellence"><span>Operational Excellence</span></label>
        <label class="flex items-center space-x-1 cursor-pointer"><input type="checkbox" data-ws="ws-revenue-div"><span>Revenue Diversification</span></label>
        <label class="flex items-center space-x-1 cursor-pointer"><input type="checkbox" data-ws="ws-farmer-vendor"><span>Farmer & Vendor Engagement</span></label>
        <label class="flex items-center space-x-1 cursor-pointer"><input type="checkbox" data-ws="ws-mentorship-skill"><span>Operator Mentorship & Skill Building</span></label>
        <label class="flex items-center space-x-1 cursor-pointer"><input type="checkbox" data-ws="ws-gov-stakeholder"><span>Project Governance & Stakeholder Engagement</span></label>
      </div>
      <div id="progress-table-container" class="table-container overflow-x-auto">
        <table id="progress-table">
          <thead>
          </thead>
          <tbody id="table-body">
          </tbody>
        </table>
      </div>
    </div>
  </div>
`;

    // --- UI & NAVIGATION ---
    function showLoading() {
      document.getElementById('loadingIndicator').style.display = 'block';
    }

    function hideLoading() {
      document.getElementById('loadingIndicator').style.display = 'none';
    }

    function showMessage(message, isConfirm = false, onConfirm = null) {
      const overlay = document.getElementById('customMessageBoxOverlay');
      const textEl = document.getElementById('customMessageText');
      const confirmBtn = document.getElementById('customMessageConfirm');
      const cancelBtn = document.getElementById('customMessageCancel');
      if (!overlay || !textEl || !confirmBtn || !cancelBtn) {
        alert(message);
        if (isConfirm && onConfirm) onConfirm();
        return;
      }
      textEl.textContent = message;
      window.confirmCallback = onConfirm;
      confirmBtn.textContent = isConfirm ? 'Confirm' : 'OK';
      cancelBtn.style.display = isConfirm ? 'inline-block' : 'none';
      overlay.classList.add('active');
    }

    function showHomePage() {
      showLoading();
      document.body.className = 'infographic-active';

      document.getElementById('tracker-content-area').style.display = 'none';
      document.getElementById('plan-section').style.display = 'none';
      document.getElementById('progress-section').style.display = 'none';
      const infographicContentArea = document.getElementById('infographic-content-area');

      if (!infographicContentArea.innerHTML.trim()) {
        infographicContentArea.innerHTML = infographicPageBodyHTML;
      }
      infographicContentArea.style.display = 'block';

      const initializeChart = () => {
        setTimeout(() => {
          if (typeof Chart !== 'undefined' && document.getElementById('sitesChart')) {
            const canvas = document.getElementById('sitesChart');
            const existingChart = Chart.getChart(canvas);
            if (existingChart) {
              existingChart.destroy();
            }
            const chartInitScript = document.createElement('script');
            chartInitScript.textContent = infographicPageChartScript;
            document.body.appendChild(chartInitScript).remove();
            hideLoading();
          } else {
            hideLoading();
          }
        }, 100);
      };

      let chartJsScript = document.head.querySelector('script[src="https://cdn.jsdelivr.net/npm/chart.js"]');
      if (chartJsScript && typeof Chart !== 'undefined') {
        initializeChart();
      } else if (!chartJsScript) {
        chartJsScript = document.createElement('script');
        chartJsScript.src = "https://cdn.jsdelivr.net/npm/chart.js";
        chartJsScript.onload = initializeChart;
        chartJsScript.onerror = () => {
          console.error("Failed to load Chart.js.");
          hideLoading();
        };
        document.head.appendChild(chartJsScript);
      } else {
        hideLoading();
      }
    }

    function showSection(sectionIdToShow) {
      document.body.className = 'tracker-active';

      const allSections = ['infographic-content-area', 'tracker-content-area', 'plan-section', 'progress-section'];
      allSections.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.style.display = 'none';
      });

      const trackerSubSections = ['meetings-section', 'media-section', 'presentations-section', 'admin-section', 'repository-section'];
      let mainSectionToShow = sectionIdToShow;
      if (trackerSubSections.includes(sectionIdToShow)) {
        mainSectionToShow = 'tracker-content-area';
      }

      const elToShow = document.getElementById(mainSectionToShow);
      if (elToShow) {
        elToShow.style.display = 'block';
      }

      if (mainSectionToShow === 'tracker-content-area') {
        trackerSubSections.forEach(id => {
          const el = document.getElementById(id);
          if (el) el.style.display = (id === sectionIdToShow) ? 'block' : 'none';
        });

        if (sectionIdToShow === 'media-section') fetchMediaGallery();
        if (sectionIdToShow === 'presentations-section') fetchPresentations();
        if (sectionIdToShow === 'repository-section') fetchRepositoryData();
      }

      if (mainSectionToShow === 'plan-section') {
        const iframe = document.getElementById('plan-gantt-iframe');
        if (iframe && !iframe.getAttribute('srcdoc')) {
          iframe.srcdoc = planGanttHTML;
        }
      }
      if (mainSectionToShow === 'progress-section') {
        initializeProgressTracker();
      }
    }

    // --- ADMIN & AUTH ---
    function updateAdminUI(isLoggedIn) {
      document.querySelectorAll('.admin-only').forEach(el => {
        el.style.display = isLoggedIn ? 'inline-block' : 'none';
      });
    }

    function handleAdminNavClick() {
      if (isAdminLoggedIn) {
        isAdminLoggedIn = false;
        document.getElementById('admin-nav-button').textContent = 'Admin';
        updateAdminUI(false);
        showMessage('You have been logged out.', false);
      } else {
        showSection('admin-section');
      }
    }

    // --- DATA FETCHING & RENDERING ---
    function fetchData() {
      showLoading();
      Promise.all([
        fetch(scriptURL + '?action=get_data&sheetName=Meetings').then(res => res.json()),
        fetch(scriptURL + '?action=get_data&sheetName=Action Items').then(res => res.json())
      ]).then(([meetingsData, actionsData]) => {
        renderTable(meetingsData, 'meeting-table', 'meeting');
        renderTable(actionsData, 'action-table', 'action');
      }).catch(error => {
        console.error('Error fetching tracker data:', error);
        document.querySelector('#meeting-table tbody').innerHTML = `<tr><td colspan="10" class="error-message">Error loading meetings.</td></tr>`;
        document.querySelector('#action-table tbody').innerHTML = `<tr><td colspan="6" class="error-message">Error loading actions.</td></tr>`;
      }).finally(() => hideLoading());
    }

    function fetchPresentations() {
      const presentationsContainer = document.getElementById('presentations-display-area');
      if (!presentationsContainer) return;
      presentationsContainer.innerHTML = '<p style="text-align:center;">Loading presentations...</p>';
      showLoading();
      fetch(scriptURL + '?action=get_data&sheetName=Presentations')
        .then(res => res.json())
        .then(data => {
          if (data && data.error) throw new Error(data.error);
          const [headers, ...rows] = data;
          const uniqueIdIndex = headers.indexOf('UniqueID');
          const weekIndex = headers.indexOf('Week');
          const iframeCodeIndex = headers.indexOf('IframeCode');
          let html = '';
          if (rows.length > 1) { // Check if there are data rows beyond the header
            const groupedByWeek = rows.slice(1).reduce((acc, row) => {
              const week = row[weekIndex] || 'Uncategorized';
              if (!acc[week]) acc[week] = [];
              acc[week].push({ uniqueID: row[uniqueIdIndex], iframeCode: row[iframeCodeIndex] });
              return acc;
            }, {});
            Object.keys(groupedByWeek).sort((a, b) => (a.match(/\d+/) || [0])[0] - (b.match(/\d+/) || [0])[0]).forEach(week => {
              html += `<div class="presentation-week-group"><h3>${week}</h3>`;
              groupedByWeek[week].forEach(p => {
                const responsiveIframeCode = p.iframeCode.replace(/width="[^"]*"/ig, '').replace(/height="[^"]*"/ig, '');
                html += `<div class="presentation-item"><div class="presentation-container">${responsiveIframeCode}</div><span class="admin-only"><button class="delete-button" onclick="deletePresentation('${p.uniqueID}')">Delete</button></span></div>`;
              });
              html += `</div>`;
            });
          } else {
            html = '<p style="text-align:center; margin-top:20px;">No presentations added yet.</p>';
          }
          presentationsContainer.innerHTML = html;
          updateAdminUI(isAdminLoggedIn);
        })
        .catch(error => { presentationsContainer.innerHTML = `<p class="error-message">Error: ${error.message}</p>`; })
        .finally(() => hideLoading());
    }

    function fetchMediaGallery() {
      const mediaGalleryDiv = document.getElementById('media-gallery');
      if (!mediaGalleryDiv) return;
      mediaGalleryDiv.innerHTML = '<p style="text-align:center;">Loading media gallery...</p>';
      showLoading();
      fetch(scriptURL + '?action=get_data&sheetName=Media')
        .then(res => res.json())
        .then(data => {
          if (data && data.error) throw new Error(data.error);
          if (!Array.isArray(data) || data.length < 2) {
            mediaGalleryDiv.innerHTML = '<p style="text-align:center; margin-top:20px;">No media files have been uploaded yet.</p>';
            return;
          }
          const [headers, ...rows] = data;
          const uniqueIdIndex = headers.indexOf('UniqueID');
          const weekInfoIndex = headers.indexOf('WeekInfo');
          const zoneIndex = headers.indexOf('Zone');
          const districtIndex = headers.indexOf('District');
          const fileUrlIndex = headers.indexOf('File URL');
          const fileTypeIndex = headers.indexOf('File Type');
          const fileNameIndex = headers.indexOf('File Name');
          let html = '';
          if (rows.length > 0) {
            const grouped = rows.reduce((acc, row) => {
              const week = row[weekInfoIndex] || 'Uncategorized';
              if (!acc[week]) acc[week] = {};
              const zone = row[zoneIndex] || 'Uncategorized';
              if (!acc[week][zone]) acc[week][zone] = {};
              const district = row[districtIndex] || 'Uncategorized';
              if (!acc[week][zone][district]) acc[week][zone][district] = [];
              acc[week][zone][district].push({
                uniqueID: row[uniqueIdIndex], fileUrl: row[fileUrlIndex], fileType: row[fileTypeIndex], fileName: row[fileNameIndex]
              });
              return acc;
            }, {});
            Object.keys(grouped).sort((a, b) => (a.match(/\d+/) || [0])[0] - (b.match(/\d+/) || [0])[0]).forEach(week => {
              html += `<div class="media-week-group"><h3>${week}</h3>`;
              Object.keys(grouped[week]).sort().forEach(zone => {
                html += `<div class="mb-4"><h4 style="color:#1B5E20; padding-left: 15px;">${zone}</h4>`;
                Object.keys(grouped[week][zone]).sort().forEach(district => {
                  html += `<div class="mb-2" style="padding: 0 15px;"><h5 style="color:#388e3c;">District: ${district}</h5><div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 lg:grid-cols-5 gap-4 p-2">`;
                  grouped[week][zone][district].forEach(media => {
                    let mediaElementHtml = '';
                    const fileName = media.fileName || 'Unnamed File';
                    if (media.fileType && media.fileType.startsWith('image')) {
                      const driveFileIdMatch = media.fileUrl.match(/(?:id=|\/d\/)([a-zA-Z0-9_-]+)/);
                      const driveFileId = driveFileIdMatch ? driveFileIdMatch[1] : null;
                      const imageUrl = driveFileId ? `https://drive.google.com/thumbnail?id=${driveFileId}&sz=w800` : 'https://placehold.co/400x240/cccccc/333333?text=Invalid+URL';
                      mediaElementHtml = `<a href="${media.fileUrl}" target="_blank"><img src="${imageUrl}" alt="${fileName}" class="w-full h-48 object-cover rounded-md mb-2" onerror="this.onerror=null;this.src='https://placehold.co/400x240/cccccc/333333?text=Image+Error';"></a>`;
                    } else if (media.fileType && media.fileType.startsWith('video')) {
                      mediaElementHtml = `<video controls playsinline src="${media.fileUrl}" class="w-full h-48 object-cover rounded-md mb-2"></video>`;
                    } else {
                      mediaElementHtml = `<div class="w-full h-48 bg-gray-200 flex items-center justify-center rounded-md mb-2 text-gray-500">Unsupported</div>`;
                    }
                    html += `
                        <div class="media-item bg-gray-100 p-3 rounded-lg shadow-sm flex flex-col justify-between">
                            ${mediaElementHtml}
                            <div class="mt-auto text-center">
                                <p class="text-xs text-gray-700 truncate" title="${fileName}">${fileName}</p>
                                <span class="admin-only" style="display: block; margin-top: 4px;">
                                    <button class="delete-button text-xs px-2 py-1" onclick="deleteMedia('${media.uniqueID}')">Delete</button>
                                </span>
                            </div>
                        </div>`;
                  });
                  html += `</div></div>`;
                });
                html += `</div>`;
              });
              html += `</div>`;
            });
          } else {
            html = '<p style="text-align:center; margin-top:20px;">No media files have been uploaded yet.</p>';
          }
          mediaGalleryDiv.innerHTML = html;
          updateAdminUI(isAdminLoggedIn);
        }).catch(error => {
          mediaGalleryDiv.innerHTML = `<p class="error-message">Error: ${error.message}</p>`;
        }).finally(() => hideLoading());
    }

    function renderTable(data, tableId, sectionType) {
      const tbody = document.querySelector(`#${tableId} tbody`);
      const thead = document.querySelector(`#${tableId} thead`);
      if (!thead || !tbody) { console.error(`Table elements not found for ${tableId}`); return; }
      thead.innerHTML = ""; tbody.innerHTML = "";

      if (!Array.isArray(data) || data.length < 2) {
        thead.innerHTML = `<tr><th>Notice</th></tr>`;
        tbody.innerHTML = `<tr><td>No entries found for ${sectionType}.</td></tr>`;
        return;
      }

      let [originalHeaders, ...rows] = data;
      let headersToDisplay = originalHeaders;
      let columnIndicesToKeep = Array.from({ length: originalHeaders.length }, (_, i) => i);

      if (tableId === 'meeting-table') {
        const excludedMeetingHeader = 'Photo URL';
        const photoUrlIndex = originalHeaders.indexOf(excludedMeetingHeader);
        if (photoUrlIndex > -1) {
          headersToDisplay = originalHeaders.filter(h => h !== excludedMeetingHeader);
          columnIndicesToKeep = originalHeaders.map((h, i) => h !== excludedMeetingHeader ? i : -1).filter(i => i !== -1);
        }
      }

      thead.innerHTML = "<tr>" + headersToDisplay.map(h => `<th>${h}</th>`).join('') + "<th class='admin-only'>Actions</th></tr>";

      rows.forEach((row, i) => {
        const tr = tbody.insertRow();
        columnIndicesToKeep.forEach((colIndex, displayIndex) => {
          const td = tr.insertCell();
          const cellValue = row[colIndex] || '';
          const headerText = headersToDisplay[displayIndex];
          if (headerText === 'Meeting Date' || headerText === 'Deadline') {
            if (cellValue) {
              const date = new Date(cellValue);
              td.textContent = !isNaN(date) ? `${String(date.getDate()).padStart(2, '0')}-${String(date.getMonth() + 1).padStart(2, '0')}-${date.getFullYear()}` : cellValue;
            }
          } else {
            td.innerHTML = cellValue;
          }
        });
        const actionCell = tr.insertCell();
        actionCell.className = 'admin-only';
        actionCell.innerHTML = `<button class="px-3 py-1 text-xs font-medium text-white bg-yellow-500 rounded hover:bg-yellow-600" onclick="edit${sectionType.charAt(0).toUpperCase() + sectionType.slice(1)}(${i + 2}, this.closest('tr'))">Edit</button>
                              <button class="ml-1 px-3 py-1 text-xs font-medium text-white bg-red-600 rounded hover:bg-red-700" onclick="delete${sectionType.charAt(0).toUpperCase() + sectionType.slice(1)}(${i + 2})">Delete</button>`;
      });
      updateAdminUI(isAdminLoggedIn);
    }

    // --- FORM HANDLING & DATA SUBMISSION ---
    function generateUniqueId() {
      return 'M' + Date.now() + Math.floor(Math.random() * 1000);
    }

    function postData(formData, action, successMessage, formElement, isEditMode = false) {
      showLoading();
      let sheetName;
      if (action.includes('meeting')) sheetName = 'Meetings';
      else if (action.includes('action')) sheetName = 'Action Items';
      else if (action.includes('media')) sheetName = 'Media';
      else if (action.includes('presentation')) sheetName = 'Presentations';
      else if (action.includes('repository')) sheetName = 'Repository';

      if (sheetName) formData.append('sheetName', sheetName);
      formData.append('action', action);

      fetch(scriptURL, { method: 'POST', body: formData })
        .then(res => res.json())
        .then(data => {
          if (data.result === 'success') {
            showMessage(successMessage, false);
            if (formElement) formElement.reset();
            if (action.includes('meeting') || action.includes('action')) {
              fetchData();
            } else if (action.includes('media')) {
              fetchMediaGallery();
            } else if (action.includes('presentation')) {
              fetchPresentations();
            } else if (action.includes('repository')) {
              fetchRepositoryData();
            }
          } else { throw new Error(data.error || 'Unknown error'); }
        })
        .catch(error => showMessage(`Error: ${error.message}`, false))
        .finally(() => {
          hideLoading();
          if (isEditMode) {
            if (action.includes('meeting')) {
              document.getElementById('meeting-mode').textContent = 'Mode: Add New Meeting';
              formElement.querySelector('button[type="submit"]').textContent = 'Save Meeting';
            } else if (action.includes('action')) {
              document.getElementById('action-mode').textContent = 'Mode: Add New Action Item';
              formElement.querySelector('button[type="submit"]').textContent = 'Add Action Item';
            }
          }
        });
    }

    function editMeeting(rowNum, trElement) {
      if (!isAdminLoggedIn) { showMessage("Admin login required.", false); return; }
      const form = document.getElementById('meeting-form');
      form.querySelector('#meeting-mode').textContent = 'Mode: Edit Existing Meeting';
      form.querySelector('button[type="submit"]').textContent = 'Update Meeting';
      form.row.value = rowNum;

      const cells = Array.from(trElement.cells);
      const headers = Array.from(document.querySelector('#meeting-table thead tr').cells).map(th => th.textContent.trim());
      const cellData = headers.reduce((obj, header, i) => { if (header !== 'Actions') obj[header] = cells[i]?.textContent.trim(); return obj; }, {});

      form.meetingId.value = cellData['Meeting ID'];
      if (cellData['Meeting Date']) {
        const [day, month, year] = cellData['Meeting Date'].split('-');
        if (day && month && year) form.meetingDate.value = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
      }
      form.zoneM.value = cellData['Zone'];
      form.districtM.value = cellData['District'];
      form.coldRoomM.value = cellData['Cold Room Location (Optional)'];
      form.meetingTitle.value = cellData['Meeting Title'];
      form.conductedByM.value = cellData['Conducted By'];
      form.attendeesM.value = cellData['Attendees'];
      form.meetingAgendaM.value = cellData['Meeting Agenda'];
      form.meetingDiscussionM.value = cellData['What points were discussed during the meeting?'];
      form.scrollIntoView({ behavior: 'smooth' });
    }

    function editAction(rowNum, trElement) {
      if (!isAdminLoggedIn) { showMessage("Admin login required.", false); return; }
      const form = document.getElementById('action-form');
      form.querySelector('#action-mode').textContent = 'Mode: Edit Existing Action Item';
      form.querySelector('button[type="submit"]').textContent = 'Update Action Item';
      form.row.value = rowNum;

      const cells = Array.from(trElement.cells);
      const headers = Array.from(document.querySelector('#action-table thead tr').cells).map(th => th.textContent.trim());
      const cellData = headers.reduce((obj, header, i) => { if (header !== 'Actions') obj[header] = cells[i]?.textContent.trim(); return obj; }, {});

      form['action-meetingId'].value = cellData['Meeting ID'];
      form.actionItemA.value = cellData['Action Item'];
      form.assignedToA.value = cellData['Assigned To'];
      if (cellData['Deadline']) {
        const [day, month, year] = cellData['Deadline'].split('-');
        if (day && month && year) form.deadlineA.value = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
      }
      form.statusA.value = cellData['Status'];
      form.scrollIntoView({ behavior: 'smooth' });
    }

    function deleteEntry(identifier, actionType, sheetName, confirmMessage, successMessage, callback) {
      if (!isAdminLoggedIn) { showMessage("Admin login required.", false); return; }
      showMessage(confirmMessage, true, () => {
        showLoading();
        const formData = new FormData();
        const key = (actionType === 'delete_media' || actionType === 'delete_presentation' || actionType.includes('repository')) ? 'uniqueID' : 'row';
        formData.append(key, identifier);
        formData.append('sheetName', sheetName);
        formData.append('action', actionType);
        fetch(scriptURL, { method: 'POST', body: formData })
          .then(res => res.json())
          .then(data => {
            if (data.result === 'success') {
              showMessage(successMessage, false);
              callback();
            } else { throw new Error(data.error || 'Unknown error'); }
          })
          .catch(error => showMessage(`Error: ${error.message}`, false))
          .finally(() => hideLoading());
      });
    }

    function deleteMeeting(rowNum) { deleteEntry(rowNum, 'delete_meeting', 'Meetings', 'Are you sure?', 'Meeting deleted.', fetchData); }
    function deleteAction(rowNum) { deleteEntry(rowNum, 'delete_action', 'Action Items', 'Are you sure?', 'Action item deleted.', fetchData); }
    function deleteMedia(uniqueID) { deleteEntry(uniqueID, 'delete_media', 'Media', 'Are you sure?', 'Media file deleted.', fetchMediaGallery); }
    function deletePresentation(uniqueID) { deleteEntry(uniqueID, 'delete_presentation', 'Presentations', 'Are you sure?', 'Presentation deleted.', fetchPresentations); }
    function deleteRepositoryFile(uniqueID) { deleteEntry(uniqueID, 'delete_repository_file', 'Repository', 'Are you sure?', 'File deleted.', fetchRepositoryData); }


    // --- INITIALIZATION ---
    window.onload = function () {
      // Event Listeners for Buttons
      document.getElementById('admin-login-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        if (this.username.value === 'admin' && this.password.value === 'admin') {
          isAdminLoggedIn = true;
          document.getElementById('admin-nav-button').textContent = 'Logout';
          updateAdminUI(true);
          showHomePage();
          showMessage('Admin login successful.', false);
        } else {
          showMessage('Invalid username or password.', false);
          this.password.value = '';
        }
      });
      document.getElementById('customMessageConfirm')?.addEventListener('click', () => {
        document.getElementById('customMessageBoxOverlay').classList.remove('active');
        if (window.confirmCallback) { window.confirmCallback(); window.confirmCallback = null; }
      });
      document.getElementById('customMessageCancel')?.addEventListener('click', () => {
        document.getElementById('customMessageBoxOverlay').classList.remove('active');
        window.confirmCallback = null;
      });

      // Event Listeners for Forms
      document.getElementById('meeting-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        const isEdit = !!this.row.value;
        const action = isEdit ? 'edit_meeting' : 'add_meeting';
        const message = isEdit ? 'Meeting updated.' : 'Meeting added.';
        if (isEdit) formData.append('row', this.row.value);
        postData(formData, action, message, this, isEdit);
      });

      document.getElementById('meeting-form')?.addEventListener('reset', () => {
        document.getElementById('meetingId').value = generateUniqueId();
        document.getElementById('meeting-mode').textContent = 'Mode: Add New Meeting';
        document.querySelector('#meeting-form button[type="submit"]').textContent = 'Save Meeting';
      });

      document.getElementById('action-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        const formData = new FormData(this);
        const isEdit = !!this.row.value;
        const action = isEdit ? 'edit_action' : 'add_action';
        const message = isEdit ? 'Action item updated.' : 'Action item added.';
        if (isEdit) formData.append('row', this.row.value);
        postData(formData, action, message, this, isEdit);
      });

      document.getElementById('media-upload-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        const file = this.mediaFileMedia.files[0];
        if (!file) { showMessage('Please select a file.', false); return; }
        showLoading();
        const reader = new FileReader();
        reader.onload = (event) => {
          const formData = new FormData();
          formData.append('weekInfo', this.weekInfoMedia.value);
          formData.append('zone', this.zoneMedia.value);
          formData.append('district', this.districtMedia.value);
          formData.append('dataBase64', event.target.result.split(',')[1]);
          formData.append('fileName', file.name);
          formData.append('mimeType', file.type);
          postData(formData, 'add_media', 'Media uploaded.', this);
        };
        reader.readAsDataURL(file);
      });

      document.getElementById('presentation-upload-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        postData(new FormData(this), 'add_presentation', 'Presentation added.', this);
      });

      document.getElementById('repository-upload-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        postData(new FormData(this), 'add_repository_file', 'File added to repository.', this);
      });

      // Initial setup
      document.getElementById('meetingId').value = generateUniqueId();
      populateWeekSelects();
      fetchData();
      showHomePage();
    };

    // Helper to populate week dropdowns
    function populateWeekSelects() {
      const weekOptions = ["Week 19 (May 05 - May 11)", "Week 20 (May 12 - May 18)", "Week 21 (May 19 - May 25)", "Week 22 (May 26 - Jun 01)", "Week 23 (Jun 02 - Jun 08)", "Week 24 (Jun 09 – Jun 15)", "Week 25 (Jun 16 – Jun 22)", "Week 26 (Jun 23 – Jun 29)", "Week 27 (Jun 30 – Jul 06)", "Week 28 (Jul 07 – Jul 13)", "Week 29 (Jul 14 – Jul 20)", "Week 30 (Jul 21 – Jul 27)", "Week 31 (Jul 28 – Aug 03)", "Week 32 (Aug 04 – Aug 10)", "Week 33 (Aug 11 – Aug 17)", "Week 34 (Aug 18 – Aug 24)", "Week 35 (Aug 25 – Aug 31)", "Week 36 (Sep 01 – Sep 07)", "Week 37 (Sep 08 – Sep 14)", "Week 38 (Sep 15 – Sep 21)", "Week 39 (Sep 22 – Sep 28)", "Week 40 (Sep 29 – Oct 05)", "Week 41 (Oct 06 – Oct 12)", "Week 42 (Oct 13 – Oct 19)", "Week 43 (Oct 20 – Oct 26)", "Week 44 (Oct 27 – Nov 02)", "Week 45 (Nov 03 – Nov 09)", "Week 46 (Nov 10 – Nov 16)", "Week 47 (Nov 17 – Nov 23)", "Week 48 (Nov 24 – Nov 30)", "Week 49 (Dec 01 – Dec 07)", "Week 50 (Dec 08 – Dec 14)", "Week 51 (Dec 15 – Dec 21)", "Week 52 (Dec 22 – Dec 28)", "Week 1 (Dec 29 – Jan 04)", "Week 2 (Jan 05 – Jan 11)", "Week 3 (Jan 12 – Jan 18)", "Week 4 (Jan 19 – Jan 25)", "Week 5 (Jan 26 – Feb 01)", "Week 6 (Feb 02 – Feb 08)", "Week 7 (Feb 09 – Feb 15)", "Week 8 (Feb 16 – Feb 22)", "Week 9 (Feb 23 – Mar 01)", "Week 10 (Mar 02 – Mar 08)", "Week 11 (Mar 09 – Mar 15)", "Week 12 (Mar 16 – Mar 22)", "Week 13 (Mar 23 – Mar 29)", "Week 14 (Mar 30 – Apr 05)", "Week 15 (Apr 06 – Apr 12)", "Week 16 (Apr 13 – Apr 19)", "Week 17 (Apr 20 – Apr 26)", "Week 18 (Apr 27 – May 03)"];
      const weekSelects = document.querySelectorAll('select[name="weekInfo"], select[name="weekInfoMedia"], select[name="presentationWeekInfo"]');
      weekSelects.forEach(select => {
        select.innerHTML = '<option value="">Select Week</option>' + weekOptions.map(week => `<option value="${week}">${week}</option>`).join('');
      });
    }

    // --- REPOSITORY FUNCTIONS ---
    function fetchRepositoryData() {
      showLoading();
      fetch(scriptURL + '?action=get_data&sheetName=Repository')
        .then(res => res.json())
        .then(data => {
          renderRepository(data);
        }).catch(err => {
          console.error("Error fetching repository data:", err);
          document.getElementById('repository-display-area').innerHTML = `<p class="error-message">Could not load repository data.</p>`;
        }).finally(() => {
          hideLoading();
        });
    }

    function renderRepository(data) {
      const displayArea = document.getElementById('repository-display-area');
      const datalist = document.getElementById('repository-titles');
      if (!displayArea || !datalist) return;

      if (!Array.isArray(data) || data.length < 2) {
        displayArea.innerHTML = '<p class="text-center text-gray-500">No files in the repository yet.</p>';
        return;
      }

      const [headers, ...rows] = data;
      const titleIndex = headers.indexOf('Title');
      const linkIndex = headers.indexOf('FileLink');
      const idIndex = headers.indexOf('UniqueID');
      const nameIndex = headers.indexOf('DocName'); // Use the new column

      const uniqueTitles = [...new Set(rows.map(row => row[titleIndex]))];
      datalist.innerHTML = uniqueTitles.map(title => `<option value="${title}"></option>`).join('');

      const groupedByTitle = rows.reduce((acc, row) => {
        const title = row[titleIndex] || 'Uncategorized';
        if (!acc[title]) acc[title] = [];
        acc[title].push({
          link: row[linkIndex],
          id: row[idIndex],
          name: row[nameIndex] // Get the name from the sheet
        });
        return acc;
      }, {});

      let html = '';
      for (const title in groupedByTitle) {
        html += `<div class="repository-title-group"><h3>${title}</h3><div class="repository-files-grid">`;
        groupedByTitle[title].forEach(file => {
          html += `
                <div class="repository-file-item">
                    <a href="${file.link}" target="_blank" rel="noopener noreferrer">
                        <div class="file-icon">${getIconForFile(file.link)}</div>
                        <p class="file-name">${file.name || 'Unnamed File'}</p>
                    </a>
                    <span class="admin-only"><button class="delete-button" onclick="deleteRepositoryFile('${file.id}')">Delete</button></span>
                </div>
            `;
        });
        html += `</div></div>`;
      }

      displayArea.innerHTML = html;
      updateAdminUI(isAdminLoggedIn);
    }

    function getIconForFile(link) {
      const lowerLink = link.toLowerCase();
      // Google Drive icons
      if (lowerLink.includes('docs.google.com/document')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4285F4"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      if (lowerLink.includes('docs.google.com/spreadsheets')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#0F9D58"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      if (lowerLink.includes('docs.google.com/presentation')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#F4B400"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      // Microsoft file types
      if (lowerLink.endsWith('.pdf')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#DB4437"><path d="M20 2H8c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8 14H9v-2h3v2zm4-4H9v-2h7v2zm0-4H9V6h7v2z"/></svg>`;
      if (lowerLink.endsWith('.doc') || lowerLink.endsWith('.docx')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4285F4"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      if (lowerLink.endsWith('.ppt') || lowerLink.endsWith('.pptx')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#F4B400"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      if (lowerLink.endsWith('.xls') || lowerLink.endsWith('.xlsx')) return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#0F9D58"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>`;
      // Generic link icon
      return `<div style="display: flex; justify-content: center; align-items: center; height: 150px;"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 text-gray-400">
  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.875v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9a1.125 1.125 0 00-1.125-1.125h-2.25z" />
</svg>
</div>`;
    }

    // --- PROGRESS TRACKER FUNCTIONS ---
    function initializeProgressTracker() {
      const container = document.getElementById('progress-section');
      if (container.dataset.initialized) {
        fetchProgressData();
        return;
      }
      container.innerHTML = `<h2>Project Progress Tracker</h2>` + progressPageHTML;
      container.dataset.initialized = 'true';

      const checkboxes = container.querySelectorAll('#filter-controls input[type="checkbox"]');
      checkboxes.forEach(cb => {
        cb.addEventListener('change', updateColumnVisibility);
      });

      fetchProgressData();
    }

    function fetchProgressData() {
      showLoading();
      fetch(scriptURL + '?action=get_progress_data')
        .then(res => {
          if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
          return res.json();
        })
        .then(data => {
          if (data.error) throw new Error(data.error);
          buildProgressTable(data.locations, data.progress);
        }).catch(error => {
          console.error('Error fetching progress data:', error);
          const container = document.getElementById('progress-table-container');
          if (container) container.innerHTML = `<p class="text-red-600 p-4 text-center">Error loading progress data: ${error.message}</p>`;
        }).finally(() => {
          hideLoading();
        });
    }

    function getColumnClass(colIndex) {
      if (colIndex < 12) return 'ws-op-excellence';
      if (colIndex < 21) return 'ws-revenue-div';
      if (colIndex < 33) return 'ws-farmer-vendor';
      if (colIndex < 42) return 'ws-mentorship-skill';
      return 'ws-gov-stakeholder';
    }


    function buildProgressTable(locationsData, progressData) {
      const container = document.getElementById('progress-container');
      if (!container) return;

      const tableBody = container.querySelector('#table-body');
      const tableHead = container.querySelector('#progress-table thead');
      if (!tableBody || !tableHead) {
        console.error("Progress table body or head not found.");
        return;
      }

      const progressMap = new Map();
      if (Array.isArray(progressData) && progressData.length > 1) {
        progressData.slice(1).forEach(row => {
          const key = `${row[0]}_${row[1]}`;
          progressMap.set(key, row[2]);
        });
      }

      const headers = [
        "Infrastructure readiness gaps identified and reported", "Cold room open and operational for beneficiaries", "Process for issue resolution established", "Infrastructure gaps addressed", "Technician assigned to cold room", "Plan for workflow digitization complete", "Asset monitoring setup", "Inventory system rollout complete", "Operational readiness tools in place", "SoPs and guidelines for daily functioning created", "All operators comfortable with daily operations", "Operator mid year readiness check complete", "Bulk institutions / market linkage / VAS survey work complete", "Surveys results analysed and consolidated", "First batch supplied to bulk institution", "New idea generated", "Idea piloted", "Idea institutionalized", "Opportunity analysis for cold room complete", "Changes proposed", "Changes initiated", "Basline survey work started", "Baseline survey work complete", "Data analyzed", "Farmers/vendors tagged and registered", "Materials for awareness programs completed", "Market level awareness programs completed", "Village level awareness programs completed", "Ambassador program launched", "Regular user feedback collected", "Non user feedback collected", "One time user feedback collected", "Feedback consolidated", "Training plan ready", "Training completed", "Needs assessment complete", "Training plan ready", "Training completed", "Needs assessment complete", "Training plan ready", "Training completed", "Plan for ongoing mentorship created", "Kickoff meeting with key stakeholders complete", "NGOs mapped and briefed", "At least one NGO partnership is established", "District workplan complete", "District level PMU formed", "Monthly district level PMU meeting complete", "Steering committee formed at state level", "Quarterly steering committee meeting complete", "Impact reporting plan in place", "Data collection plan created", "Data reporting dasboard established", "Operational data collection begun"
      ];

      tableBody.innerHTML = '';
      tableHead.innerHTML = `
            <tr>
                <th rowspan="3" style="width: 160px;">Location</th>
                <th rowspan="3" style="width: 160px;">City</th>
                <th rowspan="3" style="width: 160px;">District</th>
                <th colspan="12" class="workstream-header ws-op-excellence">Operational Excellence</th>
                <th colspan="9" class="workstream-header ws-revenue-div">Revenue Diversification</th>
                <th colspan="12" class="workstream-header ws-farmer-vendor">Farmer & Vendor Engagement</th>
                <th colspan="9" class="workstream-header ws-mentorship-skill">Operator Mentorship & Skill Building</th>
                <th colspan="12" class="workstream-header ws-gov-stakeholder">Project Governance & Stakeholder Engagement</th>
            </tr>
            <tr>
                <th colspan="5" class="sub-workstream-header ws-op-excellence">Infrastructure Upkeep and Maintenance</th>
                <th colspan="3" class="sub-workstream-header ws-op-excellence">Digitization</th>
                <th colspan="4" class="sub-workstream-header ws-op-excellence">Daily facility operations</th>
                <th colspan="3" class="sub-workstream-header ws-revenue-div">Bulk and Institutional Supplies</th>
                <th colspan="3" class="sub-workstream-header ws-revenue-div">Value added services</th>
                <th colspan="3" class="sub-workstream-header ws-revenue-div">Production modelling and rationalization</th>
                <th colspan="4" class="sub-workstream-header ws-farmer-vendor">Data collection and onboarding</th>
                <th colspan="4" class="sub-workstream-header ws-farmer-vendor">Awareness programs</th>
                <th colspan="4" class="sub-workstream-header ws-farmer-vendor">Feedback collection</th>
                <th colspan="2" class="sub-workstream-header ws-mentorship-skill">Phase 1 trainings</th>
                <th colspan="3" class="sub-workstream-header ws-mentorship-skill">Phase 2 trainings</th>
                <th colspan="3" class="sub-workstream-header ws-mentorship-skill">Phase 3 trainings</th>
                <th colspan="1" class="sub-workstream-header ws-mentorship-skill">Ongoing mentorship</th>
                <th colspan="3" class="sub-workstream-header ws-gov-stakeholder">Stakeholder engagement / awareness building</th>
                <th colspan="6" class="sub-workstream-header ws-gov-stakeholder">Project review and monitoring</th>
                <th colspan="3" class="sub-workstream-header ws-gov-stakeholder">Data systems and management</th>
            </tr>
            <tr>
                ${headers.map((h, i) => `<th class="${getColumnClass(i)}">${h}</th>`).join('')}
            </tr>
        `;

      const locations = Array.isArray(locationsData) ? locationsData.slice(1) : [];

      locations.forEach(locationRow => {
        const locationId = locationRow[0];
        const row = tableBody.insertRow();
        row.insertCell().textContent = locationRow[0];
        row.insertCell().textContent = locationRow[1];
        row.insertCell().textContent = locationRow[2];

        headers.forEach((taskName, index) => {
          const cell = row.insertCell();
          cell.className = getColumnClass(index);
          const select = document.createElement('select');
          select.dataset.locationId = locationId;
          select.dataset.taskName = taskName;
          select.dataset.statusIndex = index;
          const currentStatus = progressMap.get(`${locationId}_${taskName}`) || 'Not started';
          ['Not started', 'In progress', 'Complete'].forEach(optionText => {
            const option = document.createElement('option');
            option.value = optionText;
            option.textContent = optionText;
            if (optionText === currentStatus) option.selected = true;
            select.appendChild(option);
          });
          cell.appendChild(select);
          updateDropdownColor(select);
          select.addEventListener('change', handleStatusChange);
        });
      });

      const percentageRow = tableBody.insertRow(0);
      percentageRow.id = 'percentage-row';
      let html = `<td class="font-bold text-center"><b>% Complete</b></td><td></td><td></td>`;
      for (let i = 0; i < headers.length; i++) {
        html += `<td id="percent-col-${i}" class="percent-complete-cell ${getColumnClass(i)}"></td>`;
      }
      percentageRow.innerHTML = html;

      updateColumnVisibility();
    }

    function handleStatusChange(event) {
      const select = event.target;
      updateDropdownColor(select);
      calculateAllPercentages();

      const formData = new FormData();
      formData.append('action', 'update_progress_status');
      formData.append('locationId', select.dataset.locationId);
      formData.append('taskName', select.dataset.taskName);
      formData.append('newStatus', select.value);

      fetch(scriptURL, { method: 'POST', body: formData, mode: 'no-cors' }) // Use no-cors for this type of request
        .then(() => {
          console.log('Progress update sent.');
        })
        .catch(error => console.error('Error sending progress update:', error));
    }

    function updateDropdownColor(selectElement) {
      const cell = selectElement.parentElement;
      cell.classList.remove('status-complete', 'status-in-progress', 'status-not-started');
      const selectedValue = selectElement.value;
      if (selectedValue === 'Complete') {
        cell.classList.add('status-complete');
      } else if (selectedValue === 'In progress') {
        cell.classList.add('status-in-progress');
      } else {
        cell.classList.add('status-not-started');
      }
    }

    function calculateAllPercentages() {
      const statusValues = { 'Complete': 1, 'In progress': 0, 'Not started': 0 };
      const dataRows = document.querySelectorAll('#table-body tr:not(#percentage-row)');
      if (dataRows.length === 0) return;
      const totalColumns = dataRows[0].cells.length;

      for (let colIndex = 3; colIndex < totalColumns; colIndex++) {
        let totalScore = 0;
        let visibleCount = 0;
        dataRows.forEach(row => {
          const cell = row.cells[colIndex];
          if (cell && (cell.style.display === '' || cell.style.display === 'table-cell')) {
            const select = cell.querySelector('select');
            if (select) {
              totalScore += statusValues[select.value];
              visibleCount++;
            }
          }
        });
        const percentage = (visibleCount > 0) ? (totalScore / visibleCount) * 100 : 0;
        const percentageCell = document.getElementById(`percent-col-${colIndex - 3}`);
        if (percentageCell) {
          percentageCell.textContent = `${percentage.toFixed(0)}%`;
        }
      }
    }

    function updateColumnVisibility() {
      const checkboxes = document.querySelectorAll('#filter-controls input[type="checkbox"]');
      let anyCheckboxChecked = false;

      checkboxes.forEach(cb => {
        const wsClass = cb.dataset.ws;
        const cells = document.querySelectorAll(`.${wsClass}`);

        if (cb.checked) {
          anyCheckboxChecked = true;
          cells.forEach(cell => cell.classList.add('visible-cell'));
        } else {
          cells.forEach(cell => cell.classList.remove('visible-cell'));
        }
      });

      const percentageRow = document.getElementById('percentage-row');
      if (percentageRow) {
        percentageRow.classList.toggle('visible-row', anyCheckboxChecked);
      }

      calculateAllPercentages();
    }
  </script>
</body>

</html>
